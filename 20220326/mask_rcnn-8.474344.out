[SH-IDC1-10-142-5-213][[2270,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 15:03:25,070 [32mINFO[0m: log service ip address is: 10.142.5.213:31438[0m
2022-03-27 15:03:25,071 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 15:04:22,455 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 15:04:22,457 - mmdet - INFO - Distributed training: False
2022-03-27 15:04:23,360 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 15:04:23,516 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 15:04:23,516 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 15:04:24,058 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=11.35s)
creating index...
index created!
loading annotations into memory...
Done (t=0.40s)
creating index...
index created!
2022-03-27 15:04:38,477 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 15:04:38,477 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 15:04:38,477 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 15:04:38,477 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 15:07:17,181 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 25 days, 20:07:07, time: 3.173, data_time: 0.090, memory: 3455, loss_rpn_cls: 0.3479, loss_rpn_bbox: 0.0131, loss_cls: 1.3796, acc: 88.3516, loss_bbox: 0.0510, loss_mask: 0.5835, loss: 2.3751
2022-03-27 15:07:24,501 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 12:20:38, time: 0.146, data_time: 0.001, memory: 3469, loss_rpn_cls: 0.0329, loss_rpn_bbox: 0.0048, loss_cls: 0.4635, acc: 98.1484, loss_bbox: 0.0943, loss_mask: 0.1925, loss: 0.7881
2022-03-27 15:07:32,746 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 10:57:05, time: 0.165, data_time: 0.001, memory: 3487, loss_rpn_cls: 0.0110, loss_rpn_bbox: 0.0035, loss_cls: 0.3774, acc: 99.2246, loss_bbox: 0.0465, loss_mask: 0.0859, loss: 0.5242
2022-03-27 15:07:39,832 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 9:07:16, time: 0.142, data_time: 0.001, memory: 3487, loss_rpn_cls: 0.0034, loss_rpn_bbox: 0.0058, loss_cls: 0.2913, acc: 99.5781, loss_bbox: 0.0343, loss_mask: 0.0586, loss: 0.3934
2022-03-27 15:07:47,842 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 3:56:59, time: 0.160, data_time: 0.001, memory: 3487, loss_rpn_cls: 0.0023, loss_rpn_bbox: 0.0055, loss_cls: 0.1451, acc: 99.6602, loss_bbox: 0.0267, loss_mask: 0.0422, loss: 0.2218
2022-03-27 15:07:55,188 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 8:03:47, time: 0.147, data_time: 0.001, memory: 3487, loss_rpn_cls: 0.0023, loss_rpn_bbox: 0.0049, loss_cls: 0.0306, acc: 99.6699, loss_bbox: 0.0255, loss_mask: 0.0401, loss: 0.1033
2022-03-27 15:08:02,190 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 17:40:18, time: 0.140, data_time: 0.001, memory: 3487, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0041, loss_cls: 0.0137, acc: 99.7305, loss_bbox: 0.0199, loss_mask: 0.0373, loss: 0.0767
2022-03-27 15:08:09,697 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 7:07:08, time: 0.150, data_time: 0.001, memory: 3487, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0038, loss_cls: 0.0100, acc: 99.7500, loss_bbox: 0.0193, loss_mask: 0.0312, loss: 0.0654
2022-03-27 15:08:16,699 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 3 days, 22:41:39, time: 0.140, data_time: 0.001, memory: 3487, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0037, loss_cls: 0.0094, acc: 99.7852, loss_bbox: 0.0171, loss_mask: 0.0271, loss: 0.0585
2022-03-27 15:08:23,809 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 15:59:51, time: 0.142, data_time: 0.001, memory: 3487, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0037, loss_cls: 0.0080, acc: 99.8184, loss_bbox: 0.0154, loss_mask: 0.0271, loss: 0.0557
2022-03-27 15:08:31,554 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 10:44:30, time: 0.155, data_time: 0.001, memory: 3487, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0031, loss_cls: 0.0077, acc: 99.7949, loss_bbox: 0.0154, loss_mask: 0.0273, loss: 0.0549
2022-03-27 15:08:38,638 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 6:08:40, time: 0.142, data_time: 0.001, memory: 3487, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0034, loss_cls: 0.0064, acc: 99.8438, loss_bbox: 0.0120, loss_mask: 0.0228, loss: 0.0455
2022-03-27 15:08:46,372 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 2:27:15, time: 0.155, data_time: 0.001, memory: 3491, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0028, loss_cls: 0.0062, acc: 99.8438, loss_bbox: 0.0110, loss_mask: 0.0183, loss: 0.0392
2022-03-27 15:08:53,471 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 2 days, 23:06:37, time: 0.142, data_time: 0.001, memory: 3491, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0026, loss_cls: 0.0035, acc: 99.9043, loss_bbox: 0.0090, loss_mask: 0.0145, loss: 0.0304
2022-03-27 15:09:00,791 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 20:16:08, time: 0.146, data_time: 0.001, memory: 3508, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0024, loss_cls: 0.0044, acc: 99.9043, loss_bbox: 0.0077, loss_mask: 0.0169, loss: 0.0322
2022-03-27 15:09:09,211 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 18:03:14, time: 0.169, data_time: 0.001, memory: 3508, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0025, loss_cls: 0.0034, acc: 99.9141, loss_bbox: 0.0074, loss_mask: 0.0127, loss: 0.0265
2022-03-27 15:09:16,422 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 15:49:05, time: 0.144, data_time: 0.001, memory: 3508, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0023, loss_cls: 0.0024, acc: 99.9375, loss_bbox: 0.0057, loss_mask: 0.0111, loss: 0.0221
2022-03-27 15:09:23,458 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 13:47:45, time: 0.141, data_time: 0.001, memory: 3508, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0022, loss_cls: 0.0034, acc: 99.9160, loss_bbox: 0.0063, loss_mask: 0.0109, loss: 0.0234
2022-03-27 15:09:31,723 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 12:14:14, time: 0.165, data_time: 0.001, memory: 3508, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0015, acc: 99.9648, loss_bbox: 0.0052, loss_mask: 0.0089, loss: 0.0182
2022-03-27 15:09:39,020 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 10:38:37, time: 0.146, data_time: 0.001, memory: 3508, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0014, acc: 99.9668, loss_bbox: 0.0049, loss_mask: 0.0094, loss: 0.0183
2022-03-27 15:09:47,001 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 9:19:55, time: 0.160, data_time: 0.001, memory: 3508, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0022, loss_cls: 0.0023, acc: 99.9570, loss_bbox: 0.0051, loss_mask: 0.0090, loss: 0.0191
2022-03-27 15:09:54,166 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 7:59:35, time: 0.143, data_time: 0.001, memory: 3508, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0018, loss_cls: 0.0027, acc: 99.9414, loss_bbox: 0.0050, loss_mask: 0.0092, loss: 0.0192
2022-03-27 15:10:01,480 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 6:47:41, time: 0.146, data_time: 0.001, memory: 3508, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0028, acc: 99.9238, loss_bbox: 0.0057, loss_mask: 0.0115, loss: 0.0224
2022-03-27 15:10:09,588 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 5:49:38, time: 0.162, data_time: 0.001, memory: 3545, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0032, acc: 99.9219, loss_bbox: 0.0046, loss_mask: 0.0087, loss: 0.0187
2022-03-27 15:10:16,994 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 4:49:24, time: 0.148, data_time: 0.001, memory: 3550, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0031, acc: 99.9238, loss_bbox: 0.0054, loss_mask: 0.0111, loss: 0.0217
2022-03-27 15:10:24,105 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 3:51:28, time: 0.143, data_time: 0.001, memory: 3550, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0031, acc: 99.9336, loss_bbox: 0.0047, loss_mask: 0.0094, loss: 0.0192
2022-03-27 15:10:32,083 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 3:05:11, time: 0.160, data_time: 0.001, memory: 3550, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0027, acc: 99.9258, loss_bbox: 0.0038, loss_mask: 0.0074, loss: 0.0161
2022-03-27 15:10:39,381 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 2:16:29, time: 0.146, data_time: 0.001, memory: 3550, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0035, acc: 99.8848, loss_bbox: 0.0051, loss_mask: 0.0099, loss: 0.0210
2022-03-27 15:10:47,132 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 1:34:49, time: 0.155, data_time: 0.001, memory: 3555, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0020, acc: 99.9277, loss_bbox: 0.0037, loss_mask: 0.0082, loss: 0.0160
2022-03-27 15:10:54,143 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 0:50:10, time: 0.140, data_time: 0.001, memory: 3555, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0033, acc: 99.9121, loss_bbox: 0.0050, loss_mask: 0.0094, loss: 0.0201
2022-03-27 15:11:01,655 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 0:12:06, time: 0.150, data_time: 0.001, memory: 3555, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0017, acc: 99.9551, loss_bbox: 0.0034, loss_mask: 0.0072, loss: 0.0142
2022-03-27 15:11:09,082 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 23:35:52, time: 0.149, data_time: 0.001, memory: 3555, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0016, acc: 99.9434, loss_bbox: 0.0033, loss_mask: 0.0063, loss: 0.0132
2022-03-27 15:11:16,902 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 23:04:33, time: 0.156, data_time: 0.001, memory: 3555, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0018, loss_cls: 0.0014, acc: 99.9609, loss_bbox: 0.0036, loss_mask: 0.0064, loss: 0.0135
2022-03-27 15:11:24,029 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 22:30:21, time: 0.143, data_time: 0.001, memory: 3555, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0015, acc: 99.9434, loss_bbox: 0.0030, loss_mask: 0.0050, loss: 0.0112
2022-03-27 15:11:31,793 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 22:02:20, time: 0.155, data_time: 0.001, memory: 3567, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0014, acc: 99.9492, loss_bbox: 0.0035, loss_mask: 0.0065, loss: 0.0133
2022-03-27 15:11:39,523 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 21:35:36, time: 0.154, data_time: 0.001, memory: 3575, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0013, loss_cls: 0.0027, acc: 99.9004, loss_bbox: 0.0060, loss_mask: 0.0106, loss: 0.0211
2022-03-27 15:11:47,158 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 21:09:46, time: 0.153, data_time: 0.001, memory: 3575, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0024, acc: 99.9258, loss_bbox: 0.0060, loss_mask: 0.0108, loss: 0.0212
2022-03-27 15:11:54,361 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 20:42:37, time: 0.144, data_time: 0.001, memory: 3575, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0011, acc: 99.9629, loss_bbox: 0.0032, loss_mask: 0.0068, loss: 0.0128
2022-03-27 15:12:01,692 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 20:17:35, time: 0.147, data_time: 0.001, memory: 3575, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0014, loss_cls: 0.0017, acc: 99.9453, loss_bbox: 0.0035, loss_mask: 0.0073, loss: 0.0142
2022-03-27 15:12:09,078 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 19:54:10, time: 0.148, data_time: 0.001, memory: 3575, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0011, acc: 99.9688, loss_bbox: 0.0025, loss_mask: 0.0067, loss: 0.0120
2022-03-27 15:12:16,487 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 19:31:57, time: 0.148, data_time: 0.001, memory: 3585, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0018, acc: 99.9395, loss_bbox: 0.0028, loss_mask: 0.0059, loss: 0.0123
2022-03-27 15:12:23,786 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 19:10:16, time: 0.146, data_time: 0.001, memory: 3585, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0014, loss_cls: 0.0014, acc: 99.9473, loss_bbox: 0.0025, loss_mask: 0.0063, loss: 0.0119
2022-03-27 15:12:31,575 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 18:52:11, time: 0.156, data_time: 0.001, memory: 3585, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0012, acc: 99.9648, loss_bbox: 0.0026, loss_mask: 0.0061, loss: 0.0115
2022-03-27 15:12:39,063 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 18:33:18, time: 0.150, data_time: 0.001, memory: 3585, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0016, acc: 99.9512, loss_bbox: 0.0027, loss_mask: 0.0062, loss: 0.0123
2022-03-27 15:12:42,071 - mmdet - INFO - __benchmark_total_time(h):0.13445044722821978
2022-03-27 15:12:42,072 - mmdet - INFO - __benchmark_pure_training_time(h):0.13433151589499578
2022-03-27 15:12:42,072 - mmdet - INFO - __benchmark_avg_iter_time(s):0.14949586627247569
2022-03-27 15:12:42,073 - mmdet - INFO - __benchmark_mem_alloc(mb):3545
2022-03-27 15:12:42,073 - mmdet - INFO - __benchmark_mem_cached(mb):5264
[SH-IDC1-10-142-5-213][[11752,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 15:12:58,446 [32mINFO[0m: log service ip address is: 10.142.5.213:31526[0m
2022-03-27 15:12:58,446 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 15:13:45,089 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 15:13:45,092 - mmdet - INFO - Distributed training: False
2022-03-27 15:13:45,996 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 15:13:46,080 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 15:13:46,081 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 15:13:46,643 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=11.49s)
creating index...
index created!
loading annotations into memory...
Done (t=0.35s)
creating index...
index created!
2022-03-27 15:14:01,426 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 15:14:01,427 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 15:14:01,427 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 15:14:01,427 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 15:16:44,492 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 26 days, 13:11:56, time: 3.261, data_time: 0.095, memory: 3448, loss_rpn_cls: 0.3572, loss_rpn_bbox: 0.0136, loss_cls: 1.4177, acc: 89.3184, loss_bbox: 0.0494, loss_mask: 0.6024, loss: 2.4404
2022-03-27 15:16:51,735 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 20:43:56, time: 0.145, data_time: 0.001, memory: 3464, loss_rpn_cls: 0.0314, loss_rpn_bbox: 0.0048, loss_cls: 0.4959, acc: 98.2676, loss_bbox: 0.0826, loss_mask: 0.1751, loss: 0.7898
2022-03-27 15:16:59,803 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 16:18:26, time: 0.161, data_time: 0.001, memory: 3479, loss_rpn_cls: 0.0085, loss_rpn_bbox: 0.0040, loss_cls: 0.4306, acc: 99.4863, loss_bbox: 0.0342, loss_mask: 0.0708, loss: 0.5481
2022-03-27 15:17:07,350 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 13:35:57, time: 0.151, data_time: 0.001, memory: 3480, loss_rpn_cls: 0.0029, loss_rpn_bbox: 0.0052, loss_cls: 0.3077, acc: 99.6152, loss_bbox: 0.0288, loss_mask: 0.0502, loss: 0.3948
2022-03-27 15:17:14,491 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 6:50:58, time: 0.143, data_time: 0.001, memory: 3480, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0049, loss_cls: 0.0965, acc: 99.6641, loss_bbox: 0.0240, loss_mask: 0.0377, loss: 0.1648
2022-03-27 15:17:22,226 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 10:43:52, time: 0.155, data_time: 0.001, memory: 3480, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0043, loss_cls: 0.0171, acc: 99.7246, loss_bbox: 0.0209, loss_mask: 0.0397, loss: 0.0839
2022-03-27 15:17:29,444 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 20:04:43, time: 0.144, data_time: 0.001, memory: 3480, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0044, loss_cls: 0.0098, acc: 99.7754, loss_bbox: 0.0196, loss_mask: 0.0301, loss: 0.0651
2022-03-27 15:17:37,203 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 9:20:55, time: 0.155, data_time: 0.001, memory: 3480, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0038, loss_cls: 0.0084, acc: 99.7988, loss_bbox: 0.0173, loss_mask: 0.0261, loss: 0.0566
2022-03-27 15:17:44,362 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 0:44:41, time: 0.143, data_time: 0.001, memory: 3480, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0034, loss_cls: 0.0074, acc: 99.8418, loss_bbox: 0.0177, loss_mask: 0.0230, loss: 0.0526
2022-03-27 15:17:51,575 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 17:52:47, time: 0.144, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0035, loss_cls: 0.0081, acc: 99.8066, loss_bbox: 0.0171, loss_mask: 0.0225, loss: 0.0523
2022-03-27 15:17:59,857 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 12:38:40, time: 0.166, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0031, loss_cls: 0.0080, acc: 99.8086, loss_bbox: 0.0156, loss_mask: 0.0213, loss: 0.0490
2022-03-27 15:18:07,116 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 7:56:55, time: 0.145, data_time: 0.001, memory: 3494, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0032, loss_cls: 0.0046, acc: 99.8965, loss_bbox: 0.0111, loss_mask: 0.0157, loss: 0.0355
2022-03-27 15:18:14,198 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 3:55:14, time: 0.142, data_time: 0.001, memory: 3494, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0029, loss_cls: 0.0035, acc: 99.9121, loss_bbox: 0.0096, loss_mask: 0.0135, loss: 0.0306
2022-03-27 15:18:21,971 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 0:39:32, time: 0.155, data_time: 0.001, memory: 3494, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0024, loss_cls: 0.0046, acc: 99.8887, loss_bbox: 0.0098, loss_mask: 0.0126, loss: 0.0303
2022-03-27 15:18:29,219 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 21:41:54, time: 0.145, data_time: 0.001, memory: 3519, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0025, loss_cls: 0.0044, acc: 99.8945, loss_bbox: 0.0104, loss_mask: 0.0141, loss: 0.0321
2022-03-27 15:18:37,658 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 19:23:46, time: 0.169, data_time: 0.001, memory: 3519, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0024, loss_cls: 0.0024, acc: 99.9336, loss_bbox: 0.0081, loss_mask: 0.0118, loss: 0.0254
2022-03-27 15:18:44,662 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 17:02:10, time: 0.140, data_time: 0.001, memory: 3519, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0023, loss_cls: 0.0024, acc: 99.9434, loss_bbox: 0.0080, loss_mask: 0.0112, loss: 0.0245
2022-03-27 15:18:51,579 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 14:55:06, time: 0.138, data_time: 0.001, memory: 3519, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0020, loss_cls: 0.0048, acc: 99.8867, loss_bbox: 0.0093, loss_mask: 0.0130, loss: 0.0296
2022-03-27 15:18:59,975 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 13:19:40, time: 0.168, data_time: 0.001, memory: 3528, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0064, acc: 99.8535, loss_bbox: 0.0120, loss_mask: 0.0157, loss: 0.0366
2022-03-27 15:19:07,092 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 11:38:45, time: 0.142, data_time: 0.001, memory: 3528, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0020, loss_cls: 0.0051, acc: 99.8594, loss_bbox: 0.0081, loss_mask: 0.0122, loss: 0.0279
2022-03-27 15:19:14,183 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 10:07:11, time: 0.142, data_time: 0.001, memory: 3528, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0044, acc: 99.8652, loss_bbox: 0.0061, loss_mask: 0.0127, loss: 0.0256
2022-03-27 15:19:21,805 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 8:49:32, time: 0.152, data_time: 0.001, memory: 3528, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0053, acc: 99.8730, loss_bbox: 0.0078, loss_mask: 0.0124, loss: 0.0278
2022-03-27 15:19:29,056 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 7:34:53, time: 0.145, data_time: 0.001, memory: 3528, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0033, acc: 99.9023, loss_bbox: 0.0059, loss_mask: 0.0100, loss: 0.0218
2022-03-27 15:19:37,062 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 6:33:49, time: 0.160, data_time: 0.001, memory: 3547, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0023, acc: 99.9473, loss_bbox: 0.0062, loss_mask: 0.0105, loss: 0.0213
2022-03-27 15:19:44,145 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 5:28:59, time: 0.142, data_time: 0.001, memory: 3552, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0016, acc: 99.9590, loss_bbox: 0.0050, loss_mask: 0.0093, loss: 0.0179
2022-03-27 15:19:51,365 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 4:30:19, time: 0.144, data_time: 0.001, memory: 3552, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0033, acc: 99.9082, loss_bbox: 0.0055, loss_mask: 0.0091, loss: 0.0200
2022-03-27 15:19:59,296 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 3:42:11, time: 0.159, data_time: 0.001, memory: 3552, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0018, acc: 99.9629, loss_bbox: 0.0059, loss_mask: 0.0089, loss: 0.0184
2022-03-27 15:20:06,497 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 2:51:22, time: 0.144, data_time: 0.001, memory: 3552, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0020, acc: 99.9473, loss_bbox: 0.0057, loss_mask: 0.0086, loss: 0.0182
2022-03-27 15:20:13,661 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 2:03:47, time: 0.143, data_time: 0.001, memory: 3564, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0018, loss_cls: 0.0007, acc: 99.9902, loss_bbox: 0.0049, loss_mask: 0.0072, loss: 0.0150
2022-03-27 15:20:21,936 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 1:27:57, time: 0.165, data_time: 0.001, memory: 3564, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0007, acc: 99.9902, loss_bbox: 0.0051, loss_mask: 0.0077, loss: 0.0153
2022-03-27 15:20:29,290 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 0:47:34, time: 0.147, data_time: 0.001, memory: 3564, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0027, acc: 99.9316, loss_bbox: 0.0049, loss_mask: 0.0083, loss: 0.0178
2022-03-27 15:20:37,381 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 0:15:01, time: 0.162, data_time: 0.001, memory: 3564, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0034, acc: 99.9297, loss_bbox: 0.0045, loss_mask: 0.0077, loss: 0.0177
2022-03-27 15:20:44,660 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 23:38:43, time: 0.146, data_time: 0.001, memory: 3564, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0018, acc: 99.9375, loss_bbox: 0.0038, loss_mask: 0.0076, loss: 0.0150
2022-03-27 15:20:51,841 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 23:03:51, time: 0.144, data_time: 0.001, memory: 3564, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0021, acc: 99.9395, loss_bbox: 0.0047, loss_mask: 0.0073, loss: 0.0160
2022-03-27 15:20:59,896 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 22:36:48, time: 0.161, data_time: 0.001, memory: 3571, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0009, acc: 99.9883, loss_bbox: 0.0042, loss_mask: 0.0066, loss: 0.0132
2022-03-27 15:21:07,121 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 22:05:51, time: 0.144, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0010, acc: 99.9766, loss_bbox: 0.0033, loss_mask: 0.0061, loss: 0.0122
2022-03-27 15:21:14,343 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 21:36:35, time: 0.145, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0011, acc: 99.9688, loss_bbox: 0.0040, loss_mask: 0.0069, loss: 0.0135
2022-03-27 15:21:22,508 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 21:14:37, time: 0.163, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0014, loss_cls: 0.0010, acc: 99.9805, loss_bbox: 0.0037, loss_mask: 0.0072, loss: 0.0134
2022-03-27 15:21:29,526 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 20:46:55, time: 0.140, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0005, acc: 99.9922, loss_bbox: 0.0036, loss_mask: 0.0066, loss: 0.0123
2022-03-27 15:21:37,669 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 20:27:09, time: 0.163, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0012, loss_cls: 0.0005, acc: 99.9922, loss_bbox: 0.0042, loss_mask: 0.0079, loss: 0.0141
2022-03-27 15:21:44,797 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 20:02:35, time: 0.143, data_time: 0.001, memory: 3584, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0014, loss_cls: 0.0010, acc: 99.9844, loss_bbox: 0.0034, loss_mask: 0.0070, loss: 0.0130
2022-03-27 15:21:51,693 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 19:37:53, time: 0.138, data_time: 0.001, memory: 3584, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0012, loss_cls: 0.0007, acc: 99.9863, loss_bbox: 0.0033, loss_mask: 0.0063, loss: 0.0117
2022-03-27 15:21:59,465 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 19:19:02, time: 0.155, data_time: 0.001, memory: 3584, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0013, loss_cls: 0.0010, acc: 99.9688, loss_bbox: 0.0029, loss_mask: 0.0066, loss: 0.0120
2022-03-27 15:22:06,598 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 18:57:43, time: 0.143, data_time: 0.001, memory: 3584, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0012, loss_cls: 0.0013, acc: 99.9688, loss_bbox: 0.0029, loss_mask: 0.0057, loss: 0.0113
2022-03-27 15:22:09,686 - mmdet - INFO - __benchmark_total_time(h):0.1357313471370273
2022-03-27 15:22:09,687 - mmdet - INFO - __benchmark_pure_training_time(h):0.13562753968768648
2022-03-27 15:22:09,689 - mmdet - INFO - __benchmark_avg_iter_time(s):0.1495651650976587
2022-03-27 15:22:09,690 - mmdet - INFO - __benchmark_mem_alloc(mb):3547
2022-03-27 15:22:09,690 - mmdet - INFO - __benchmark_mem_cached(mb):5392
[SH-IDC1-10-142-5-213][[52956,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 15:22:27,448 [32mINFO[0m: log service ip address is: 10.142.5.213:10137[0m
2022-03-27 15:22:27,449 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 15:23:15,652 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 15:23:15,654 - mmdet - INFO - Distributed training: False
2022-03-27 15:23:16,558 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 15:23:16,652 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 15:23:16,652 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 15:23:17,027 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.87s)
creating index...
index created!
loading annotations into memory...
Done (t=0.44s)
creating index...
index created!
2022-03-27 15:23:31,110 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 15:23:31,112 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 15:23:31,112 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 15:23:31,113 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 15:26:09,199 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 25 days, 17:43:56, time: 3.161, data_time: 0.089, memory: 3459, loss_rpn_cls: 0.3735, loss_rpn_bbox: 0.0142, loss_cls: 1.3653, acc: 88.2891, loss_bbox: 0.0564, loss_mask: 0.5777, loss: 2.3871
2022-03-27 15:26:16,237 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 10:35:50, time: 0.141, data_time: 0.001, memory: 3459, loss_rpn_cls: 0.0337, loss_rpn_bbox: 0.0048, loss_cls: 0.4726, acc: 98.3027, loss_bbox: 0.0808, loss_mask: 0.1747, loss: 0.7666
2022-03-27 15:26:24,484 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 9:47:26, time: 0.165, data_time: 0.001, memory: 3482, loss_rpn_cls: 0.0106, loss_rpn_bbox: 0.0038, loss_cls: 0.4070, acc: 99.3301, loss_bbox: 0.0364, loss_mask: 0.0822, loss: 0.5401
2022-03-27 15:26:31,289 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 7:58:43, time: 0.136, data_time: 0.001, memory: 3482, loss_rpn_cls: 0.0028, loss_rpn_bbox: 0.0062, loss_cls: 0.3158, acc: 99.7383, loss_bbox: 0.0232, loss_mask: 0.0496, loss: 0.3976
2022-03-27 15:26:39,081 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 2:51:57, time: 0.156, data_time: 0.001, memory: 3482, loss_rpn_cls: 0.0024, loss_rpn_bbox: 0.0054, loss_cls: 0.0932, acc: 99.6074, loss_bbox: 0.0213, loss_mask: 0.0428, loss: 0.1651
2022-03-27 15:26:45,994 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 6:52:46, time: 0.138, data_time: 0.001, memory: 3482, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0045, loss_cls: 0.0174, acc: 99.6777, loss_bbox: 0.0216, loss_mask: 0.0361, loss: 0.0813
2022-03-27 15:26:52,853 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 16:34:20, time: 0.137, data_time: 0.001, memory: 3482, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0044, loss_cls: 0.0108, acc: 99.8008, loss_bbox: 0.0186, loss_mask: 0.0311, loss: 0.0666
2022-03-27 15:27:00,847 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 6:23:56, time: 0.160, data_time: 0.001, memory: 3482, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0043, loss_cls: 0.0083, acc: 99.8457, loss_bbox: 0.0175, loss_mask: 0.0268, loss: 0.0582
2022-03-27 15:27:07,874 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 3 days, 22:03:47, time: 0.140, data_time: 0.001, memory: 3482, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0039, loss_cls: 0.0062, acc: 99.8730, loss_bbox: 0.0158, loss_mask: 0.0248, loss: 0.0521
2022-03-27 15:27:14,870 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 15:23:06, time: 0.140, data_time: 0.001, memory: 3482, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0037, loss_cls: 0.0056, acc: 99.8750, loss_bbox: 0.0161, loss_mask: 0.0222, loss: 0.0488
2022-03-27 15:27:22,941 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 10:18:03, time: 0.161, data_time: 0.001, memory: 3482, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0037, loss_cls: 0.0054, acc: 99.8691, loss_bbox: 0.0155, loss_mask: 0.0215, loss: 0.0469
2022-03-27 15:27:29,743 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 5:38:56, time: 0.136, data_time: 0.001, memory: 3484, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0033, loss_cls: 0.0070, acc: 99.8418, loss_bbox: 0.0130, loss_mask: 0.0195, loss: 0.0438
2022-03-27 15:27:37,327 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 1:56:43, time: 0.151, data_time: 0.001, memory: 3484, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0027, loss_cls: 0.0031, acc: 99.9414, loss_bbox: 0.0107, loss_mask: 0.0157, loss: 0.0330
2022-03-27 15:27:44,416 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 2 days, 22:38:26, time: 0.142, data_time: 0.001, memory: 3484, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0039, loss_cls: 0.0088, acc: 99.7617, loss_bbox: 0.0201, loss_mask: 0.0524, loss: 0.0873
2022-03-27 15:27:51,940 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 19:53:03, time: 0.150, data_time: 0.001, memory: 3529, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0030, loss_cls: 0.0100, acc: 99.7617, loss_bbox: 0.0148, loss_mask: 0.0253, loss: 0.0539
2022-03-27 15:27:59,722 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 17:32:11, time: 0.156, data_time: 0.001, memory: 3529, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0027, loss_cls: 0.0070, acc: 99.8418, loss_bbox: 0.0122, loss_mask: 0.0200, loss: 0.0425
2022-03-27 15:28:06,633 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 15:15:52, time: 0.138, data_time: 0.001, memory: 3529, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0023, loss_cls: 0.0036, acc: 99.9023, loss_bbox: 0.0078, loss_mask: 0.0136, loss: 0.0279
2022-03-27 15:28:13,526 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 13:14:21, time: 0.138, data_time: 0.001, memory: 3529, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0027, loss_cls: 0.0017, acc: 99.9629, loss_bbox: 0.0063, loss_mask: 0.0114, loss: 0.0227
2022-03-27 15:28:21,633 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 11:40:44, time: 0.162, data_time: 0.001, memory: 3529, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0023, loss_cls: 0.0021, acc: 99.9512, loss_bbox: 0.0064, loss_mask: 0.0118, loss: 0.0230
2022-03-27 15:28:29,000 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 10:07:37, time: 0.147, data_time: 0.001, memory: 3529, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0015, acc: 99.9727, loss_bbox: 0.0063, loss_mask: 0.0109, loss: 0.0213
2022-03-27 15:28:36,237 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 8:42:05, time: 0.145, data_time: 0.001, memory: 3529, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0022, loss_cls: 0.0022, acc: 99.9512, loss_bbox: 0.0056, loss_mask: 0.0126, loss: 0.0231
2022-03-27 15:28:44,709 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 7:37:25, time: 0.169, data_time: 0.001, memory: 3529, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0022, loss_cls: 0.0011, acc: 99.9766, loss_bbox: 0.0045, loss_mask: 0.0091, loss: 0.0174
2022-03-27 15:28:52,000 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 6:26:14, time: 0.146, data_time: 0.001, memory: 3529, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0047, acc: 99.8867, loss_bbox: 0.0056, loss_mask: 0.0098, loss: 0.0227
2022-03-27 15:28:59,886 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 5:26:53, time: 0.158, data_time: 0.001, memory: 3537, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0032, acc: 99.9082, loss_bbox: 0.0047, loss_mask: 0.0099, loss: 0.0201
2022-03-27 15:29:07,168 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 4:26:34, time: 0.146, data_time: 0.001, memory: 3543, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0020, acc: 99.9512, loss_bbox: 0.0050, loss_mask: 0.0082, loss: 0.0177
2022-03-27 15:29:14,332 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 3:29:54, time: 0.143, data_time: 0.001, memory: 3543, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0022, acc: 99.9570, loss_bbox: 0.0062, loss_mask: 0.0096, loss: 0.0203
2022-03-27 15:29:22,787 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 2:48:28, time: 0.169, data_time: 0.001, memory: 3543, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0021, acc: 99.9551, loss_bbox: 0.0058, loss_mask: 0.0094, loss: 0.0197
2022-03-27 15:29:30,011 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 1:59:48, time: 0.145, data_time: 0.001, memory: 3543, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0022, acc: 99.9355, loss_bbox: 0.0049, loss_mask: 0.0079, loss: 0.0173
2022-03-27 15:29:38,177 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 1:22:04, time: 0.163, data_time: 0.001, memory: 3557, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0021, acc: 99.9453, loss_bbox: 0.0044, loss_mask: 0.0067, loss: 0.0154
2022-03-27 15:29:45,408 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 0:39:31, time: 0.145, data_time: 0.001, memory: 3557, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0032, acc: 99.9277, loss_bbox: 0.0043, loss_mask: 0.0071, loss: 0.0164
2022-03-27 15:29:52,615 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 23:59:30, time: 0.144, data_time: 0.001, memory: 3557, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0023, acc: 99.9414, loss_bbox: 0.0057, loss_mask: 0.0076, loss: 0.0178
2022-03-27 15:30:00,743 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 23:28:46, time: 0.163, data_time: 0.001, memory: 3557, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0023, acc: 99.9395, loss_bbox: 0.0052, loss_mask: 0.0070, loss: 0.0169
2022-03-27 15:30:07,789 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 22:52:10, time: 0.141, data_time: 0.001, memory: 3557, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0032, acc: 99.9355, loss_bbox: 0.0041, loss_mask: 0.0066, loss: 0.0163
2022-03-27 15:30:14,904 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 22:18:16, time: 0.142, data_time: 0.001, memory: 3557, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0017, acc: 99.9551, loss_bbox: 0.0045, loss_mask: 0.0076, loss: 0.0159
2022-03-27 15:30:22,871 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 21:51:57, time: 0.159, data_time: 0.001, memory: 3574, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0036, acc: 99.8809, loss_bbox: 0.0036, loss_mask: 0.0066, loss: 0.0159
2022-03-27 15:30:30,013 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 21:21:41, time: 0.143, data_time: 0.001, memory: 3575, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0013, acc: 99.9668, loss_bbox: 0.0036, loss_mask: 0.0050, loss: 0.0118
2022-03-27 15:30:37,126 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 20:51:46, time: 0.139, data_time: 0.001, memory: 3575, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0034, acc: 99.9141, loss_bbox: 0.0052, loss_mask: 0.0076, loss: 0.0179
2022-03-27 15:30:44,235 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 20:25:38, time: 0.146, data_time: 0.005, memory: 3575, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0020, acc: 99.9297, loss_bbox: 0.0046, loss_mask: 0.0083, loss: 0.0166
2022-03-27 15:30:51,565 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 20:01:01, time: 0.146, data_time: 0.001, memory: 3575, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0026, acc: 99.9277, loss_bbox: 0.0040, loss_mask: 0.0077, loss: 0.0160
2022-03-27 15:30:58,942 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 19:37:59, time: 0.148, data_time: 0.001, memory: 3575, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0007, acc: 99.9766, loss_bbox: 0.0034, loss_mask: 0.0066, loss: 0.0125
2022-03-27 15:31:05,774 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 19:12:54, time: 0.137, data_time: 0.001, memory: 3595, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0012, acc: 99.9648, loss_bbox: 0.0042, loss_mask: 0.0078, loss: 0.0150
2022-03-27 15:31:13,034 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 18:51:22, time: 0.145, data_time: 0.001, memory: 3595, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0019, acc: 99.9375, loss_bbox: 0.0046, loss_mask: 0.0072, loss: 0.0156
2022-03-27 15:31:20,504 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 18:32:03, time: 0.150, data_time: 0.001, memory: 3595, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0013, acc: 99.9629, loss_bbox: 0.0036, loss_mask: 0.0074, loss: 0.0141
2022-03-27 15:31:27,416 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 18:10:34, time: 0.138, data_time: 0.001, memory: 3595, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0022, acc: 99.9629, loss_bbox: 0.0041, loss_mask: 0.0094, loss: 0.0173
2022-03-27 15:31:30,366 - mmdet - INFO - __benchmark_total_time(h):0.1332547687821918
2022-03-27 15:31:30,367 - mmdet - INFO - __benchmark_pure_training_time(h):0.1331258205572764
2022-03-27 15:31:30,367 - mmdet - INFO - __benchmark_avg_iter_time(s):0.1475838743127905
2022-03-27 15:31:30,368 - mmdet - INFO - __benchmark_mem_alloc(mb):3537
2022-03-27 15:31:30,368 - mmdet - INFO - __benchmark_mem_cached(mb):5264
[SH-IDC1-10-142-5-213][[62936,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 15:31:46,955 [32mINFO[0m: log service ip address is: 10.142.5.213:55358[0m
2022-03-27 15:31:46,956 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 15:32:32,695 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 15:32:32,697 - mmdet - INFO - Distributed training: False
2022-03-27 15:32:33,578 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 15:32:33,662 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 15:32:33,663 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 15:32:34,025 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=11.49s)
creating index...
index created!
loading annotations into memory...
Done (t=0.40s)
creating index...
index created!
2022-03-27 15:32:48,665 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 15:32:48,667 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 15:32:48,667 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 15:32:48,667 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 15:35:35,531 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 27 days, 4:01:46, time: 3.336, data_time: 0.090, memory: 3438, loss_rpn_cls: 0.3527, loss_rpn_bbox: 0.0125, loss_cls: 1.5183, acc: 86.6230, loss_bbox: 0.0358, loss_mask: 0.6076, loss: 2.5270
2022-03-27 15:35:42,497 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 14 days, 3:36:33, time: 0.139, data_time: 0.001, memory: 3464, loss_rpn_cls: 0.0357, loss_rpn_bbox: 0.0046, loss_cls: 0.4592, acc: 98.0078, loss_bbox: 0.0901, loss_mask: 0.2064, loss: 0.7960
2022-03-27 15:35:50,259 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 20:29:53, time: 0.155, data_time: 0.001, memory: 3481, loss_rpn_cls: 0.0102, loss_rpn_bbox: 0.0030, loss_cls: 0.3664, acc: 99.3281, loss_bbox: 0.0465, loss_mask: 0.0785, loss: 0.5045
2022-03-27 15:35:57,344 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 16:17:17, time: 0.142, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0030, loss_rpn_bbox: 0.0045, loss_cls: 0.2679, acc: 99.4707, loss_bbox: 0.0319, loss_mask: 0.0574, loss: 0.3647
2022-03-27 15:36:04,770 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 9:13:12, time: 0.148, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0030, loss_rpn_bbox: 0.0045, loss_cls: 0.1388, acc: 99.6191, loss_bbox: 0.0247, loss_mask: 0.0656, loss: 0.2366
2022-03-27 15:36:12,664 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 12:48:32, time: 0.158, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0021, loss_rpn_bbox: 0.0045, loss_cls: 0.0229, acc: 99.7207, loss_bbox: 0.0247, loss_mask: 0.0405, loss: 0.0946
2022-03-27 15:36:20,089 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 21:58:45, time: 0.149, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0041, loss_cls: 0.0127, acc: 99.7539, loss_bbox: 0.0212, loss_mask: 0.0354, loss: 0.0749
2022-03-27 15:36:27,918 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 10:50:34, time: 0.148, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0036, loss_cls: 0.0096, acc: 99.7871, loss_bbox: 0.0186, loss_mask: 0.0310, loss: 0.0642
2022-03-27 15:36:35,489 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 2:25:46, time: 0.160, data_time: 0.010, memory: 3486, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0037, loss_cls: 0.0056, acc: 99.8887, loss_bbox: 0.0163, loss_mask: 0.0262, loss: 0.0531
2022-03-27 15:36:43,227 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 19:36:06, time: 0.155, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0031, loss_cls: 0.0079, acc: 99.8184, loss_bbox: 0.0151, loss_mask: 0.0230, loss: 0.0501
2022-03-27 15:36:51,177 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 14:05:30, time: 0.159, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0032, loss_cls: 0.0053, acc: 99.8867, loss_bbox: 0.0137, loss_mask: 0.0214, loss: 0.0446
2022-03-27 15:36:58,173 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 9:11:24, time: 0.140, data_time: 0.001, memory: 3495, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0029, loss_cls: 0.0080, acc: 99.7891, loss_bbox: 0.0151, loss_mask: 0.0220, loss: 0.0489
2022-03-27 15:37:05,342 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 5:05:32, time: 0.143, data_time: 0.001, memory: 3495, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0027, loss_cls: 0.0072, acc: 99.8242, loss_bbox: 0.0126, loss_mask: 0.0193, loss: 0.0425
2022-03-27 15:37:13,606 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 1:53:06, time: 0.165, data_time: 0.001, memory: 3495, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0025, loss_cls: 0.0061, acc: 99.8379, loss_bbox: 0.0114, loss_mask: 0.0167, loss: 0.0378
2022-03-27 15:37:20,951 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 22:52:02, time: 0.147, data_time: 0.001, memory: 3538, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0026, loss_cls: 0.0055, acc: 99.8652, loss_bbox: 0.0120, loss_mask: 0.0187, loss: 0.0398
2022-03-27 15:37:29,007 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 20:23:55, time: 0.161, data_time: 0.001, memory: 3538, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0022, loss_cls: 0.0038, acc: 99.9160, loss_bbox: 0.0104, loss_mask: 0.0160, loss: 0.0330
2022-03-27 15:37:36,196 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 18:01:19, time: 0.144, data_time: 0.001, memory: 3538, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0030, acc: 99.9238, loss_bbox: 0.0101, loss_mask: 0.0157, loss: 0.0314
2022-03-27 15:37:43,323 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 15:53:43, time: 0.143, data_time: 0.001, memory: 3538, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0021, loss_cls: 0.0042, acc: 99.8789, loss_bbox: 0.0102, loss_mask: 0.0160, loss: 0.0332
2022-03-27 15:37:51,560 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 14:13:10, time: 0.165, data_time: 0.001, memory: 3538, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0021, loss_cls: 0.0051, acc: 99.8574, loss_bbox: 0.0087, loss_mask: 0.0148, loss: 0.0314
2022-03-27 15:37:58,786 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 12:30:57, time: 0.145, data_time: 0.001, memory: 3538, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0019, loss_cls: 0.0055, acc: 99.8574, loss_bbox: 0.0078, loss_mask: 0.0139, loss: 0.0297
2022-03-27 15:38:05,984 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 10:58:03, time: 0.144, data_time: 0.001, memory: 3538, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0028, acc: 99.9336, loss_bbox: 0.0075, loss_mask: 0.0126, loss: 0.0253
2022-03-27 15:38:14,408 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 9:46:33, time: 0.168, data_time: 0.001, memory: 3538, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0018, acc: 99.9375, loss_bbox: 0.0082, loss_mask: 0.0121, loss: 0.0243
2022-03-27 15:38:21,703 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 8:29:57, time: 0.146, data_time: 0.001, memory: 3538, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0021, loss_cls: 0.0015, acc: 99.9590, loss_bbox: 0.0078, loss_mask: 0.0119, loss: 0.0237
2022-03-27 15:38:29,826 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 7:27:44, time: 0.163, data_time: 0.001, memory: 3569, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0028, acc: 99.9238, loss_bbox: 0.0065, loss_mask: 0.0109, loss: 0.0225
2022-03-27 15:38:37,065 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 6:22:12, time: 0.145, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0008, acc: 99.9805, loss_bbox: 0.0052, loss_mask: 0.0091, loss: 0.0173
2022-03-27 15:38:44,318 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 5:21:45, time: 0.145, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0025, acc: 99.9297, loss_bbox: 0.0060, loss_mask: 0.0103, loss: 0.0209
2022-03-27 15:38:52,644 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 4:35:07, time: 0.166, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0022, acc: 99.9355, loss_bbox: 0.0060, loss_mask: 0.0107, loss: 0.0209
2022-03-27 15:38:59,764 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 3:41:46, time: 0.142, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0021, acc: 99.9492, loss_bbox: 0.0059, loss_mask: 0.0098, loss: 0.0198
2022-03-27 15:39:06,920 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 2:52:20, time: 0.143, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0033, acc: 99.9004, loss_bbox: 0.0071, loss_mask: 0.0117, loss: 0.0240
2022-03-27 15:39:14,846 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 2:12:11, time: 0.158, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0025, acc: 99.9434, loss_bbox: 0.0066, loss_mask: 0.0115, loss: 0.0224
2022-03-27 15:39:21,937 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 1:28:20, time: 0.142, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0061, acc: 99.8379, loss_bbox: 0.0085, loss_mask: 0.0116, loss: 0.0281
2022-03-27 15:39:29,872 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 0:53:23, time: 0.159, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0016, loss_cls: 0.0059, acc: 99.8398, loss_bbox: 0.0095, loss_mask: 0.0139, loss: 0.0314
2022-03-27 15:39:36,731 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 2 days, 0:12:57, time: 0.137, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0025, acc: 99.9375, loss_bbox: 0.0066, loss_mask: 0.0110, loss: 0.0220
2022-03-27 15:39:43,798 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 23:36:18, time: 0.141, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0011, acc: 99.9707, loss_bbox: 0.0050, loss_mask: 0.0089, loss: 0.0170
2022-03-27 15:39:51,783 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 23:07:50, time: 0.160, data_time: 0.001, memory: 3599, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0008, acc: 99.9824, loss_bbox: 0.0053, loss_mask: 0.0085, loss: 0.0163
2022-03-27 15:39:58,919 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 22:35:28, time: 0.143, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0006, acc: 99.9863, loss_bbox: 0.0057, loss_mask: 0.0095, loss: 0.0177
2022-03-27 15:40:06,122 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 22:05:16, time: 0.144, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0004, acc: 99.9980, loss_bbox: 0.0051, loss_mask: 0.0073, loss: 0.0146
2022-03-27 15:40:14,322 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 21:42:46, time: 0.164, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0003, acc: 100.0000, loss_bbox: 0.0051, loss_mask: 0.0066, loss: 0.0138
2022-03-27 15:40:21,846 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 21:17:22, time: 0.150, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0013, loss_cls: 0.0013, acc: 99.9727, loss_bbox: 0.0049, loss_mask: 0.0072, loss: 0.0149
2022-03-27 15:40:29,262 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 20:52:36, time: 0.148, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0018, acc: 99.9492, loss_bbox: 0.0054, loss_mask: 0.0080, loss: 0.0168
2022-03-27 15:40:35,990 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 20:25:08, time: 0.135, data_time: 0.001, memory: 3621, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0013, loss_cls: 0.0013, acc: 99.9668, loss_bbox: 0.0045, loss_mask: 0.0072, loss: 0.0145
2022-03-27 15:40:43,617 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 20:03:56, time: 0.152, data_time: 0.001, memory: 3621, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0005, acc: 99.9902, loss_bbox: 0.0043, loss_mask: 0.0072, loss: 0.0137
2022-03-27 15:40:51,045 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 19:42:38, time: 0.148, data_time: 0.001, memory: 3621, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0009, acc: 99.9844, loss_bbox: 0.0045, loss_mask: 0.0070, loss: 0.0140
2022-03-27 15:40:58,240 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 19:21:01, time: 0.144, data_time: 0.001, memory: 3621, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0013, loss_cls: 0.0003, acc: 99.9961, loss_bbox: 0.0041, loss_mask: 0.0068, loss: 0.0127
2022-03-27 15:41:01,169 - mmdet - INFO - __benchmark_total_time(h):0.13692434469858805
2022-03-27 15:41:01,170 - mmdet - INFO - __benchmark_pure_training_time(h):0.13680605596966214
2022-03-27 15:41:01,171 - mmdet - INFO - __benchmark_avg_iter_time(s):0.14846143570098724
2022-03-27 15:41:01,171 - mmdet - INFO - __benchmark_mem_alloc(mb):3569
2022-03-27 15:41:01,171 - mmdet - INFO - __benchmark_mem_cached(mb):5392
[SH-IDC1-10-142-5-213][[39343,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 15:41:17,755 [32mINFO[0m: log service ip address is: 10.142.5.213:43370[0m
2022-03-27 15:41:17,756 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 15:42:02,633 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 15:42:02,635 - mmdet - INFO - Distributed training: False
2022-03-27 15:42:03,529 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 15:42:03,618 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 15:42:03,619 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 15:42:03,967 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=12.12s)
creating index...
index created!
loading annotations into memory...
Done (t=0.48s)
creating index...
index created!
2022-03-27 15:42:19,152 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 15:42:19,154 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 15:42:19,154 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 15:42:19,154 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 15:45:01,380 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 26 days, 9:53:28, time: 3.244, data_time: 0.089, memory: 3436, loss_rpn_cls: 0.3838, loss_rpn_bbox: 0.0159, loss_cls: 1.3802, acc: 87.8398, loss_bbox: 0.0267, loss_mask: 0.5855, loss: 2.3922
2022-03-27 15:45:09,021 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 19:44:51, time: 0.152, data_time: 0.001, memory: 3469, loss_rpn_cls: 0.0355, loss_rpn_bbox: 0.0051, loss_cls: 0.4782, acc: 98.2129, loss_bbox: 0.0814, loss_mask: 0.1806, loss: 0.7809
2022-03-27 15:45:16,166 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 14:31:43, time: 0.144, data_time: 0.002, memory: 3498, loss_rpn_cls: 0.0092, loss_rpn_bbox: 0.0052, loss_cls: 0.4940, acc: 99.5039, loss_bbox: 0.0444, loss_mask: 0.0667, loss: 0.6195
2022-03-27 15:45:23,037 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 11:35:35, time: 0.137, data_time: 0.001, memory: 3498, loss_rpn_cls: 0.0037, loss_rpn_bbox: 0.0066, loss_cls: 0.3289, acc: 99.6562, loss_bbox: 0.0377, loss_mask: 0.0498, loss: 0.4267
2022-03-27 15:45:31,264 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 6:05:45, time: 0.165, data_time: 0.001, memory: 3498, loss_rpn_cls: 0.0025, loss_rpn_bbox: 0.0056, loss_cls: 0.0577, acc: 99.5586, loss_bbox: 0.0320, loss_mask: 0.0438, loss: 0.1416
2022-03-27 15:45:38,149 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 9:33:23, time: 0.138, data_time: 0.001, memory: 3498, loss_rpn_cls: 0.0022, loss_rpn_bbox: 0.0045, loss_cls: 0.0200, acc: 99.5195, loss_bbox: 0.0283, loss_mask: 0.0405, loss: 0.0955
2022-03-27 15:45:45,229 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 18:59:13, time: 0.141, data_time: 0.001, memory: 3498, loss_rpn_cls: 0.0021, loss_rpn_bbox: 0.0045, loss_cls: 0.0129, acc: 99.6367, loss_bbox: 0.0278, loss_mask: 0.0501, loss: 0.0974
2022-03-27 15:45:52,606 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 8:12:44, time: 0.148, data_time: 0.001, memory: 3498, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0048, loss_cls: 0.0108, acc: 99.7363, loss_bbox: 0.0189, loss_mask: 0.0296, loss: 0.0657
2022-03-27 15:45:59,571 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 3 days, 23:38:51, time: 0.139, data_time: 0.001, memory: 3498, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0040, loss_cls: 0.0081, acc: 99.8125, loss_bbox: 0.0164, loss_mask: 0.0266, loss: 0.0568
2022-03-27 15:46:06,521 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 16:47:33, time: 0.139, data_time: 0.001, memory: 3498, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0041, loss_cls: 0.0071, acc: 99.8223, loss_bbox: 0.0149, loss_mask: 0.0272, loss: 0.0545
2022-03-27 15:46:14,196 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 11:26:17, time: 0.153, data_time: 0.001, memory: 3498, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0040, loss_cls: 0.0069, acc: 99.7988, loss_bbox: 0.0155, loss_mask: 0.0210, loss: 0.0487
2022-03-27 15:46:21,189 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 6:45:21, time: 0.140, data_time: 0.002, memory: 3498, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0030, loss_cls: 0.0041, acc: 99.9062, loss_bbox: 0.0110, loss_mask: 0.0173, loss: 0.0360
2022-03-27 15:46:28,241 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 2:48:43, time: 0.141, data_time: 0.001, memory: 3498, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0034, loss_cls: 0.0052, acc: 99.8535, loss_bbox: 0.0108, loss_mask: 0.0166, loss: 0.0369
2022-03-27 15:46:36,404 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 2 days, 23:44:22, time: 0.163, data_time: 0.001, memory: 3498, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0028, loss_cls: 0.0104, acc: 99.7480, loss_bbox: 0.0142, loss_mask: 0.0194, loss: 0.0477
2022-03-27 15:46:43,499 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 20:47:56, time: 0.142, data_time: 0.001, memory: 3522, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0027, loss_cls: 0.0045, acc: 99.8574, loss_bbox: 0.0095, loss_mask: 0.0151, loss: 0.0329
2022-03-27 15:46:51,570 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 18:27:51, time: 0.161, data_time: 0.001, memory: 3522, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0027, loss_cls: 0.0080, acc: 99.8027, loss_bbox: 0.0128, loss_mask: 0.0173, loss: 0.0417
2022-03-27 15:46:58,556 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 16:08:35, time: 0.139, data_time: 0.001, memory: 3522, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0025, loss_cls: 0.0042, acc: 99.8965, loss_bbox: 0.0100, loss_mask: 0.0124, loss: 0.0298
2022-03-27 15:47:05,631 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 14:07:14, time: 0.143, data_time: 0.002, memory: 3522, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0025, loss_cls: 0.0033, acc: 99.9238, loss_bbox: 0.0083, loss_mask: 0.0122, loss: 0.0269
2022-03-27 15:47:13,806 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 12:31:34, time: 0.163, data_time: 0.001, memory: 3534, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0025, loss_cls: 0.0039, acc: 99.8926, loss_bbox: 0.0092, loss_mask: 0.0121, loss: 0.0284
2022-03-27 15:47:20,893 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 10:52:40, time: 0.142, data_time: 0.001, memory: 3534, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0022, loss_cls: 0.0057, acc: 99.8359, loss_bbox: 0.0078, loss_mask: 0.0122, loss: 0.0286
2022-03-27 15:47:27,889 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 9:22:20, time: 0.140, data_time: 0.001, memory: 3534, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0021, loss_cls: 0.0049, acc: 99.8477, loss_bbox: 0.0079, loss_mask: 0.0122, loss: 0.0277
2022-03-27 15:47:35,605 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 8:07:42, time: 0.154, data_time: 0.001, memory: 3534, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0022, loss_cls: 0.0040, acc: 99.8867, loss_bbox: 0.0072, loss_mask: 0.0115, loss: 0.0255
2022-03-27 15:47:42,785 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 6:54:06, time: 0.143, data_time: 0.001, memory: 3534, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0023, acc: 99.9277, loss_bbox: 0.0072, loss_mask: 0.0100, loss: 0.0220
2022-03-27 15:47:50,522 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 5:52:08, time: 0.155, data_time: 0.001, memory: 3549, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0034, acc: 99.8945, loss_bbox: 0.0069, loss_mask: 0.0104, loss: 0.0229
2022-03-27 15:47:57,326 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 4:46:20, time: 0.136, data_time: 0.001, memory: 3561, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0020, loss_cls: 0.0035, acc: 99.8906, loss_bbox: 0.0063, loss_mask: 0.0101, loss: 0.0226
2022-03-27 15:48:04,443 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 3:48:24, time: 0.142, data_time: 0.001, memory: 3561, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0034, acc: 99.8926, loss_bbox: 0.0082, loss_mask: 0.0116, loss: 0.0257
2022-03-27 15:48:12,658 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 3:04:16, time: 0.164, data_time: 0.001, memory: 3561, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0010, acc: 99.9844, loss_bbox: 0.0057, loss_mask: 0.0094, loss: 0.0184
2022-03-27 15:48:19,757 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 2:13:58, time: 0.142, data_time: 0.001, memory: 3561, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0018, loss_cls: 0.0024, acc: 99.9336, loss_bbox: 0.0057, loss_mask: 0.0093, loss: 0.0195
2022-03-27 15:48:26,644 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 1:25:28, time: 0.138, data_time: 0.001, memory: 3568, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0020, acc: 99.9473, loss_bbox: 0.0060, loss_mask: 0.0095, loss: 0.0198
2022-03-27 15:48:34,374 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 0:46:39, time: 0.154, data_time: 0.001, memory: 3568, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0020, loss_cls: 0.0025, acc: 99.9355, loss_bbox: 0.0050, loss_mask: 0.0083, loss: 0.0181
2022-03-27 15:48:41,600 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 0:06:35, time: 0.144, data_time: 0.002, memory: 3568, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0022, acc: 99.9355, loss_bbox: 0.0049, loss_mask: 0.0103, loss: 0.0196
2022-03-27 15:48:48,445 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 23:26:15, time: 0.137, data_time: 0.001, memory: 3568, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0011, acc: 99.9727, loss_bbox: 0.0044, loss_mask: 0.0084, loss: 0.0162
2022-03-27 15:48:55,723 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 22:51:24, time: 0.146, data_time: 0.001, memory: 3568, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0006, acc: 99.9941, loss_bbox: 0.0040, loss_mask: 0.0089, loss: 0.0156
2022-03-27 15:49:02,850 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 22:17:34, time: 0.143, data_time: 0.001, memory: 3568, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0008, acc: 99.9824, loss_bbox: 0.0043, loss_mask: 0.0069, loss: 0.0141
2022-03-27 15:49:11,011 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 21:52:33, time: 0.163, data_time: 0.001, memory: 3579, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0021, acc: 99.9453, loss_bbox: 0.0042, loss_mask: 0.0085, loss: 0.0166
2022-03-27 15:49:17,866 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 21:20:27, time: 0.137, data_time: 0.001, memory: 3589, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0030, acc: 99.9141, loss_bbox: 0.0041, loss_mask: 0.0071, loss: 0.0160
2022-03-27 15:49:24,665 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 20:49:41, time: 0.136, data_time: 0.001, memory: 3589, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0017, acc: 99.9531, loss_bbox: 0.0039, loss_mask: 0.0080, loss: 0.0155
2022-03-27 15:49:32,641 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 20:27:50, time: 0.160, data_time: 0.001, memory: 3589, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0019, loss_cls: 0.0021, acc: 99.9277, loss_bbox: 0.0047, loss_mask: 0.0084, loss: 0.0174
2022-03-27 15:49:39,648 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 20:01:16, time: 0.140, data_time: 0.001, memory: 3589, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0011, acc: 99.9785, loss_bbox: 0.0044, loss_mask: 0.0074, loss: 0.0150
2022-03-27 15:49:46,438 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 19:34:45, time: 0.136, data_time: 0.001, memory: 3589, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0027, acc: 99.9336, loss_bbox: 0.0041, loss_mask: 0.0075, loss: 0.0163
2022-03-27 15:49:54,123 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 19:14:37, time: 0.154, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0051, acc: 99.8262, loss_bbox: 0.0049, loss_mask: 0.0097, loss: 0.0216
2022-03-27 15:50:01,078 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 18:51:22, time: 0.139, data_time: 0.002, memory: 3603, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0016, acc: 99.9609, loss_bbox: 0.0051, loss_mask: 0.0084, loss: 0.0170
2022-03-27 15:50:08,032 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 18:29:14, time: 0.139, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0030, acc: 99.9375, loss_bbox: 0.0045, loss_mask: 0.0078, loss: 0.0173
2022-03-27 15:50:15,792 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 18:12:20, time: 0.155, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0018, acc: 99.9648, loss_bbox: 0.0041, loss_mask: 0.0072, loss: 0.0149
2022-03-27 15:50:18,766 - mmdet - INFO - __benchmark_total_time(h):0.13336649954319
2022-03-27 15:50:18,767 - mmdet - INFO - __benchmark_pure_training_time(h):0.13322546144326528
2022-03-27 15:50:18,769 - mmdet - INFO - __benchmark_avg_iter_time(s):0.1453544893464842
2022-03-27 15:50:18,769 - mmdet - INFO - __benchmark_mem_alloc(mb):3549
2022-03-27 15:50:18,769 - mmdet - INFO - __benchmark_mem_cached(mb):5264
[SH-IDC1-10-142-5-213][[47533,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 15:50:34,831 [32mINFO[0m: log service ip address is: 10.142.5.213:22058[0m
2022-03-27 15:50:34,831 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 15:51:20,195 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 15:51:20,197 - mmdet - INFO - Distributed training: False
2022-03-27 15:51:21,119 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 15:51:21,223 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 15:51:21,225 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 15:51:21,688 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=11.09s)
creating index...
index created!
loading annotations into memory...
Done (t=0.36s)
creating index...
index created!
2022-03-27 15:51:35,951 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 15:51:35,951 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 15:51:35,952 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 15:51:35,952 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 15:54:12,671 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 25 days, 12:23:08, time: 3.134, data_time: 0.089, memory: 3436, loss_rpn_cls: 0.3630, loss_rpn_bbox: 0.0139, loss_cls: 1.4594, acc: 87.4922, loss_bbox: 0.0289, loss_mask: 0.5726, loss: 2.4378
2022-03-27 15:54:20,516 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 9:30:49, time: 0.157, data_time: 0.001, memory: 3472, loss_rpn_cls: 0.0327, loss_rpn_bbox: 0.0046, loss_cls: 0.6018, acc: 98.1387, loss_bbox: 0.0871, loss_mask: 0.1651, loss: 0.8913
2022-03-27 15:54:27,538 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 7:28:15, time: 0.140, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0079, loss_rpn_bbox: 0.0044, loss_cls: 0.5940, acc: 99.4492, loss_bbox: 0.0440, loss_mask: 0.0578, loss: 0.7082
2022-03-27 15:54:34,512 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 6:24:03, time: 0.139, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0031, loss_rpn_bbox: 0.0063, loss_cls: 0.2384, acc: 99.6465, loss_bbox: 0.0248, loss_mask: 0.0443, loss: 0.3169
2022-03-27 15:54:42,772 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 1:58:08, time: 0.165, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0052, loss_cls: 0.0243, acc: 99.7227, loss_bbox: 0.0221, loss_mask: 0.0357, loss: 0.0892
2022-03-27 15:54:49,798 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 6:12:13, time: 0.140, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0047, loss_cls: 0.0128, acc: 99.7227, loss_bbox: 0.0164, loss_mask: 0.0333, loss: 0.0689
2022-03-27 15:54:56,625 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 15:58:45, time: 0.137, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0050, loss_cls: 0.0090, acc: 99.8027, loss_bbox: 0.0133, loss_mask: 0.0291, loss: 0.0580
2022-03-27 15:55:04,465 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 5:48:11, time: 0.157, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0040, loss_cls: 0.0083, acc: 99.8105, loss_bbox: 0.0135, loss_mask: 0.0269, loss: 0.0542
2022-03-27 15:55:11,874 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 3 days, 21:42:00, time: 0.148, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0042, loss_cls: 0.0077, acc: 99.8555, loss_bbox: 0.0149, loss_mask: 0.0285, loss: 0.0570
2022-03-27 15:55:18,756 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 15:00:50, time: 0.138, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0040, loss_cls: 0.0059, acc: 99.8281, loss_bbox: 0.0127, loss_mask: 0.0204, loss: 0.0444
2022-03-27 15:55:26,382 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 9:48:15, time: 0.152, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0035, loss_cls: 0.0037, acc: 99.9199, loss_bbox: 0.0089, loss_mask: 0.0138, loss: 0.0309
2022-03-27 15:55:33,330 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 5:14:33, time: 0.139, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0026, loss_rpn_bbox: 0.0041, loss_cls: 0.0062, acc: 99.8965, loss_bbox: 0.0075, loss_mask: 0.0603, loss: 0.0806
2022-03-27 15:55:40,939 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 1:34:56, time: 0.152, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0045, loss_cls: 0.0036, acc: 99.9180, loss_bbox: 0.0082, loss_mask: 0.0222, loss: 0.0394
2022-03-27 15:55:47,840 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 2 days, 22:14:49, time: 0.138, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0027, loss_cls: 0.0031, acc: 99.9395, loss_bbox: 0.0073, loss_mask: 0.0127, loss: 0.0266
2022-03-27 15:55:54,681 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 19:20:19, time: 0.137, data_time: 0.001, memory: 3493, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0030, loss_cls: 0.0021, acc: 99.9434, loss_bbox: 0.0062, loss_mask: 0.0102, loss: 0.0223
2022-03-27 15:56:02,926 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 17:08:15, time: 0.165, data_time: 0.001, memory: 3493, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0023, loss_cls: 0.0031, acc: 99.9395, loss_bbox: 0.0053, loss_mask: 0.0108, loss: 0.0221
2022-03-27 15:56:09,942 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 14:54:47, time: 0.140, data_time: 0.001, memory: 3493, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0028, loss_cls: 0.0024, acc: 99.9336, loss_bbox: 0.0070, loss_mask: 0.0122, loss: 0.0251
2022-03-27 15:56:16,914 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 12:55:35, time: 0.139, data_time: 0.001, memory: 3493, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0026, loss_cls: 0.0033, acc: 99.9238, loss_bbox: 0.0050, loss_mask: 0.0090, loss: 0.0204
2022-03-27 15:56:25,101 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 11:23:47, time: 0.164, data_time: 0.001, memory: 3506, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0024, loss_cls: 0.0021, acc: 99.9512, loss_bbox: 0.0043, loss_mask: 0.0088, loss: 0.0183
2022-03-27 15:56:32,065 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 9:46:55, time: 0.139, data_time: 0.002, memory: 3506, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0023, loss_cls: 0.0014, acc: 99.9727, loss_bbox: 0.0058, loss_mask: 0.0104, loss: 0.0205
2022-03-27 15:56:38,951 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 8:18:25, time: 0.138, data_time: 0.001, memory: 3506, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0022, loss_cls: 0.0017, acc: 99.9668, loss_bbox: 0.0045, loss_mask: 0.0064, loss: 0.0152
2022-03-27 15:56:47,114 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 7:11:27, time: 0.163, data_time: 0.001, memory: 3506, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0020, loss_cls: 0.0050, acc: 99.8730, loss_bbox: 0.0048, loss_mask: 0.0083, loss: 0.0207
2022-03-27 15:56:54,116 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 5:58:31, time: 0.140, data_time: 0.002, memory: 3506, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0021, loss_cls: 0.0016, acc: 99.9570, loss_bbox: 0.0038, loss_mask: 0.0066, loss: 0.0146
2022-03-27 15:57:01,922 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 4:59:31, time: 0.156, data_time: 0.001, memory: 3523, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0012, acc: 99.9805, loss_bbox: 0.0037, loss_mask: 0.0067, loss: 0.0137
2022-03-27 15:57:08,888 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 3:57:23, time: 0.139, data_time: 0.001, memory: 3533, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0013, acc: 99.9746, loss_bbox: 0.0027, loss_mask: 0.0066, loss: 0.0128
2022-03-27 15:57:15,798 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 2:59:27, time: 0.138, data_time: 0.001, memory: 3533, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0015, acc: 99.9609, loss_bbox: 0.0029, loss_mask: 0.0063, loss: 0.0130
2022-03-27 15:57:23,455 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 2:12:21, time: 0.153, data_time: 0.001, memory: 3533, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0010, acc: 99.9805, loss_bbox: 0.0031, loss_mask: 0.0055, loss: 0.0119
2022-03-27 15:57:30,901 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 1:26:44, time: 0.149, data_time: 0.001, memory: 3533, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0007, acc: 99.9902, loss_bbox: 0.0032, loss_mask: 0.0059, loss: 0.0119
2022-03-27 15:57:37,952 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 0:41:12, time: 0.141, data_time: 0.001, memory: 3537, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0012, acc: 99.9766, loss_bbox: 0.0025, loss_mask: 0.0068, loss: 0.0125
2022-03-27 15:57:45,451 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 0:02:07, time: 0.150, data_time: 0.001, memory: 3537, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0024, acc: 99.9258, loss_bbox: 0.0037, loss_mask: 0.0085, loss: 0.0165
2022-03-27 15:57:53,015 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 23:26:00, time: 0.151, data_time: 0.001, memory: 3537, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0018, loss_cls: 0.0012, acc: 99.9746, loss_bbox: 0.0034, loss_mask: 0.0060, loss: 0.0126
2022-03-27 15:58:00,332 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 22:50:25, time: 0.146, data_time: 0.001, memory: 3537, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0011, acc: 99.9688, loss_bbox: 0.0028, loss_mask: 0.0055, loss: 0.0114
2022-03-27 15:58:07,209 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 22:13:41, time: 0.137, data_time: 0.001, memory: 3537, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0021, acc: 99.9570, loss_bbox: 0.0037, loss_mask: 0.0108, loss: 0.0189
2022-03-27 15:58:14,293 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 21:40:44, time: 0.142, data_time: 0.001, memory: 3537, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0018, loss_cls: 0.0020, acc: 99.9473, loss_bbox: 0.0041, loss_mask: 0.0074, loss: 0.0156
2022-03-27 15:58:22,481 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 21:17:01, time: 0.164, data_time: 0.001, memory: 3555, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0005, acc: 99.9863, loss_bbox: 0.0023, loss_mask: 0.0041, loss: 0.0088
2022-03-27 15:58:29,429 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 20:46:30, time: 0.139, data_time: 0.001, memory: 3565, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0011, acc: 99.9531, loss_bbox: 0.0024, loss_mask: 0.0051, loss: 0.0105
2022-03-27 15:58:36,578 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 20:18:51, time: 0.143, data_time: 0.001, memory: 3565, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0013, acc: 99.9648, loss_bbox: 0.0026, loss_mask: 0.0048, loss: 0.0105
2022-03-27 15:58:44,578 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 19:57:59, time: 0.160, data_time: 0.001, memory: 3565, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0009, acc: 99.9785, loss_bbox: 0.0024, loss_mask: 0.0043, loss: 0.0095
2022-03-27 15:58:51,634 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 19:32:26, time: 0.141, data_time: 0.001, memory: 3565, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0015, loss_cls: 0.0003, acc: 99.9961, loss_bbox: 0.0023, loss_mask: 0.0037, loss: 0.0080
2022-03-27 15:58:58,588 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 19:07:39, time: 0.139, data_time: 0.001, memory: 3565, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0032, acc: 99.9277, loss_bbox: 0.0033, loss_mask: 0.0069, loss: 0.0150
2022-03-27 15:59:06,088 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 18:47:08, time: 0.150, data_time: 0.001, memory: 3570, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0016, loss_cls: 0.0026, acc: 99.9316, loss_bbox: 0.0045, loss_mask: 0.0144, loss: 0.0236
2022-03-27 15:59:13,036 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 18:24:28, time: 0.139, data_time: 0.001, memory: 3570, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0015, loss_cls: 0.0011, acc: 99.9766, loss_bbox: 0.0030, loss_mask: 0.0054, loss: 0.0113
2022-03-27 15:59:20,818 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 18:06:52, time: 0.154, data_time: 0.001, memory: 3570, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0005, acc: 99.9863, loss_bbox: 0.0021, loss_mask: 0.0045, loss: 0.0089
2022-03-27 15:59:27,921 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 17:47:35, time: 0.144, data_time: 0.003, memory: 3570, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0005, acc: 99.9941, loss_bbox: 0.0016, loss_mask: 0.0037, loss: 0.0076
2022-03-27 15:59:30,825 - mmdet - INFO - __benchmark_total_time(h):0.132014455265469
2022-03-27 15:59:30,826 - mmdet - INFO - __benchmark_pure_training_time(h):0.13190911306275263
2022-03-27 15:59:30,829 - mmdet - INFO - __benchmark_avg_iter_time(s):0.1460060418307126
2022-03-27 15:59:30,830 - mmdet - INFO - __benchmark_mem_alloc(mb):3523
2022-03-27 15:59:30,830 - mmdet - INFO - __benchmark_mem_cached(mb):5264
[SH-IDC1-10-142-5-213][[21851,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 15:59:47,882 [32mINFO[0m: log service ip address is: 10.142.5.213:11937[0m
2022-03-27 15:59:47,883 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 16:00:39,086 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 16:00:39,088 - mmdet - INFO - Distributed training: False
2022-03-27 16:00:40,001 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 16:00:40,170 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:00:40,172 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:00:40,662 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.95s)
creating index...
index created!
loading annotations into memory...
Done (t=0.44s)
creating index...
index created!
2022-03-27 16:00:54,684 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 16:00:54,686 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 16:00:54,686 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 16:00:54,686 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 16:03:31,063 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 25 days, 11:03:02, time: 3.127, data_time: 0.088, memory: 3432, loss_rpn_cls: 0.3725, loss_rpn_bbox: 0.0122, loss_cls: 1.5234, acc: 87.1426, loss_bbox: 0.0290, loss_mask: 0.5295, loss: 2.4666
2022-03-27 16:03:38,185 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 7:25:31, time: 0.142, data_time: 0.001, memory: 3462, loss_rpn_cls: 0.0335, loss_rpn_bbox: 0.0037, loss_cls: 0.5340, acc: 98.4844, loss_bbox: 0.0706, loss_mask: 0.1484, loss: 0.7902
2022-03-27 16:03:46,182 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 7:21:04, time: 0.160, data_time: 0.001, memory: 3475, loss_rpn_cls: 0.0109, loss_rpn_bbox: 0.0040, loss_cls: 0.5238, acc: 99.4102, loss_bbox: 0.0432, loss_mask: 0.0754, loss: 0.6574
2022-03-27 16:03:53,246 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 6:24:03, time: 0.141, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0035, loss_rpn_bbox: 0.0062, loss_cls: 0.2787, acc: 99.5586, loss_bbox: 0.0327, loss_mask: 0.0502, loss: 0.3714
2022-03-27 16:04:01,578 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 2:01:25, time: 0.167, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0028, loss_rpn_bbox: 0.0057, loss_cls: 0.0299, acc: 99.7090, loss_bbox: 0.0240, loss_mask: 0.0535, loss: 0.1160
2022-03-27 16:04:08,711 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 6:19:20, time: 0.143, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0023, loss_rpn_bbox: 0.0052, loss_cls: 0.0118, acc: 99.7637, loss_bbox: 0.0204, loss_mask: 0.0403, loss: 0.0801
2022-03-27 16:04:15,979 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 16:19:15, time: 0.145, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0049, loss_cls: 0.0096, acc: 99.7871, loss_bbox: 0.0219, loss_mask: 0.0308, loss: 0.0690
2022-03-27 16:04:23,847 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 6:07:03, time: 0.157, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0043, loss_cls: 0.0075, acc: 99.8457, loss_bbox: 0.0166, loss_mask: 0.0352, loss: 0.0654
2022-03-27 16:04:31,404 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 3 days, 22:02:43, time: 0.151, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0040, loss_cls: 0.0105, acc: 99.7344, loss_bbox: 0.0158, loss_mask: 0.0255, loss: 0.0570
2022-03-27 16:04:38,542 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 15:25:24, time: 0.143, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0033, loss_cls: 0.0094, acc: 99.7852, loss_bbox: 0.0145, loss_mask: 0.0257, loss: 0.0541
2022-03-27 16:04:46,476 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 10:17:12, time: 0.159, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0036, loss_cls: 0.0062, acc: 99.8496, loss_bbox: 0.0143, loss_mask: 0.0259, loss: 0.0512
2022-03-27 16:04:53,665 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 5:45:45, time: 0.144, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0026, loss_rpn_bbox: 0.0041, loss_cls: 0.0097, acc: 99.6973, loss_bbox: 0.0182, loss_mask: 0.0729, loss: 0.1075
2022-03-27 16:05:02,124 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 2:19:05, time: 0.169, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0033, loss_cls: 0.0089, acc: 99.7539, loss_bbox: 0.0153, loss_mask: 0.0297, loss: 0.0583
2022-03-27 16:05:09,275 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 2 days, 23:00:00, time: 0.143, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0033, loss_cls: 0.0043, acc: 99.8867, loss_bbox: 0.0099, loss_mask: 0.0168, loss: 0.0350
2022-03-27 16:05:16,517 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 20:08:46, time: 0.145, data_time: 0.001, memory: 3497, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0028, loss_cls: 0.0060, acc: 99.8418, loss_bbox: 0.0114, loss_mask: 0.0170, loss: 0.0380
2022-03-27 16:05:24,371 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 17:47:55, time: 0.157, data_time: 0.001, memory: 3497, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0027, loss_cls: 0.0058, acc: 99.8574, loss_bbox: 0.0085, loss_mask: 0.0155, loss: 0.0332
2022-03-27 16:05:31,646 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 15:35:40, time: 0.146, data_time: 0.001, memory: 3497, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0024, loss_cls: 0.0043, acc: 99.8848, loss_bbox: 0.0091, loss_mask: 0.0205, loss: 0.0372
2022-03-27 16:05:38,771 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 13:36:11, time: 0.143, data_time: 0.001, memory: 3497, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0027, loss_cls: 0.0058, acc: 99.8555, loss_bbox: 0.0089, loss_mask: 0.0132, loss: 0.0311
2022-03-27 16:05:46,332 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 11:54:35, time: 0.151, data_time: 0.001, memory: 3509, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0025, loss_cls: 0.0057, acc: 99.8828, loss_bbox: 0.0101, loss_mask: 0.0178, loss: 0.0367
2022-03-27 16:05:53,485 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 10:18:21, time: 0.143, data_time: 0.001, memory: 3509, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0025, loss_cls: 0.0032, acc: 99.9199, loss_bbox: 0.0084, loss_mask: 0.0141, loss: 0.0288
2022-03-27 16:06:01,679 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 9:02:51, time: 0.164, data_time: 0.001, memory: 3509, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0008, acc: 99.9863, loss_bbox: 0.0071, loss_mask: 0.0111, loss: 0.0215
2022-03-27 16:06:08,938 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 7:44:22, time: 0.145, data_time: 0.001, memory: 3509, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0017, acc: 99.9551, loss_bbox: 0.0060, loss_mask: 0.0105, loss: 0.0207
2022-03-27 16:06:16,223 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 6:32:51, time: 0.146, data_time: 0.001, memory: 3509, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0036, acc: 99.9199, loss_bbox: 0.0074, loss_mask: 0.0122, loss: 0.0257
2022-03-27 16:06:24,023 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 5:32:23, time: 0.156, data_time: 0.001, memory: 3530, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0023, acc: 99.9434, loss_bbox: 0.0059, loss_mask: 0.0091, loss: 0.0197
2022-03-27 16:06:31,508 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 4:33:43, time: 0.150, data_time: 0.001, memory: 3544, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0018, acc: 99.9512, loss_bbox: 0.0065, loss_mask: 0.0099, loss: 0.0208
2022-03-27 16:06:38,666 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 3:36:42, time: 0.143, data_time: 0.001, memory: 3544, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0016, acc: 99.9629, loss_bbox: 0.0051, loss_mask: 0.0082, loss: 0.0173
2022-03-27 16:06:46,643 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 2:50:57, time: 0.160, data_time: 0.001, memory: 3544, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0005, acc: 99.9980, loss_bbox: 0.0047, loss_mask: 0.0094, loss: 0.0169
2022-03-27 16:06:53,881 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 2:02:15, time: 0.145, data_time: 0.001, memory: 3544, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0008, acc: 99.9844, loss_bbox: 0.0048, loss_mask: 0.0087, loss: 0.0164
2022-03-27 16:07:02,141 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 1:25:13, time: 0.165, data_time: 0.001, memory: 3552, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0021, loss_cls: 0.0019, acc: 99.9609, loss_bbox: 0.0057, loss_mask: 0.0087, loss: 0.0188
2022-03-27 16:07:09,385 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 0:42:40, time: 0.145, data_time: 0.001, memory: 3552, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0013, acc: 99.9590, loss_bbox: 0.0055, loss_mask: 0.0088, loss: 0.0176
2022-03-27 16:07:16,548 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 0:02:13, time: 0.143, data_time: 0.001, memory: 3552, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0020, loss_cls: 0.0008, acc: 99.9863, loss_bbox: 0.0048, loss_mask: 0.0081, loss: 0.0160
2022-03-27 16:07:25,097 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 23:34:31, time: 0.171, data_time: 0.001, memory: 3552, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0006, acc: 99.9922, loss_bbox: 0.0055, loss_mask: 0.0076, loss: 0.0159
2022-03-27 16:07:32,219 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 22:58:17, time: 0.142, data_time: 0.001, memory: 3552, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0019, acc: 99.9570, loss_bbox: 0.0050, loss_mask: 0.0082, loss: 0.0172
2022-03-27 16:07:39,357 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 22:24:20, time: 0.143, data_time: 0.001, memory: 3552, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0012, acc: 99.9707, loss_bbox: 0.0050, loss_mask: 0.0081, loss: 0.0161
2022-03-27 16:07:47,598 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 21:59:40, time: 0.165, data_time: 0.001, memory: 3557, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0026, acc: 99.9473, loss_bbox: 0.0050, loss_mask: 0.0082, loss: 0.0179
2022-03-27 16:07:54,919 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 21:30:22, time: 0.146, data_time: 0.001, memory: 3567, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0017, acc: 99.9551, loss_bbox: 0.0043, loss_mask: 0.0084, loss: 0.0166
2022-03-27 16:08:02,680 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 21:05:28, time: 0.155, data_time: 0.001, memory: 3567, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0018, acc: 99.9590, loss_bbox: 0.0042, loss_mask: 0.0080, loss: 0.0157
2022-03-27 16:08:09,982 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 20:39:02, time: 0.146, data_time: 0.001, memory: 3567, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0013, acc: 99.9629, loss_bbox: 0.0039, loss_mask: 0.0066, loss: 0.0137
2022-03-27 16:08:17,087 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 20:12:42, time: 0.142, data_time: 0.001, memory: 3567, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0021, acc: 99.9434, loss_bbox: 0.0039, loss_mask: 0.0086, loss: 0.0164
2022-03-27 16:08:25,205 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 19:53:43, time: 0.163, data_time: 0.001, memory: 3567, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0025, acc: 99.9316, loss_bbox: 0.0041, loss_mask: 0.0085, loss: 0.0167
2022-03-27 16:08:32,509 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 19:30:55, time: 0.146, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0014, loss_cls: 0.0019, acc: 99.9453, loss_bbox: 0.0037, loss_mask: 0.0075, loss: 0.0148
2022-03-27 16:08:39,490 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 19:07:28, time: 0.140, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0021, acc: 99.9336, loss_bbox: 0.0061, loss_mask: 0.0114, loss: 0.0212
2022-03-27 16:08:47,200 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 18:49:02, time: 0.154, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0018, acc: 99.9531, loss_bbox: 0.0043, loss_mask: 0.0095, loss: 0.0176
2022-03-27 16:08:54,492 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 18:29:13, time: 0.146, data_time: 0.001, memory: 3577, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0008, acc: 99.9785, loss_bbox: 0.0039, loss_mask: 0.0074, loss: 0.0141
2022-03-27 16:08:57,491 - mmdet - INFO - __benchmark_total_time(h):0.1342423646317588
2022-03-27 16:08:57,491 - mmdet - INFO - __benchmark_pure_training_time(h):0.13411223491032917
2022-03-27 16:08:57,492 - mmdet - INFO - __benchmark_avg_iter_time(s):0.15050417131239122
2022-03-27 16:08:57,492 - mmdet - INFO - __benchmark_mem_alloc(mb):3530
2022-03-27 16:08:57,492 - mmdet - INFO - __benchmark_mem_cached(mb):5264
[SH-IDC1-10-142-5-213][[30330,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 16:09:13,909 [32mINFO[0m: log service ip address is: 10.142.5.213:16964[0m
2022-03-27 16:09:13,909 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 16:10:01,997 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 16:10:01,999 - mmdet - INFO - Distributed training: False
2022-03-27 16:10:02,899 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 16:10:02,992 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:10:02,992 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:10:03,365 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=11.74s)
creating index...
index created!
loading annotations into memory...
Done (t=0.39s)
creating index...
index created!
2022-03-27 16:10:18,430 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 16:10:18,431 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 16:10:18,432 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 16:10:18,432 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 16:12:59,289 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 26 days, 4:32:52, time: 3.216, data_time: 0.091, memory: 3471, loss_rpn_cls: 0.3430, loss_rpn_bbox: 0.0142, loss_cls: 1.3927, acc: 88.1621, loss_bbox: 0.0652, loss_mask: 0.5533, loss: 2.3684
2022-03-27 16:13:06,505 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 16:21:46, time: 0.144, data_time: 0.001, memory: 3471, loss_rpn_cls: 0.0300, loss_rpn_bbox: 0.0050, loss_cls: 0.3999, acc: 98.5098, loss_bbox: 0.0797, loss_mask: 0.1636, loss: 0.6782
2022-03-27 16:13:14,859 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 13:46:29, time: 0.167, data_time: 0.001, memory: 3477, loss_rpn_cls: 0.0090, loss_rpn_bbox: 0.0034, loss_cls: 0.3592, acc: 99.4688, loss_bbox: 0.0372, loss_mask: 0.0945, loss: 0.5033
2022-03-27 16:13:22,054 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 11:20:52, time: 0.144, data_time: 0.001, memory: 3484, loss_rpn_cls: 0.0027, loss_rpn_bbox: 0.0063, loss_cls: 0.3019, acc: 99.6465, loss_bbox: 0.0274, loss_mask: 0.0556, loss: 0.3939
2022-03-27 16:13:29,180 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 5:02:11, time: 0.143, data_time: 0.001, memory: 3484, loss_rpn_cls: 0.0022, loss_rpn_bbox: 0.0047, loss_cls: 0.1340, acc: 99.7246, loss_bbox: 0.0250, loss_mask: 0.0436, loss: 0.2095
2022-03-27 16:13:37,128 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 9:21:36, time: 0.159, data_time: 0.001, memory: 3484, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0040, loss_cls: 0.0306, acc: 99.7324, loss_bbox: 0.0248, loss_mask: 0.0400, loss: 0.1012
2022-03-27 16:13:44,776 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 19:08:36, time: 0.153, data_time: 0.001, memory: 3484, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0047, loss_cls: 0.0103, acc: 99.8105, loss_bbox: 0.0203, loss_mask: 0.0301, loss: 0.0667
2022-03-27 16:13:52,602 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 8:33:49, time: 0.156, data_time: 0.001, memory: 3484, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0037, loss_cls: 0.0075, acc: 99.8672, loss_bbox: 0.0158, loss_mask: 0.0265, loss: 0.0548
2022-03-27 16:13:59,806 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 0:04:00, time: 0.144, data_time: 0.001, memory: 3484, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0036, loss_cls: 0.0132, acc: 99.6797, loss_bbox: 0.0186, loss_mask: 0.0284, loss: 0.0650
2022-03-27 16:14:07,086 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 17:17:47, time: 0.146, data_time: 0.001, memory: 3484, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0033, loss_cls: 0.0100, acc: 99.7773, loss_bbox: 0.0178, loss_mask: 0.0421, loss: 0.0748
2022-03-27 16:14:14,928 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 11:57:27, time: 0.157, data_time: 0.001, memory: 3484, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0033, loss_cls: 0.0089, acc: 99.7949, loss_bbox: 0.0164, loss_mask: 0.0242, loss: 0.0539
2022-03-27 16:14:22,083 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 7:17:03, time: 0.143, data_time: 0.001, memory: 3491, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0028, loss_cls: 0.0081, acc: 99.8262, loss_bbox: 0.0148, loss_mask: 0.0195, loss: 0.0462
2022-03-27 16:14:29,230 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 3:19:45, time: 0.143, data_time: 0.001, memory: 3498, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0028, loss_cls: 0.0071, acc: 99.8281, loss_bbox: 0.0121, loss_mask: 0.0182, loss: 0.0410
2022-03-27 16:14:37,131 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 0:08:41, time: 0.158, data_time: 0.001, memory: 3498, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0027, loss_cls: 0.0034, acc: 99.9199, loss_bbox: 0.0089, loss_mask: 0.0152, loss: 0.0308
2022-03-27 16:14:44,322 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 21:12:12, time: 0.144, data_time: 0.001, memory: 3520, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0022, loss_cls: 0.0064, acc: 99.8438, loss_bbox: 0.0104, loss_mask: 0.0166, loss: 0.0363
2022-03-27 16:14:52,608 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 18:53:38, time: 0.166, data_time: 0.001, memory: 3520, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0022, loss_cls: 0.0031, acc: 99.9316, loss_bbox: 0.0090, loss_mask: 0.0138, loss: 0.0289
2022-03-27 16:14:59,803 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 16:36:29, time: 0.144, data_time: 0.001, memory: 3520, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0025, loss_cls: 0.0042, acc: 99.8887, loss_bbox: 0.0089, loss_mask: 0.0142, loss: 0.0306
2022-03-27 16:15:06,984 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 14:34:22, time: 0.144, data_time: 0.001, memory: 3520, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0022, loss_cls: 0.0036, acc: 99.9238, loss_bbox: 0.0097, loss_mask: 0.0122, loss: 0.0283
2022-03-27 16:15:14,457 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 12:48:30, time: 0.149, data_time: 0.001, memory: 3524, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0019, acc: 99.9375, loss_bbox: 0.0079, loss_mask: 0.0105, loss: 0.0228
2022-03-27 16:15:21,587 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 11:09:26, time: 0.143, data_time: 0.001, memory: 3524, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0031, acc: 99.9336, loss_bbox: 0.0073, loss_mask: 0.0115, loss: 0.0242
2022-03-27 16:15:28,554 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 9:37:49, time: 0.139, data_time: 0.001, memory: 3524, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0036, acc: 99.9160, loss_bbox: 0.0079, loss_mask: 0.0110, loss: 0.0248
2022-03-27 16:15:36,109 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 8:20:45, time: 0.151, data_time: 0.001, memory: 3524, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0037, acc: 99.8809, loss_bbox: 0.0083, loss_mask: 0.0109, loss: 0.0252
2022-03-27 16:15:43,375 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 7:07:34, time: 0.145, data_time: 0.001, memory: 3524, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0020, acc: 99.9590, loss_bbox: 0.0070, loss_mask: 0.0097, loss: 0.0209
2022-03-27 16:15:50,475 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 5:58:47, time: 0.142, data_time: 0.001, memory: 3559, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0024, acc: 99.9258, loss_bbox: 0.0058, loss_mask: 0.0089, loss: 0.0194
2022-03-27 16:15:58,442 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 5:03:35, time: 0.159, data_time: 0.001, memory: 3569, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0020, acc: 99.9531, loss_bbox: 0.0067, loss_mask: 0.0103, loss: 0.0208
2022-03-27 16:16:05,706 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 4:06:20, time: 0.145, data_time: 0.001, memory: 3569, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0018, loss_cls: 0.0026, acc: 99.9336, loss_bbox: 0.0068, loss_mask: 0.0100, loss: 0.0215
2022-03-27 16:16:13,562 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 3:18:26, time: 0.157, data_time: 0.001, memory: 3569, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0035, acc: 99.8945, loss_bbox: 0.0068, loss_mask: 0.0096, loss: 0.0218
2022-03-27 16:16:20,904 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 2:29:40, time: 0.147, data_time: 0.001, memory: 3569, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0023, acc: 99.9512, loss_bbox: 0.0067, loss_mask: 0.0092, loss: 0.0205
2022-03-27 16:16:28,177 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 1:43:39, time: 0.145, data_time: 0.001, memory: 3569, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0015, acc: 99.9590, loss_bbox: 0.0051, loss_mask: 0.0071, loss: 0.0159
2022-03-27 16:16:36,496 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 1:08:56, time: 0.166, data_time: 0.001, memory: 3569, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0013, loss_cls: 0.0012, acc: 99.9727, loss_bbox: 0.0046, loss_mask: 0.0072, loss: 0.0147
2022-03-27 16:16:43,508 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 0:26:32, time: 0.140, data_time: 0.001, memory: 3569, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0014, acc: 99.9531, loss_bbox: 0.0043, loss_mask: 0.0077, loss: 0.0154
2022-03-27 16:16:50,461 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 23:46:19, time: 0.139, data_time: 0.001, memory: 3569, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0022, acc: 99.9473, loss_bbox: 0.0051, loss_mask: 0.0079, loss: 0.0170
2022-03-27 16:16:58,730 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 23:17:54, time: 0.165, data_time: 0.001, memory: 3569, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0005, acc: 99.9941, loss_bbox: 0.0043, loss_mask: 0.0072, loss: 0.0136
2022-03-27 16:17:05,874 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 22:43:24, time: 0.143, data_time: 0.001, memory: 3569, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0015, loss_cls: 0.0034, acc: 99.9160, loss_bbox: 0.0051, loss_mask: 0.0099, loss: 0.0202
2022-03-27 16:17:13,751 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 22:15:46, time: 0.158, data_time: 0.001, memory: 3584, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0019, acc: 99.9551, loss_bbox: 0.0049, loss_mask: 0.0091, loss: 0.0178
2022-03-27 16:17:20,956 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 21:45:16, time: 0.144, data_time: 0.001, memory: 3595, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0035, acc: 99.8809, loss_bbox: 0.0070, loss_mask: 0.0093, loss: 0.0217
2022-03-27 16:17:28,369 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 21:17:46, time: 0.148, data_time: 0.001, memory: 3595, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0013, loss_cls: 0.0011, acc: 99.9727, loss_bbox: 0.0044, loss_mask: 0.0080, loss: 0.0151
2022-03-27 16:17:36,182 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 20:54:06, time: 0.156, data_time: 0.001, memory: 3595, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0009, acc: 99.9766, loss_bbox: 0.0041, loss_mask: 0.0067, loss: 0.0135
2022-03-27 16:17:43,442 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 20:28:23, time: 0.145, data_time: 0.001, memory: 3595, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0013, loss_cls: 0.0016, acc: 99.9492, loss_bbox: 0.0030, loss_mask: 0.0080, loss: 0.0142
2022-03-27 16:17:50,521 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 20:02:53, time: 0.142, data_time: 0.001, memory: 3595, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0015, acc: 99.9609, loss_bbox: 0.0037, loss_mask: 0.0078, loss: 0.0145
2022-03-27 16:17:58,729 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 19:45:02, time: 0.164, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0004, acc: 99.9961, loss_bbox: 0.0039, loss_mask: 0.0076, loss: 0.0136
2022-03-27 16:18:05,980 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 19:22:43, time: 0.145, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0003, acc: 99.9941, loss_bbox: 0.0036, loss_mask: 0.0079, loss: 0.0134
2022-03-27 16:18:14,306 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 19:07:17, time: 0.167, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0006, acc: 99.9863, loss_bbox: 0.0033, loss_mask: 0.0070, loss: 0.0124
2022-03-27 16:18:21,320 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 18:45:36, time: 0.140, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0014, loss_cls: 0.0008, acc: 99.9824, loss_bbox: 0.0034, loss_mask: 0.0066, loss: 0.0124
2022-03-27 16:18:24,299 - mmdet - INFO - __benchmark_total_time(h):0.13507660481664868
2022-03-27 16:18:24,303 - mmdet - INFO - __benchmark_pure_training_time(h):0.13496248251861998
2022-03-27 16:18:24,304 - mmdet - INFO - __benchmark_avg_iter_time(s):0.15086374559126176
2022-03-27 16:18:24,304 - mmdet - INFO - __benchmark_mem_alloc(mb):3559
2022-03-27 16:18:24,304 - mmdet - INFO - __benchmark_mem_cached(mb):5392
[SH-IDC1-10-142-5-213][[7558,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 16:18:40,873 [32mINFO[0m: log service ip address is: 10.142.5.213:37015[0m
2022-03-27 16:18:40,874 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 16:19:24,260 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 16:19:24,262 - mmdet - INFO - Distributed training: False
2022-03-27 16:19:25,150 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 16:19:25,233 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:19:25,234 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:19:25,603 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.61s)
creating index...
index created!
loading annotations into memory...
Done (t=0.47s)
creating index...
index created!
2022-03-27 16:19:39,422 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 16:19:39,424 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 16:19:39,424 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 16:19:39,424 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 16:22:16,879 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 25 days, 15:14:39, time: 3.148, data_time: 0.089, memory: 3446, loss_rpn_cls: 0.3608, loss_rpn_bbox: 0.0149, loss_cls: 1.4798, acc: 87.3223, loss_bbox: 0.0401, loss_mask: 0.5321, loss: 2.4276
2022-03-27 16:22:24,686 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 10:51:34, time: 0.156, data_time: 0.001, memory: 3470, loss_rpn_cls: 0.0307, loss_rpn_bbox: 0.0046, loss_cls: 0.4745, acc: 98.5391, loss_bbox: 0.0712, loss_mask: 0.1507, loss: 0.7316
2022-03-27 16:22:32,174 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 8:58:54, time: 0.150, data_time: 0.001, memory: 3470, loss_rpn_cls: 0.0075, loss_rpn_bbox: 0.0058, loss_cls: 0.4767, acc: 99.5020, loss_bbox: 0.0379, loss_mask: 0.0751, loss: 0.6029
2022-03-27 16:22:39,419 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 7:48:11, time: 0.145, data_time: 0.001, memory: 3478, loss_rpn_cls: 0.0033, loss_rpn_bbox: 0.0065, loss_cls: 0.3488, acc: 99.6309, loss_bbox: 0.0293, loss_mask: 0.0516, loss: 0.4395
2022-03-27 16:22:47,657 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 3:04:17, time: 0.165, data_time: 0.001, memory: 3478, loss_rpn_cls: 0.0027, loss_rpn_bbox: 0.0055, loss_cls: 0.0995, acc: 99.6172, loss_bbox: 0.0249, loss_mask: 0.0426, loss: 0.1753
2022-03-27 16:22:54,838 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 7:13:19, time: 0.143, data_time: 0.001, memory: 3478, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0048, loss_cls: 0.0177, acc: 99.7031, loss_bbox: 0.0210, loss_mask: 0.0511, loss: 0.0966
2022-03-27 16:23:01,938 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 17:00:19, time: 0.142, data_time: 0.001, memory: 3478, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0048, loss_cls: 0.0117, acc: 99.7227, loss_bbox: 0.0175, loss_mask: 0.0344, loss: 0.0701
2022-03-27 16:23:09,749 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 6:41:19, time: 0.156, data_time: 0.001, memory: 3478, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0048, loss_cls: 0.0076, acc: 99.8047, loss_bbox: 0.0154, loss_mask: 0.0267, loss: 0.0560
2022-03-27 16:23:17,185 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 3 days, 22:29:47, time: 0.149, data_time: 0.001, memory: 3478, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0040, loss_cls: 0.0074, acc: 99.8125, loss_bbox: 0.0138, loss_mask: 0.0265, loss: 0.0533
2022-03-27 16:23:24,936 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 16:04:10, time: 0.155, data_time: 0.001, memory: 3478, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0039, loss_cls: 0.0092, acc: 99.7832, loss_bbox: 0.0165, loss_mask: 0.0298, loss: 0.0608
2022-03-27 16:23:31,955 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 10:32:58, time: 0.140, data_time: 0.001, memory: 3478, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0035, loss_cls: 0.0056, acc: 99.8926, loss_bbox: 0.0125, loss_mask: 0.0165, loss: 0.0391
2022-03-27 16:23:39,582 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 6:08:48, time: 0.153, data_time: 0.001, memory: 3483, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0034, loss_cls: 0.0062, acc: 99.8750, loss_bbox: 0.0116, loss_mask: 0.0184, loss: 0.0405
2022-03-27 16:23:47,433 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 2:29:22, time: 0.157, data_time: 0.001, memory: 3490, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0031, loss_cls: 0.0052, acc: 99.8926, loss_bbox: 0.0112, loss_mask: 0.0163, loss: 0.0366
2022-03-27 16:23:54,691 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 2 days, 23:11:10, time: 0.145, data_time: 0.001, memory: 3490, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0024, loss_cls: 0.0071, acc: 99.8574, loss_bbox: 0.0079, loss_mask: 0.0138, loss: 0.0321
2022-03-27 16:24:01,878 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 20:18:35, time: 0.144, data_time: 0.001, memory: 3507, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0028, loss_cls: 0.0044, acc: 99.8789, loss_bbox: 0.0086, loss_mask: 0.0137, loss: 0.0303
2022-03-27 16:24:09,582 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 17:54:52, time: 0.154, data_time: 0.001, memory: 3507, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0030, loss_cls: 0.0038, acc: 99.9102, loss_bbox: 0.0076, loss_mask: 0.0117, loss: 0.0267
2022-03-27 16:24:16,651 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 15:39:16, time: 0.141, data_time: 0.001, memory: 3507, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0027, loss_cls: 0.0036, acc: 99.9043, loss_bbox: 0.0078, loss_mask: 0.0135, loss: 0.0283
2022-03-27 16:24:24,774 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 13:52:36, time: 0.163, data_time: 0.001, memory: 3507, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0027, loss_cls: 0.0029, acc: 99.9336, loss_bbox: 0.0067, loss_mask: 0.0119, loss: 0.0249
2022-03-27 16:24:31,954 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 12:05:28, time: 0.144, data_time: 0.001, memory: 3511, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0023, loss_cls: 0.0023, acc: 99.9355, loss_bbox: 0.0063, loss_mask: 0.0122, loss: 0.0239
2022-03-27 16:24:39,025 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 10:27:42, time: 0.141, data_time: 0.001, memory: 3511, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0022, loss_cls: 0.0031, acc: 99.9082, loss_bbox: 0.0064, loss_mask: 0.0120, loss: 0.0244
2022-03-27 16:24:47,244 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 9:12:05, time: 0.164, data_time: 0.001, memory: 3511, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0023, loss_cls: 0.0027, acc: 99.9219, loss_bbox: 0.0055, loss_mask: 0.0113, loss: 0.0223
2022-03-27 16:24:54,507 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 7:53:08, time: 0.145, data_time: 0.001, memory: 3511, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0022, loss_cls: 0.0020, acc: 99.9590, loss_bbox: 0.0053, loss_mask: 0.0099, loss: 0.0198
2022-03-27 16:25:01,642 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 6:39:48, time: 0.143, data_time: 0.001, memory: 3511, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0022, loss_cls: 0.0018, acc: 99.9512, loss_bbox: 0.0051, loss_mask: 0.0101, loss: 0.0196
2022-03-27 16:25:09,145 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 5:36:07, time: 0.150, data_time: 0.001, memory: 3540, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0014, acc: 99.9805, loss_bbox: 0.0047, loss_mask: 0.0092, loss: 0.0179
2022-03-27 16:25:16,391 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 4:35:01, time: 0.145, data_time: 0.001, memory: 3550, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0014, acc: 99.9707, loss_bbox: 0.0042, loss_mask: 0.0080, loss: 0.0160
2022-03-27 16:25:24,163 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 3:43:30, time: 0.156, data_time: 0.001, memory: 3550, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0018, acc: 99.9551, loss_bbox: 0.0039, loss_mask: 0.0089, loss: 0.0170
2022-03-27 16:25:31,026 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 2:47:50, time: 0.137, data_time: 0.001, memory: 3550, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0018, loss_cls: 0.0012, acc: 99.9746, loss_bbox: 0.0050, loss_mask: 0.0097, loss: 0.0182
2022-03-27 16:25:38,303 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 1:59:33, time: 0.145, data_time: 0.001, memory: 3550, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0017, acc: 99.9629, loss_bbox: 0.0041, loss_mask: 0.0086, loss: 0.0167
2022-03-27 16:25:46,096 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 1:18:52, time: 0.156, data_time: 0.001, memory: 3555, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0035, acc: 99.8730, loss_bbox: 0.0054, loss_mask: 0.0102, loss: 0.0216
2022-03-27 16:25:53,245 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 0:35:45, time: 0.143, data_time: 0.001, memory: 3555, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0020, loss_cls: 0.0029, acc: 99.9238, loss_bbox: 0.0049, loss_mask: 0.0113, loss: 0.0217
2022-03-27 16:26:00,112 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 23:53:22, time: 0.137, data_time: 0.001, memory: 3555, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0021, loss_cls: 0.0040, acc: 99.8711, loss_bbox: 0.0046, loss_mask: 0.0105, loss: 0.0215
2022-03-27 16:26:07,928 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 23:20:31, time: 0.156, data_time: 0.001, memory: 3555, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0027, acc: 99.9238, loss_bbox: 0.0044, loss_mask: 0.0078, loss: 0.0172
2022-03-27 16:26:15,024 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 22:44:31, time: 0.142, data_time: 0.001, memory: 3555, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0013, acc: 99.9668, loss_bbox: 0.0044, loss_mask: 0.0088, loss: 0.0169
2022-03-27 16:26:21,981 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 22:09:45, time: 0.139, data_time: 0.001, memory: 3555, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0018, loss_cls: 0.0014, acc: 99.9590, loss_bbox: 0.0035, loss_mask: 0.0073, loss: 0.0144
2022-03-27 16:26:29,241 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 21:38:57, time: 0.145, data_time: 0.001, memory: 3575, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0027, acc: 99.9141, loss_bbox: 0.0047, loss_mask: 0.0101, loss: 0.0197
2022-03-27 16:26:36,443 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 21:09:27, time: 0.144, data_time: 0.001, memory: 3580, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0020, acc: 99.9258, loss_bbox: 0.0037, loss_mask: 0.0095, loss: 0.0172
2022-03-27 16:26:44,232 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 20:45:18, time: 0.156, data_time: 0.001, memory: 3580, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0006, acc: 99.9805, loss_bbox: 0.0031, loss_mask: 0.0076, loss: 0.0134
2022-03-27 16:26:51,022 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 20:16:14, time: 0.136, data_time: 0.001, memory: 3580, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0018, acc: 99.9453, loss_bbox: 0.0052, loss_mask: 0.0086, loss: 0.0177
2022-03-27 16:26:58,104 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 19:50:23, time: 0.142, data_time: 0.001, memory: 3580, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0026, acc: 99.9277, loss_bbox: 0.0041, loss_mask: 0.0080, loss: 0.0166
2022-03-27 16:27:05,430 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 19:27:18, time: 0.147, data_time: 0.001, memory: 3580, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0014, acc: 99.9590, loss_bbox: 0.0042, loss_mask: 0.0087, loss: 0.0162
2022-03-27 16:27:12,565 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 19:04:01, time: 0.142, data_time: 0.001, memory: 3595, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0018, acc: 99.9434, loss_bbox: 0.0033, loss_mask: 0.0077, loss: 0.0148
2022-03-27 16:27:19,594 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 18:41:39, time: 0.141, data_time: 0.002, memory: 3595, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0011, acc: 99.9688, loss_bbox: 0.0034, loss_mask: 0.0089, loss: 0.0153
2022-03-27 16:27:27,454 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 18:24:38, time: 0.157, data_time: 0.001, memory: 3595, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0012, acc: 99.9727, loss_bbox: 0.0039, loss_mask: 0.0083, loss: 0.0154
2022-03-27 16:27:34,696 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 18:05:04, time: 0.145, data_time: 0.001, memory: 3595, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0002, acc: 100.0000, loss_bbox: 0.0033, loss_mask: 0.0069, loss: 0.0122
2022-03-27 16:27:37,644 - mmdet - INFO - __benchmark_total_time(h):0.13297645939721
2022-03-27 16:27:37,644 - mmdet - INFO - __benchmark_pure_training_time(h):0.13283879988723332
2022-03-27 16:27:37,645 - mmdet - INFO - __benchmark_avg_iter_time(s):0.1455572647052807
2022-03-27 16:27:37,645 - mmdet - INFO - __benchmark_mem_alloc(mb):3540
2022-03-27 16:27:37,645 - mmdet - INFO - __benchmark_mem_cached(mb):5392
[SH-IDC1-10-142-5-213][[49350,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 16:27:54,556 [32mINFO[0m: log service ip address is: 10.142.5.213:51624[0m
2022-03-27 16:27:54,557 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 16:28:42,497 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 16:28:42,499 - mmdet - INFO - Distributed training: False
2022-03-27 16:28:43,393 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 16:28:43,550 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:28:43,551 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:28:43,995 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.62s)
creating index...
index created!
loading annotations into memory...
Done (t=0.35s)
creating index...
index created!
2022-03-27 16:28:57,598 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 16:28:57,599 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 16:28:57,599 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 16:28:57,599 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 16:31:32,548 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 25 days, 5:28:02, time: 3.098, data_time: 0.089, memory: 3447, loss_rpn_cls: 0.3616, loss_rpn_bbox: 0.0132, loss_cls: 1.4600, acc: 87.5645, loss_bbox: 0.0494, loss_mask: 0.6005, loss: 2.4847
2022-03-27 16:31:39,992 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 5:15:54, time: 0.149, data_time: 0.001, memory: 3481, loss_rpn_cls: 0.0335, loss_rpn_bbox: 0.0044, loss_cls: 0.4091, acc: 98.1758, loss_bbox: 0.0914, loss_mask: 0.1789, loss: 0.7172
2022-03-27 16:31:47,950 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 5:51:24, time: 0.159, data_time: 0.001, memory: 3489, loss_rpn_cls: 0.0125, loss_rpn_bbox: 0.0030, loss_cls: 0.3322, acc: 99.3008, loss_bbox: 0.0461, loss_mask: 0.0830, loss: 0.4768
2022-03-27 16:31:55,685 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 5:56:28, time: 0.155, data_time: 0.001, memory: 3489, loss_rpn_cls: 0.0037, loss_rpn_bbox: 0.0043, loss_cls: 0.2813, acc: 99.5684, loss_bbox: 0.0304, loss_mask: 0.0728, loss: 0.3925
2022-03-27 16:32:03,865 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 1:31:57, time: 0.164, data_time: 0.001, memory: 3489, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0055, loss_cls: 0.1833, acc: 99.8047, loss_bbox: 0.0235, loss_mask: 0.0383, loss: 0.2524
2022-03-27 16:32:11,037 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 5:56:41, time: 0.144, data_time: 0.001, memory: 3489, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0045, loss_cls: 0.0374, acc: 99.7871, loss_bbox: 0.0168, loss_mask: 0.0323, loss: 0.0926
2022-03-27 16:32:18,184 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 15:55:48, time: 0.143, data_time: 0.000, memory: 3489, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0043, loss_cls: 0.0106, acc: 99.8398, loss_bbox: 0.0154, loss_mask: 0.0308, loss: 0.0624
2022-03-27 16:32:26,390 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 5:56:12, time: 0.164, data_time: 0.001, memory: 3489, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0035, loss_cls: 0.0106, acc: 99.8008, loss_bbox: 0.0196, loss_mask: 0.0333, loss: 0.0682
2022-03-27 16:32:33,550 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 3 days, 21:42:48, time: 0.143, data_time: 0.001, memory: 3489, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0037, loss_cls: 0.0082, acc: 99.8125, loss_bbox: 0.0192, loss_mask: 0.0268, loss: 0.0592
2022-03-27 16:32:40,782 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 15:09:41, time: 0.145, data_time: 0.001, memory: 3489, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0035, loss_cls: 0.0092, acc: 99.7559, loss_bbox: 0.0165, loss_mask: 0.0287, loss: 0.0591
2022-03-27 16:32:48,947 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 10:07:43, time: 0.163, data_time: 0.001, memory: 3489, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0029, loss_cls: 0.0088, acc: 99.7812, loss_bbox: 0.0165, loss_mask: 0.0236, loss: 0.0528
2022-03-27 16:32:56,124 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 5:37:01, time: 0.144, data_time: 0.001, memory: 3489, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0030, loss_cls: 0.0081, acc: 99.8047, loss_bbox: 0.0116, loss_mask: 0.0197, loss: 0.0431
2022-03-27 16:33:04,268 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 2:04:53, time: 0.162, data_time: 0.001, memory: 3489, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0030, loss_cls: 0.0066, acc: 99.8359, loss_bbox: 0.0117, loss_mask: 0.0205, loss: 0.0426
2022-03-27 16:33:11,473 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 2 days, 22:48:02, time: 0.145, data_time: 0.002, memory: 3489, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0025, loss_cls: 0.0046, acc: 99.8867, loss_bbox: 0.0096, loss_mask: 0.0163, loss: 0.0339
2022-03-27 16:33:18,584 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 19:55:41, time: 0.142, data_time: 0.001, memory: 3505, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0026, loss_cls: 0.0052, acc: 99.8613, loss_bbox: 0.0093, loss_mask: 0.0178, loss: 0.0357
2022-03-27 16:33:26,947 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 17:42:59, time: 0.167, data_time: 0.001, memory: 3505, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0026, loss_cls: 0.0034, acc: 99.9062, loss_bbox: 0.0089, loss_mask: 0.0139, loss: 0.0294
2022-03-27 16:33:34,215 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 15:30:59, time: 0.145, data_time: 0.001, memory: 3505, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0032, acc: 99.9238, loss_bbox: 0.0064, loss_mask: 0.0115, loss: 0.0237
2022-03-27 16:33:41,460 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 13:33:17, time: 0.145, data_time: 0.001, memory: 3505, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0060, acc: 99.8477, loss_bbox: 0.0107, loss_mask: 0.0168, loss: 0.0359
2022-03-27 16:33:49,240 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 11:54:28, time: 0.155, data_time: 0.001, memory: 3532, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0021, loss_cls: 0.0044, acc: 99.8906, loss_bbox: 0.0095, loss_mask: 0.0153, loss: 0.0318
2022-03-27 16:33:56,406 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 10:18:28, time: 0.143, data_time: 0.001, memory: 3532, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0030, acc: 99.9160, loss_bbox: 0.0088, loss_mask: 0.0138, loss: 0.0280
2022-03-27 16:34:04,648 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 9:03:30, time: 0.165, data_time: 0.001, memory: 3532, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0035, acc: 99.9043, loss_bbox: 0.0075, loss_mask: 0.0129, loss: 0.0260
2022-03-27 16:34:11,690 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 7:42:39, time: 0.141, data_time: 0.001, memory: 3532, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0019, acc: 99.9570, loss_bbox: 0.0066, loss_mask: 0.0109, loss: 0.0216
2022-03-27 16:34:18,780 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 6:29:16, time: 0.142, data_time: 0.001, memory: 3532, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0021, acc: 99.9473, loss_bbox: 0.0064, loss_mask: 0.0112, loss: 0.0219
2022-03-27 16:34:27,149 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 5:34:23, time: 0.167, data_time: 0.001, memory: 3552, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0030, acc: 99.9219, loss_bbox: 0.0055, loss_mask: 0.0107, loss: 0.0213
2022-03-27 16:34:34,394 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 4:33:31, time: 0.145, data_time: 0.001, memory: 3560, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0029, acc: 99.9336, loss_bbox: 0.0048, loss_mask: 0.0103, loss: 0.0200
2022-03-27 16:34:41,527 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 3:36:13, time: 0.143, data_time: 0.001, memory: 3560, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0018, acc: 99.9512, loss_bbox: 0.0052, loss_mask: 0.0109, loss: 0.0199
2022-03-27 16:34:49,862 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 2:53:33, time: 0.167, data_time: 0.001, memory: 3560, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0026, acc: 99.9355, loss_bbox: 0.0053, loss_mask: 0.0108, loss: 0.0205
2022-03-27 16:34:57,066 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 2:04:33, time: 0.144, data_time: 0.001, memory: 3560, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0016, acc: 99.9609, loss_bbox: 0.0058, loss_mask: 0.0097, loss: 0.0191
2022-03-27 16:35:05,409 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 1:28:01, time: 0.167, data_time: 0.001, memory: 3564, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0022, acc: 99.9355, loss_bbox: 0.0062, loss_mask: 0.0107, loss: 0.0210
2022-03-27 16:35:12,502 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 0:44:18, time: 0.142, data_time: 0.001, memory: 3564, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0014, acc: 99.9648, loss_bbox: 0.0043, loss_mask: 0.0094, loss: 0.0171
2022-03-27 16:35:19,768 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 0:04:35, time: 0.145, data_time: 0.001, memory: 3564, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0016, acc: 99.9434, loss_bbox: 0.0044, loss_mask: 0.0094, loss: 0.0174
2022-03-27 16:35:27,179 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 23:28:24, time: 0.148, data_time: 0.001, memory: 3564, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0036, acc: 99.8828, loss_bbox: 0.0052, loss_mask: 0.0105, loss: 0.0211
2022-03-27 16:35:34,893 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 22:56:35, time: 0.154, data_time: 0.001, memory: 3564, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0027, acc: 99.9082, loss_bbox: 0.0044, loss_mask: 0.0089, loss: 0.0177
2022-03-27 16:35:41,906 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 22:21:49, time: 0.140, data_time: 0.001, memory: 3564, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0012, acc: 99.9688, loss_bbox: 0.0042, loss_mask: 0.0080, loss: 0.0152
2022-03-27 16:35:48,997 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 21:49:31, time: 0.142, data_time: 0.001, memory: 3583, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0031, acc: 99.9238, loss_bbox: 0.0058, loss_mask: 0.0096, loss: 0.0202
2022-03-27 16:35:56,182 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 21:19:38, time: 0.144, data_time: 0.001, memory: 3591, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0012, acc: 99.9727, loss_bbox: 0.0039, loss_mask: 0.0086, loss: 0.0156
2022-03-27 16:36:03,228 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 20:50:18, time: 0.140, data_time: 0.001, memory: 3591, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0012, acc: 99.9766, loss_bbox: 0.0043, loss_mask: 0.0096, loss: 0.0169
2022-03-27 16:36:11,042 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 20:27:37, time: 0.157, data_time: 0.002, memory: 3591, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0016, acc: 99.9551, loss_bbox: 0.0044, loss_mask: 0.0086, loss: 0.0162
2022-03-27 16:36:17,972 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 20:00:34, time: 0.139, data_time: 0.001, memory: 3591, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0014, acc: 99.9629, loss_bbox: 0.0042, loss_mask: 0.0085, loss: 0.0157
2022-03-27 16:36:25,776 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 19:40:00, time: 0.156, data_time: 0.001, memory: 3591, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0011, acc: 99.9766, loss_bbox: 0.0037, loss_mask: 0.0086, loss: 0.0150
2022-03-27 16:36:32,774 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 19:15:51, time: 0.140, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0008, acc: 99.9824, loss_bbox: 0.0035, loss_mask: 0.0076, loss: 0.0136
2022-03-27 16:36:40,090 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 18:54:35, time: 0.146, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0019, acc: 99.9531, loss_bbox: 0.0038, loss_mask: 0.0083, loss: 0.0157
2022-03-27 16:36:47,837 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 18:36:39, time: 0.155, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0013, loss_cls: 0.0025, acc: 99.9434, loss_bbox: 0.0048, loss_mask: 0.0091, loss: 0.0179
2022-03-27 16:36:55,016 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 18:16:31, time: 0.144, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0012, loss_cls: 0.0005, acc: 99.9980, loss_bbox: 0.0038, loss_mask: 0.0080, loss: 0.0136
2022-03-27 16:36:57,990 - mmdet - INFO - __benchmark_total_time(h):0.13354540950722166
2022-03-27 16:36:57,990 - mmdet - INFO - __benchmark_pure_training_time(h):0.13344168709384072
2022-03-27 16:36:57,991 - mmdet - INFO - __benchmark_avg_iter_time(s):0.14788915489341592
2022-03-27 16:36:57,991 - mmdet - INFO - __benchmark_mem_alloc(mb):3552
2022-03-27 16:36:57,991 - mmdet - INFO - __benchmark_mem_cached(mb):5264
[SH-IDC1-10-142-5-213][[57376,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 16:37:14,745 [32mINFO[0m: log service ip address is: 10.142.5.213:59488[0m
2022-03-27 16:37:14,746 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 16:37:57,041 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 16:37:57,043 - mmdet - INFO - Distributed training: False
2022-03-27 16:37:57,950 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 16:37:58,046 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:37:58,047 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:37:58,501 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.62s)
creating index...
index created!
loading annotations into memory...
Done (t=0.35s)
creating index...
index created!
2022-03-27 16:38:12,018 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 16:38:12,019 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 16:38:12,020 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 16:38:12,020 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 16:40:45,745 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 25 days, 0:12:45, time: 3.071, data_time: 0.089, memory: 3450, loss_rpn_cls: 0.3496, loss_rpn_bbox: 0.0132, loss_cls: 1.4832, acc: 86.9746, loss_bbox: 0.0598, loss_mask: 0.5983, loss: 2.5041
2022-03-27 16:40:52,788 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 1:51:35, time: 0.141, data_time: 0.001, memory: 3465, loss_rpn_cls: 0.0297, loss_rpn_bbox: 0.0046, loss_cls: 0.6638, acc: 98.4023, loss_bbox: 0.0800, loss_mask: 0.1779, loss: 0.9560
2022-03-27 16:41:00,570 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 3:21:23, time: 0.156, data_time: 0.001, memory: 3477, loss_rpn_cls: 0.0099, loss_rpn_bbox: 0.0035, loss_cls: 0.5088, acc: 99.5156, loss_bbox: 0.0365, loss_mask: 0.0687, loss: 0.6274
2022-03-27 16:41:07,970 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 3:44:10, time: 0.148, data_time: 0.001, memory: 3490, loss_rpn_cls: 0.0032, loss_rpn_bbox: 0.0049, loss_cls: 0.2554, acc: 99.5723, loss_bbox: 0.0363, loss_mask: 0.0471, loss: 0.3469
2022-03-27 16:41:15,919 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 5 days, 23:35:23, time: 0.159, data_time: 0.001, memory: 3490, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0050, loss_cls: 0.0392, acc: 99.6445, loss_bbox: 0.0288, loss_mask: 0.0380, loss: 0.1130
2022-03-27 16:41:23,284 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 4:26:54, time: 0.147, data_time: 0.001, memory: 3490, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0046, loss_cls: 0.0161, acc: 99.6504, loss_bbox: 0.0250, loss_mask: 0.0334, loss: 0.0808
2022-03-27 16:41:30,472 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 14:40:29, time: 0.144, data_time: 0.001, memory: 3490, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0040, loss_cls: 0.0129, acc: 99.6836, loss_bbox: 0.0219, loss_mask: 0.0297, loss: 0.0699
2022-03-27 16:41:38,959 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 4:58:38, time: 0.170, data_time: 0.001, memory: 3490, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0040, loss_cls: 0.0091, acc: 99.7754, loss_bbox: 0.0156, loss_mask: 0.0243, loss: 0.0543
2022-03-27 16:41:46,275 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 3 days, 20:55:19, time: 0.146, data_time: 0.001, memory: 3490, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0035, loss_cls: 0.0101, acc: 99.7031, loss_bbox: 0.0169, loss_mask: 0.0231, loss: 0.0549
2022-03-27 16:41:53,387 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 14:24:20, time: 0.142, data_time: 0.002, memory: 3490, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0034, loss_cls: 0.0136, acc: 99.6094, loss_bbox: 0.0184, loss_mask: 0.0357, loss: 0.0726
2022-03-27 16:42:01,666 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 9:29:04, time: 0.166, data_time: 0.001, memory: 3490, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0032, loss_cls: 0.0072, acc: 99.8281, loss_bbox: 0.0137, loss_mask: 0.0275, loss: 0.0530
2022-03-27 16:42:08,844 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 5:01:24, time: 0.143, data_time: 0.001, memory: 3490, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0031, loss_cls: 0.0082, acc: 99.8047, loss_bbox: 0.0134, loss_mask: 0.0217, loss: 0.0472
2022-03-27 16:42:16,982 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 1:32:27, time: 0.163, data_time: 0.001, memory: 3495, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0025, loss_cls: 0.0095, acc: 99.7285, loss_bbox: 0.0145, loss_mask: 0.0195, loss: 0.0471
2022-03-27 16:42:24,399 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 2 days, 22:20:56, time: 0.148, data_time: 0.001, memory: 3495, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0025, loss_cls: 0.0092, acc: 99.7324, loss_bbox: 0.0148, loss_mask: 0.0184, loss: 0.0456
2022-03-27 16:42:31,582 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 19:31:32, time: 0.144, data_time: 0.001, memory: 3526, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0023, loss_cls: 0.0069, acc: 99.7949, loss_bbox: 0.0154, loss_mask: 0.0182, loss: 0.0435
2022-03-27 16:42:39,536 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 17:14:29, time: 0.159, data_time: 0.001, memory: 3526, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0026, loss_cls: 0.0059, acc: 99.8223, loss_bbox: 0.0114, loss_mask: 0.0183, loss: 0.0390
2022-03-27 16:42:46,861 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 15:04:50, time: 0.146, data_time: 0.001, memory: 3526, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0023, loss_cls: 0.0048, acc: 99.8574, loss_bbox: 0.0119, loss_mask: 0.0181, loss: 0.0377
2022-03-27 16:42:55,309 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 13:24:17, time: 0.169, data_time: 0.001, memory: 3526, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0019, loss_cls: 0.0069, acc: 99.8223, loss_bbox: 0.0118, loss_mask: 0.0165, loss: 0.0378
2022-03-27 16:43:02,072 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 11:33:30, time: 0.135, data_time: 0.001, memory: 3543, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0020, loss_cls: 0.0054, acc: 99.8340, loss_bbox: 0.0100, loss_mask: 0.0150, loss: 0.0331
2022-03-27 16:43:08,909 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 9:54:34, time: 0.137, data_time: 0.001, memory: 3543, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0047, acc: 99.8691, loss_bbox: 0.0097, loss_mask: 0.0138, loss: 0.0304
2022-03-27 16:43:17,200 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 8:41:21, time: 0.166, data_time: 0.001, memory: 3543, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0070, acc: 99.8086, loss_bbox: 0.0095, loss_mask: 0.0142, loss: 0.0331
2022-03-27 16:43:24,396 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 7:23:07, time: 0.144, data_time: 0.001, memory: 3543, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0027, acc: 99.9219, loss_bbox: 0.0078, loss_mask: 0.0129, loss: 0.0258
2022-03-27 16:43:31,539 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 6:11:10, time: 0.143, data_time: 0.001, memory: 3543, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0033, acc: 99.9062, loss_bbox: 0.0065, loss_mask: 0.0107, loss: 0.0226
2022-03-27 16:43:39,849 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 5:16:30, time: 0.166, data_time: 0.001, memory: 3557, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0027, acc: 99.8926, loss_bbox: 0.0065, loss_mask: 0.0106, loss: 0.0220
2022-03-27 16:43:46,980 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 4:15:11, time: 0.143, data_time: 0.001, memory: 3560, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0022, acc: 99.9316, loss_bbox: 0.0062, loss_mask: 0.0100, loss: 0.0204
2022-03-27 16:43:55,183 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 3:27:16, time: 0.162, data_time: 0.001, memory: 3560, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0017, acc: 99.9648, loss_bbox: 0.0057, loss_mask: 0.0092, loss: 0.0189
2022-03-27 16:44:02,571 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 2:37:44, time: 0.150, data_time: 0.003, memory: 3560, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0014, loss_cls: 0.0040, acc: 99.8633, loss_bbox: 0.0076, loss_mask: 0.0118, loss: 0.0251
2022-03-27 16:44:09,700 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 1:48:38, time: 0.143, data_time: 0.001, memory: 3560, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0030, acc: 99.9316, loss_bbox: 0.0062, loss_mask: 0.0101, loss: 0.0213
2022-03-27 16:44:17,777 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 1:10:32, time: 0.161, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0010, acc: 99.9824, loss_bbox: 0.0055, loss_mask: 0.0084, loss: 0.0169
2022-03-27 16:44:25,199 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 0:29:53, time: 0.148, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0019, acc: 99.9492, loss_bbox: 0.0064, loss_mask: 0.0085, loss: 0.0187
2022-03-27 16:44:32,319 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 23:49:34, time: 0.142, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0038, acc: 99.8965, loss_bbox: 0.0059, loss_mask: 0.0096, loss: 0.0213
2022-03-27 16:44:40,360 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 23:18:28, time: 0.161, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0030, acc: 99.8926, loss_bbox: 0.0063, loss_mask: 0.0095, loss: 0.0210
2022-03-27 16:44:47,653 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 22:44:00, time: 0.146, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0043, acc: 99.8809, loss_bbox: 0.0060, loss_mask: 0.0087, loss: 0.0208
2022-03-27 16:44:56,051 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 22:19:06, time: 0.168, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0025, acc: 99.9336, loss_bbox: 0.0058, loss_mask: 0.0090, loss: 0.0191
2022-03-27 16:45:03,221 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 21:47:27, time: 0.143, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0026, acc: 99.9199, loss_bbox: 0.0057, loss_mask: 0.0085, loss: 0.0186
2022-03-27 16:45:10,406 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 21:17:36, time: 0.144, data_time: 0.001, memory: 3605, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0042, acc: 99.8789, loss_bbox: 0.0059, loss_mask: 0.0092, loss: 0.0210
2022-03-27 16:45:18,632 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 20:55:58, time: 0.164, data_time: 0.001, memory: 3605, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0033, acc: 99.8809, loss_bbox: 0.0056, loss_mask: 0.0093, loss: 0.0200
2022-03-27 16:45:25,981 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 20:30:04, time: 0.147, data_time: 0.001, memory: 3605, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0015, acc: 99.9473, loss_bbox: 0.0048, loss_mask: 0.0079, loss: 0.0161
2022-03-27 16:45:33,071 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 20:03:57, time: 0.142, data_time: 0.001, memory: 3605, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0021, acc: 99.9258, loss_bbox: 0.0051, loss_mask: 0.0081, loss: 0.0169
2022-03-27 16:45:41,271 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 19:45:36, time: 0.164, data_time: 0.001, memory: 3605, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0009, acc: 99.9785, loss_bbox: 0.0046, loss_mask: 0.0074, loss: 0.0149
2022-03-27 16:45:48,547 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 19:22:52, time: 0.146, data_time: 0.001, memory: 3607, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0012, loss_cls: 0.0009, acc: 99.9863, loss_bbox: 0.0047, loss_mask: 0.0070, loss: 0.0142
2022-03-27 16:45:56,904 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 19:07:15, time: 0.167, data_time: 0.001, memory: 3607, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0012, loss_cls: 0.0011, acc: 99.9609, loss_bbox: 0.0043, loss_mask: 0.0075, loss: 0.0143
2022-03-27 16:46:04,113 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 18:46:07, time: 0.144, data_time: 0.001, memory: 3607, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0013, loss_cls: 0.0013, acc: 99.9551, loss_bbox: 0.0041, loss_mask: 0.0063, loss: 0.0132
2022-03-27 16:46:11,232 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 18:25:26, time: 0.142, data_time: 0.001, memory: 3607, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0013, acc: 99.9551, loss_bbox: 0.0042, loss_mask: 0.0078, loss: 0.0149
2022-03-27 16:46:14,131 - mmdet - INFO - __benchmark_total_time(h):0.13402296510007647
2022-03-27 16:46:14,131 - mmdet - INFO - __benchmark_pure_training_time(h):0.133919594751464
2022-03-27 16:46:14,134 - mmdet - INFO - __benchmark_avg_iter_time(s):0.15142145142569527
2022-03-27 16:46:14,135 - mmdet - INFO - __benchmark_mem_alloc(mb):3557
2022-03-27 16:46:14,135 - mmdet - INFO - __benchmark_mem_cached(mb):5392
[SH-IDC1-10-142-5-213][[34158,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 16:46:31,257 [32mINFO[0m: log service ip address is: 10.142.5.213:18975[0m
2022-03-27 16:46:31,257 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 16:47:20,075 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 16:47:20,077 - mmdet - INFO - Distributed training: False
2022-03-27 16:47:20,976 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 16:47:21,075 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:47:21,075 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:47:21,433 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=11.18s)
creating index...
index created!
loading annotations into memory...
Done (t=0.39s)
creating index...
index created!
2022-03-27 16:47:35,678 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 16:47:35,680 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 16:47:35,680 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 16:47:35,680 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 16:50:14,520 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 25 days, 20:40:04, time: 3.176, data_time: 0.089, memory: 3467, loss_rpn_cls: 0.3821, loss_rpn_bbox: 0.0153, loss_cls: 1.5179, acc: 85.2930, loss_bbox: 0.0890, loss_mask: 0.6127, loss: 2.6170
2022-03-27 16:50:21,662 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 12:16:54, time: 0.143, data_time: 0.001, memory: 3467, loss_rpn_cls: 0.0314, loss_rpn_bbox: 0.0049, loss_cls: 0.4367, acc: 98.0879, loss_bbox: 0.0935, loss_mask: 0.1938, loss: 0.7604
2022-03-27 16:50:30,121 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 11:10:43, time: 0.169, data_time: 0.001, memory: 3482, loss_rpn_cls: 0.0081, loss_rpn_bbox: 0.0043, loss_cls: 0.2933, acc: 99.4395, loss_bbox: 0.0405, loss_mask: 0.0959, loss: 0.4421
2022-03-27 16:50:37,460 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 9:32:46, time: 0.147, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0025, loss_rpn_bbox: 0.0058, loss_cls: 0.2574, acc: 99.6465, loss_bbox: 0.0303, loss_mask: 0.0497, loss: 0.3458
2022-03-27 16:50:45,663 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 4:21:22, time: 0.162, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0060, loss_cls: 0.1800, acc: 99.8008, loss_bbox: 0.0244, loss_mask: 0.0367, loss: 0.2489
2022-03-27 16:50:53,223 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 8:36:52, time: 0.153, data_time: 0.003, memory: 3486, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0046, loss_cls: 0.0541, acc: 99.7422, loss_bbox: 0.0254, loss_mask: 0.0383, loss: 0.1242
2022-03-27 16:51:00,681 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 18:23:42, time: 0.149, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0040, loss_cls: 0.0154, acc: 99.7129, loss_bbox: 0.0191, loss_mask: 0.0314, loss: 0.0715
2022-03-27 16:51:08,634 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 7:58:06, time: 0.159, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0041, loss_cls: 0.0100, acc: 99.7598, loss_bbox: 0.0182, loss_mask: 0.0242, loss: 0.0575
2022-03-27 16:51:16,416 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 3 days, 23:47:25, time: 0.156, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0037, loss_cls: 0.0091, acc: 99.7891, loss_bbox: 0.0139, loss_mask: 0.0217, loss: 0.0499
2022-03-27 16:51:23,829 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 17:06:01, time: 0.148, data_time: 0.001, memory: 3486, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0036, loss_cls: 0.0061, acc: 99.8672, loss_bbox: 0.0139, loss_mask: 0.0225, loss: 0.0473
2022-03-27 16:51:31,908 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 11:51:38, time: 0.161, data_time: 0.001, memory: 3488, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0034, loss_cls: 0.0069, acc: 99.8105, loss_bbox: 0.0131, loss_mask: 0.0197, loss: 0.0442
2022-03-27 16:51:39,644 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 7:23:11, time: 0.155, data_time: 0.001, memory: 3488, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0030, loss_cls: 0.0048, acc: 99.8984, loss_bbox: 0.0098, loss_mask: 0.0153, loss: 0.0337
2022-03-27 16:51:47,683 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 3:41:15, time: 0.161, data_time: 0.001, memory: 3488, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0029, loss_cls: 0.0035, acc: 99.9160, loss_bbox: 0.0092, loss_mask: 0.0143, loss: 0.0309
2022-03-27 16:51:55,018 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 0:19:07, time: 0.146, data_time: 0.001, memory: 3488, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0030, loss_cls: 0.0051, acc: 99.8789, loss_bbox: 0.0097, loss_mask: 0.0154, loss: 0.0340
2022-03-27 16:52:02,206 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 21:22:07, time: 0.144, data_time: 0.001, memory: 3495, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0025, loss_cls: 0.0046, acc: 99.8848, loss_bbox: 0.0074, loss_mask: 0.0106, loss: 0.0258
2022-03-27 16:52:10,187 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 18:58:27, time: 0.159, data_time: 0.001, memory: 3495, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0025, loss_cls: 0.0041, acc: 99.9004, loss_bbox: 0.0081, loss_mask: 0.0121, loss: 0.0273
2022-03-27 16:52:17,981 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 16:49:19, time: 0.156, data_time: 0.001, memory: 3495, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0023, loss_cls: 0.0032, acc: 99.9336, loss_bbox: 0.0063, loss_mask: 0.0114, loss: 0.0237
2022-03-27 16:52:26,004 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 14:57:19, time: 0.160, data_time: 0.001, memory: 3495, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0022, loss_cls: 0.0036, acc: 99.9102, loss_bbox: 0.0048, loss_mask: 0.0103, loss: 0.0216
2022-03-27 16:52:33,211 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 13:07:07, time: 0.144, data_time: 0.001, memory: 3503, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0047, acc: 99.8672, loss_bbox: 0.0058, loss_mask: 0.0118, loss: 0.0249
2022-03-27 16:52:40,597 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 11:30:01, time: 0.148, data_time: 0.001, memory: 3503, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0030, acc: 99.9297, loss_bbox: 0.0046, loss_mask: 0.0079, loss: 0.0179
2022-03-27 16:52:48,734 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 10:10:25, time: 0.163, data_time: 0.001, memory: 3503, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0024, acc: 99.9355, loss_bbox: 0.0056, loss_mask: 0.0113, loss: 0.0220
2022-03-27 16:52:56,018 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 8:49:09, time: 0.146, data_time: 0.001, memory: 3503, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0019, loss_cls: 0.0029, acc: 99.9238, loss_bbox: 0.0045, loss_mask: 0.0086, loss: 0.0186
2022-03-27 16:53:03,275 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 7:34:33, time: 0.145, data_time: 0.001, memory: 3503, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0031, acc: 99.9160, loss_bbox: 0.0054, loss_mask: 0.0122, loss: 0.0230
2022-03-27 16:53:11,191 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 6:32:33, time: 0.158, data_time: 0.001, memory: 3532, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0037, acc: 99.9004, loss_bbox: 0.0046, loss_mask: 0.0090, loss: 0.0198
2022-03-27 16:53:18,556 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 5:30:26, time: 0.147, data_time: 0.001, memory: 3542, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0053, acc: 99.8262, loss_bbox: 0.0063, loss_mask: 0.0131, loss: 0.0271
2022-03-27 16:53:26,508 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 4:38:19, time: 0.159, data_time: 0.001, memory: 3542, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0017, acc: 99.9668, loss_bbox: 0.0040, loss_mask: 0.0079, loss: 0.0161
2022-03-27 16:53:33,802 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 3:44:24, time: 0.146, data_time: 0.001, memory: 3542, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0017, loss_cls: 0.0007, acc: 99.9844, loss_bbox: 0.0034, loss_mask: 0.0055, loss: 0.0118
2022-03-27 16:53:41,058 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 2:53:57, time: 0.145, data_time: 0.001, memory: 3542, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0007, acc: 99.9902, loss_bbox: 0.0028, loss_mask: 0.0062, loss: 0.0119
2022-03-27 16:53:48,907 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 2:11:45, time: 0.157, data_time: 0.001, memory: 3547, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0016, loss_cls: 0.0021, acc: 99.9336, loss_bbox: 0.0040, loss_mask: 0.0079, loss: 0.0161
2022-03-27 16:53:56,404 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 1:29:40, time: 0.150, data_time: 0.001, memory: 3547, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0031, acc: 99.9258, loss_bbox: 0.0041, loss_mask: 0.0088, loss: 0.0178
2022-03-27 16:54:03,708 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 0:48:48, time: 0.146, data_time: 0.001, memory: 3547, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0014, acc: 99.9707, loss_bbox: 0.0035, loss_mask: 0.0085, loss: 0.0153
2022-03-27 16:54:11,744 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 0:15:48, time: 0.161, data_time: 0.001, memory: 3547, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0003, acc: 100.0000, loss_bbox: 0.0034, loss_mask: 0.0072, loss: 0.0130
2022-03-27 16:54:19,143 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 23:40:18, time: 0.148, data_time: 0.001, memory: 3547, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0015, loss_cls: 0.0025, acc: 99.9336, loss_bbox: 0.0044, loss_mask: 0.0096, loss: 0.0186
2022-03-27 16:54:27,149 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 23:11:05, time: 0.160, data_time: 0.001, memory: 3547, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0015, loss_cls: 0.0023, acc: 99.9375, loss_bbox: 0.0034, loss_mask: 0.0071, loss: 0.0148
2022-03-27 16:54:34,136 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 22:36:43, time: 0.140, data_time: 0.001, memory: 3562, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0015, acc: 99.9512, loss_bbox: 0.0028, loss_mask: 0.0059, loss: 0.0121
2022-03-27 16:54:41,208 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 22:04:47, time: 0.141, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0025, acc: 99.9414, loss_bbox: 0.0034, loss_mask: 0.0067, loss: 0.0147
2022-03-27 16:54:49,318 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 21:41:07, time: 0.162, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0006, acc: 99.9902, loss_bbox: 0.0030, loss_mask: 0.0063, loss: 0.0116
2022-03-27 16:54:56,334 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 21:12:00, time: 0.140, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0002, acc: 100.0000, loss_bbox: 0.0026, loss_mask: 0.0062, loss: 0.0109
2022-03-27 16:55:03,656 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 20:46:10, time: 0.146, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0015, acc: 99.9609, loss_bbox: 0.0025, loss_mask: 0.0076, loss: 0.0134
2022-03-27 16:55:11,557 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 20:25:01, time: 0.158, data_time: 0.001, memory: 3582, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0018, acc: 99.9238, loss_bbox: 0.0031, loss_mask: 0.0062, loss: 0.0129
2022-03-27 16:55:19,065 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 20:02:41, time: 0.150, data_time: 0.001, memory: 3582, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0015, acc: 99.9668, loss_bbox: 0.0030, loss_mask: 0.0063, loss: 0.0126
2022-03-27 16:55:26,986 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 19:43:38, time: 0.158, data_time: 0.001, memory: 3582, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0007, acc: 99.9844, loss_bbox: 0.0030, loss_mask: 0.0070, loss: 0.0125
2022-03-27 16:55:33,937 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 19:20:15, time: 0.139, data_time: 0.001, memory: 3582, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0008, acc: 99.9746, loss_bbox: 0.0026, loss_mask: 0.0057, loss: 0.0107
2022-03-27 16:55:41,194 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 18:59:32, time: 0.145, data_time: 0.001, memory: 3582, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0014, acc: 99.9707, loss_bbox: 0.0025, loss_mask: 0.0060, loss: 0.0116
2022-03-27 16:55:44,157 - mmdet - INFO - __benchmark_total_time(h):0.1358034665054745
2022-03-27 16:55:44,158 - mmdet - INFO - __benchmark_pure_training_time(h):0.13568786263465882
2022-03-27 16:55:44,159 - mmdet - INFO - __benchmark_avg_iter_time(s):0.1500420975280213
2022-03-27 16:55:44,159 - mmdet - INFO - __benchmark_mem_alloc(mb):3532
2022-03-27 16:55:44,159 - mmdet - INFO - __benchmark_mem_cached(mb):5360
/mnt/lustre/jianglijuan/view-res
