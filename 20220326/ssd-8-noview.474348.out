[SH-IDC1-10-142-5-213][[17327,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 21:45:46,059 [32mINFO[0m: log service ip address is: 10.142.5.213:52458[0m
2022-03-27 21:45:46,060 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 21:46:33,048 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 21:46:33,050 - mmdet - INFO - Distributed training: False
2022-03-27 21:46:34,303 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 21:46:34,354 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:46:34,354 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:46:34,659 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=11.84s)
creating index...
index created!
loading annotations into memory...
Done (t=0.37s)
creating index...
index created!
2022-03-27 21:46:50,465 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 21:46:50,466 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 21:46:50,467 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 21:46:50,467 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 21:48:41,392 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 45 days, 3:32:19, time: 2.218, data_time: 0.095, memory: 1826, loss_cls: 19.2749, loss_bbox: 2.9091, loss: 22.1841
2022-03-27 21:48:46,354 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 23 days, 14:00:51, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 7.7027, loss_bbox: 0.6323, loss: 8.3350
2022-03-27 21:48:51,336 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 9:33:29, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.3596, loss_bbox: 0.1251, loss: 0.4847
2022-03-27 21:48:57,147 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 21:20:36, time: 0.116, data_time: 0.001, memory: 1826, loss_cls: 0.0976, loss_bbox: 0.0354, loss: 0.1331
2022-03-27 21:49:01,841 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 16:38:49, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0552, loss_bbox: 0.0428, loss: 0.0980
2022-03-27 21:49:06,808 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 5:57:30, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0378, loss_bbox: 0.0259, loss: 0.0637
2022-03-27 21:49:12,093 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 5:37:12, time: 0.106, data_time: 0.001, memory: 1826, loss_cls: 0.0265, loss_bbox: 0.0376, loss: 0.0642
2022-03-27 21:49:17,838 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 11:55:09, time: 0.115, data_time: 0.001, memory: 1826, loss_cls: 0.0220, loss_bbox: 0.0157, loss: 0.0377
2022-03-27 21:49:22,966 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 21:29:54, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0154, loss_bbox: 0.0200, loss: 0.0354
2022-03-27 21:49:27,997 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 9:51:29, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0127, loss_bbox: 0.0156, loss: 0.0283
2022-03-27 21:49:33,045 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 6 days, 0:20:58, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0097, loss_bbox: 0.0119, loss: 0.0216
2022-03-27 21:49:38,696 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 16:54:35, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0084, loss_bbox: 0.0087, loss: 0.0170
2022-03-27 21:49:43,512 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 10:00:08, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0058, loss_bbox: 0.0061, loss: 0.0119
2022-03-27 21:49:48,667 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 4:18:27, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0057, loss_bbox: 0.0052, loss: 0.0109
2022-03-27 21:49:54,815 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 5 days, 0:01:04, time: 0.123, data_time: 0.001, memory: 1826, loss_cls: 0.0047, loss_bbox: 0.0037, loss: 0.0084
2022-03-27 21:49:59,853 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 19:35:30, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0041, loss_bbox: 0.0025, loss: 0.0066
2022-03-27 21:50:04,940 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 15:42:41, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0040, loss_bbox: 0.0039, loss: 0.0079
2022-03-27 21:50:09,764 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 12:07:12, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0036, loss_bbox: 0.0013, loss: 0.0049
2022-03-27 21:50:15,425 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 9:19:57, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0033, loss_bbox: 0.0030, loss: 0.0063
2022-03-27 21:50:20,346 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 6:28:11, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0023, loss: 0.0052
2022-03-27 21:50:25,451 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 3:57:40, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0013, loss: 0.0040
2022-03-27 21:50:30,478 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 4 days, 1:38:47, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0025, loss_bbox: 0.0006, loss: 0.0031
2022-03-27 21:50:36,158 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 23:48:21, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0009, loss: 0.0033
2022-03-27 21:50:41,292 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 21:54:15, time: 0.103, data_time: 0.002, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0022, loss: 0.0046
2022-03-27 21:50:46,661 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 20:14:34, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0011, loss: 0.0032
2022-03-27 21:50:51,616 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 18:33:10, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0023, loss: 0.0043
2022-03-27 21:50:57,480 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 17:18:55, time: 0.117, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0003, loss: 0.0022
2022-03-27 21:51:02,558 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 15:53:46, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0009, loss: 0.0027
2022-03-27 21:51:07,608 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 14:33:46, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0007, loss: 0.0024
2022-03-27 21:51:12,435 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 13:14:47, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0011, loss: 0.0028
2022-03-27 21:51:17,861 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 12:12:01, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0005, loss: 0.0021
2022-03-27 21:51:22,719 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 11:03:03, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0010, loss: 0.0026
2022-03-27 21:51:27,909 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 10:04:06, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0004, loss: 0.0019
2022-03-27 21:51:32,816 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 9:03:45, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0012, loss: 0.0027
2022-03-27 21:51:38,518 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 8:19:52, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0009, loss: 0.0024
2022-03-27 21:51:43,700 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 7:30:18, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0004, loss: 0.0019
2022-03-27 21:51:48,707 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 6:40:26, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0005, loss: 0.0018
2022-03-27 21:51:54,159 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 6:00:04, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0006, loss: 0.0019
2022-03-27 21:51:59,161 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 5:15:06, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0007, loss: 0.0020
2022-03-27 21:52:04,210 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 4:33:01, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0005, loss: 0.0017
2022-03-27 21:52:08,956 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 3:48:40, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0006, loss: 0.0019
2022-03-27 21:52:14,917 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 3 days, 3:23:14, time: 0.119, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0005, loss: 0.0016
2022-03-27 21:52:19,819 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 3 days, 2:44:49, time: 0.098, data_time: 0.002, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0005, loss: 0.0017
2022-03-27 21:52:24,955 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 3 days, 2:10:59, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0006, loss: 0.0017
2022-03-27 21:52:27,103 - mmdet - INFO - __benchmark_total_time(h):0.09361998604403601
2022-03-27 21:52:27,103 - mmdet - INFO - __benchmark_pure_training_time(h):0.09350966546270582
2022-03-27 21:52:27,104 - mmdet - INFO - __benchmark_avg_iter_time(s):0.10373668856435007
2022-03-27 21:52:27,104 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 21:52:27,104 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[23703,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 21:52:43,343 [32mINFO[0m: log service ip address is: 10.142.5.213:41270[0m
2022-03-27 21:52:43,344 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 21:53:28,143 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 21:53:28,145 - mmdet - INFO - Distributed training: False
2022-03-27 21:53:29,414 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 21:53:29,501 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:53:29,503 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:53:29,769 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.50s)
creating index...
index created!
loading annotations into memory...
Done (t=0.39s)
creating index...
index created!
2022-03-27 21:53:43,924 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 21:53:43,925 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 21:53:43,926 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 21:53:43,926 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 21:55:34,018 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 44 days, 19:20:23, time: 2.201, data_time: 0.094, memory: 1826, loss_cls: 19.6172, loss_bbox: 2.8891, loss: 22.5064
2022-03-27 21:55:38,543 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 23 days, 7:46:39, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 9.1490, loss_bbox: 0.7683, loss: 9.9174
2022-03-27 21:55:43,146 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 4:09:53, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.5010, loss_bbox: 0.2111, loss: 0.7122
2022-03-27 21:55:48,944 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 17:16:43, time: 0.116, data_time: 0.001, memory: 1826, loss_cls: 0.1121, loss_bbox: 0.0693, loss: 0.1814
2022-03-27 21:55:53,878 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 13:51:27, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0656, loss_bbox: 0.0516, loss: 0.1172
2022-03-27 21:55:58,734 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 3:27:13, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0348, loss_bbox: 0.0267, loss: 0.0615
2022-03-27 21:56:03,596 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 2:52:55, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0284, loss_bbox: 0.0439, loss: 0.0723
2022-03-27 21:56:09,330 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 9:30:18, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.0216, loss_bbox: 0.0241, loss: 0.0457
2022-03-27 21:56:14,344 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 19:13:47, time: 0.100, data_time: 0.002, memory: 1826, loss_cls: 0.0204, loss_bbox: 0.0427, loss: 0.0631
2022-03-27 21:56:19,051 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 7:30:12, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0132, loss_bbox: 0.0137, loss: 0.0269
2022-03-27 21:56:24,583 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 22:14:34, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0095, loss_bbox: 0.0152, loss: 0.0247
2022-03-27 21:56:29,636 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 14:51:43, time: 0.110, data_time: 0.011, memory: 1826, loss_cls: 0.0080, loss_bbox: 0.0112, loss: 0.0192
2022-03-27 21:56:34,603 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 8:13:02, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0072, loss_bbox: 0.0111, loss: 0.0183
2022-03-27 21:56:39,169 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 2:14:24, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0056, loss_bbox: 0.0065, loss: 0.0121
2022-03-27 21:56:43,586 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 20:57:45, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0050, loss_bbox: 0.0056, loss: 0.0106
2022-03-27 21:56:49,059 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 16:59:17, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0049, loss_bbox: 0.0089, loss: 0.0138
2022-03-27 21:56:53,947 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 13:09:01, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0046, loss_bbox: 0.0063, loss: 0.0109
2022-03-27 21:56:58,769 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 9:41:58, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0037, loss_bbox: 0.0011, loss: 0.0047
2022-03-27 21:57:03,419 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 6:31:27, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0033, loss_bbox: 0.0049, loss: 0.0082
2022-03-27 21:57:09,172 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 4:12:09, time: 0.115, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0023, loss: 0.0051
2022-03-27 21:57:14,227 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 1:46:53, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0025, loss_bbox: 0.0027, loss: 0.0052
2022-03-27 21:57:18,838 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 23:22:49, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0009, loss: 0.0033
2022-03-27 21:57:23,388 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 21:09:44, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0018, loss: 0.0039
2022-03-27 21:57:29,085 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 19:35:36, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0012, loss: 0.0033
2022-03-27 21:57:33,716 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 17:44:19, time: 0.093, data_time: 0.002, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0017, loss: 0.0036
2022-03-27 21:57:38,613 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 16:07:30, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0023, loss: 0.0042
2022-03-27 21:57:43,249 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 14:32:03, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0011, loss: 0.0029
2022-03-27 21:57:48,967 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 13:25:59, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0006, loss: 0.0023
2022-03-27 21:57:53,659 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 12:03:59, time: 0.094, data_time: 0.002, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0012, loss: 0.0029
2022-03-27 21:57:58,274 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 10:45:50, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0017, loss: 0.0033
2022-03-27 21:58:03,151 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 9:37:42, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0016, loss: 0.0031
2022-03-27 21:58:08,681 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 8:45:39, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0011, loss: 0.0026
2022-03-27 21:58:13,487 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 7:44:07, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0005, loss: 0.0019
2022-03-27 21:58:18,487 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 6:49:20, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0014, loss: 0.0028
2022-03-27 21:58:22,900 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 5:48:00, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0013, loss: 0.0026
2022-03-27 21:58:28,682 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 5:12:09, time: 0.115, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0012, loss: 0.0026
2022-03-27 21:58:33,441 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 4:22:14, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0009, loss: 0.0021
2022-03-27 21:58:38,388 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 3:37:47, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0010, loss: 0.0022
2022-03-27 21:58:43,157 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 2:52:55, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0013, loss: 0.0025
2022-03-27 21:58:49,078 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 2:27:07, time: 0.118, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0012, loss: 0.0023
2022-03-27 21:58:53,995 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 1:48:18, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0012, loss: 0.0024
2022-03-27 21:58:58,839 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 3 days, 1:10:18, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0005, loss: 0.0016
2022-03-27 21:59:03,591 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 3 days, 0:32:46, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0009, loss: 0.0019
2022-03-27 21:59:08,965 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 3 days, 0:05:09, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0010, loss_bbox: 0.0006, loss: 0.0017
2022-03-27 21:59:11,073 - mmdet - INFO - __benchmark_total_time(h):0.09098866701126099
2022-03-27 21:59:11,073 - mmdet - INFO - __benchmark_pure_training_time(h):0.09087401840421888
2022-03-27 21:59:11,074 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09994707502923407
2022-03-27 21:59:11,075 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 21:59:11,075 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[29227,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 21:59:29,973 [32mINFO[0m: log service ip address is: 10.142.5.213:55545[0m
2022-03-27 21:59:29,973 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 22:00:17,727 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 22:00:17,728 - mmdet - INFO - Distributed training: False
2022-03-27 22:00:19,082 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 22:00:19,347 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:00:19,348 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:00:19,542 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=12.23s)
creating index...
index created!
loading annotations into memory...
Done (t=0.37s)
creating index...
index created!
2022-03-27 22:00:35,605 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 22:00:35,606 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 22:00:35,607 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 22:00:35,607 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 22:02:37,676 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 49 days, 16:24:55, time: 2.440, data_time: 0.097, memory: 1826, loss_cls: 19.3546, loss_bbox: 3.2168, loss: 22.5714
2022-03-27 22:02:42,541 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 25 days, 19:58:59, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 7.8448, loss_bbox: 0.8937, loss: 8.7385
2022-03-27 22:02:48,561 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 18 days, 0:54:00, time: 0.120, data_time: 0.001, memory: 1826, loss_cls: 0.5609, loss_bbox: 0.1015, loss: 0.6624
2022-03-27 22:02:53,424 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 14 days, 0:33:13, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.1650, loss_bbox: 0.0659, loss: 0.2310
2022-03-27 22:02:58,188 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 11 days, 14:32:17, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0742, loss_bbox: 0.0373, loss: 0.1115
2022-03-27 22:03:02,938 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 23:50:52, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0444, loss_bbox: 0.0241, loss: 0.0685
2022-03-27 22:03:08,575 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 21:26:26, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0310, loss_bbox: 0.0225, loss: 0.0535
2022-03-27 22:03:12,932 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 8 days, 0:04:44, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0308, loss_bbox: 0.0479, loss: 0.0787
2022-03-27 22:03:17,299 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 7 days, 7:28:11, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0197, loss_bbox: 0.0182, loss: 0.0379
2022-03-27 22:03:22,133 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 18:38:40, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0150, loss_bbox: 0.0178, loss: 0.0328
2022-03-27 22:03:27,941 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 6 days, 9:00:45, time: 0.116, data_time: 0.001, memory: 1826, loss_cls: 0.0132, loss_bbox: 0.0170, loss: 0.0303
2022-03-27 22:03:32,798 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 6 days, 0:12:39, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0096, loss_bbox: 0.0088, loss: 0.0184
2022-03-27 22:03:38,007 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 17:01:22, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0081, loss_bbox: 0.0077, loss: 0.0158
2022-03-27 22:03:43,046 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 10:45:14, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0076, loss_bbox: 0.0102, loss: 0.0179
2022-03-27 22:03:48,916 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 5 days, 5:51:18, time: 0.117, data_time: 0.001, memory: 1826, loss_cls: 0.0058, loss_bbox: 0.0040, loss: 0.0097
2022-03-27 22:03:53,866 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 5 days, 1:00:24, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0052, loss_bbox: 0.0047, loss: 0.0099
2022-03-27 22:03:58,856 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 20:45:01, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0048, loss_bbox: 0.0031, loss: 0.0078
2022-03-27 22:04:03,797 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 16:56:40, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0041, loss_bbox: 0.0022, loss: 0.0063
2022-03-27 22:04:09,483 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 13:55:13, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.0037, loss_bbox: 0.0021, loss: 0.0058
2022-03-27 22:04:14,200 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 10:43:26, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0034, loss_bbox: 0.0030, loss: 0.0063
2022-03-27 22:04:19,286 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 8:00:06, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0033, loss_bbox: 0.0013, loss: 0.0046
2022-03-27 22:04:24,356 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 4 days, 5:31:27, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0030, loss_bbox: 0.0019, loss: 0.0049
2022-03-27 22:04:30,188 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 4 days, 3:35:03, time: 0.117, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0026, loss: 0.0055
2022-03-27 22:04:35,347 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 4 days, 1:31:43, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0017, loss: 0.0044
2022-03-27 22:04:40,323 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 23:34:14, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0013, loss: 0.0038
2022-03-27 22:04:45,662 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 21:53:51, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0012, loss: 0.0035
2022-03-27 22:04:50,895 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 20:18:35, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0010, loss: 0.0032
2022-03-27 22:04:55,222 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 18:31:04, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0004, loss: 0.0026
2022-03-27 22:05:00,022 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 17:00:43, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0015, loss: 0.0036
2022-03-27 22:05:05,775 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 15:54:49, time: 0.115, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0010, loss: 0.0029
2022-03-27 22:05:10,682 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 14:37:17, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0007, loss: 0.0026
2022-03-27 22:05:15,864 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 13:29:32, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0011, loss: 0.0029
2022-03-27 22:05:20,645 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 12:18:52, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0007, loss: 0.0025
2022-03-27 22:05:26,371 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 11:28:32, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0008, loss: 0.0025
2022-03-27 22:05:31,254 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 10:27:05, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0007, loss: 0.0024
2022-03-27 22:05:36,416 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 9:33:25, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0009, loss: 0.0025
2022-03-27 22:05:41,145 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 8:36:00, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0007, loss: 0.0023
2022-03-27 22:05:46,807 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 7:55:46, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0008, loss: 0.0023
2022-03-27 22:05:51,719 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 7:06:27, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0007, loss: 0.0022
2022-03-27 22:05:56,726 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 6:20:58, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0007, loss: 0.0021
2022-03-27 22:06:01,467 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 5:33:55, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0007, loss: 0.0021
2022-03-27 22:06:06,992 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 3 days, 4:59:58, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0008, loss: 0.0022
2022-03-27 22:06:11,601 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 3 days, 4:15:14, time: 0.092, data_time: 0.002, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0007, loss: 0.0021
2022-03-27 22:06:16,587 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 3 days, 3:37:24, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0008, loss: 0.0021
2022-03-27 22:06:18,614 - mmdet - INFO - __benchmark_total_time(h):0.09538964337772793
2022-03-27 22:06:18,614 - mmdet - INFO - __benchmark_pure_training_time(h):0.09527962863445281
2022-03-27 22:06:18,615 - mmdet - INFO - __benchmark_avg_iter_time(s):0.10126731612465599
2022-03-27 22:06:18,615 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 22:06:18,615 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[5552,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 22:06:36,938 [32mINFO[0m: log service ip address is: 10.142.5.213:39197[0m
2022-03-27 22:06:36,939 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 22:07:20,990 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 22:07:20,992 - mmdet - INFO - Distributed training: False
2022-03-27 22:07:22,298 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 22:07:22,352 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:07:22,353 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:07:22,548 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.38s)
creating index...
index created!
loading annotations into memory...
Done (t=0.39s)
creating index...
index created!
2022-03-27 22:07:36,663 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 22:07:36,665 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 22:07:36,665 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 22:07:36,665 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 22:09:24,504 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 43 days, 21:18:17, time: 2.156, data_time: 0.094, memory: 1826, loss_cls: 19.7339, loss_bbox: 2.7592, loss: 22.4931
2022-03-27 22:09:29,491 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 22 days, 23:02:53, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 6.7521, loss_bbox: 0.9971, loss: 7.7492
2022-03-27 22:09:34,440 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 15 days, 23:28:05, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.7014, loss_bbox: 0.2430, loss: 0.9443
2022-03-27 22:09:40,538 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 14:28:21, time: 0.122, data_time: 0.001, memory: 1826, loss_cls: 0.1702, loss_bbox: 0.1138, loss: 0.2840
2022-03-27 22:09:45,910 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 12:28:57, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0814, loss_bbox: 0.0666, loss: 0.1480
2022-03-27 22:09:50,803 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 2:21:41, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0507, loss_bbox: 0.0513, loss: 0.1020
2022-03-27 22:09:56,791 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 3:30:48, time: 0.120, data_time: 0.001, memory: 1826, loss_cls: 0.0410, loss_bbox: 0.0623, loss: 0.1032
2022-03-27 22:10:02,056 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 9:30:13, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0308, loss_bbox: 0.0490, loss: 0.0798
2022-03-27 22:10:07,293 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 19:27:43, time: 0.105, data_time: 0.003, memory: 1826, loss_cls: 0.0222, loss_bbox: 0.0288, loss: 0.0511
2022-03-27 22:10:12,319 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 8:01:17, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0195, loss_bbox: 0.0389, loss: 0.0583
2022-03-27 22:10:18,543 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 23:43:16, time: 0.124, data_time: 0.001, memory: 1826, loss_cls: 0.0139, loss_bbox: 0.0234, loss: 0.0373
2022-03-27 22:10:23,352 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 15:39:30, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0111, loss_bbox: 0.0152, loss: 0.0263
2022-03-27 22:10:28,031 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 8:44:07, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0088, loss_bbox: 0.0110, loss: 0.0198
2022-03-27 22:10:32,631 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 2:44:44, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0083, loss_bbox: 0.0135, loss: 0.0218
2022-03-27 22:10:38,427 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 22:19:43, time: 0.116, data_time: 0.001, memory: 1826, loss_cls: 0.0067, loss_bbox: 0.0096, loss: 0.0163
2022-03-27 22:10:43,310 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 17:54:59, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0057, loss_bbox: 0.0078, loss: 0.0135
2022-03-27 22:10:48,040 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 13:55:26, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0051, loss_bbox: 0.0066, loss: 0.0117
2022-03-27 22:10:52,727 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 10:21:41, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0044, loss_bbox: 0.0054, loss: 0.0098
2022-03-27 22:10:58,419 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 7:41:05, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.0039, loss_bbox: 0.0037, loss: 0.0077
2022-03-27 22:11:03,622 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 5:02:24, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0035, loss_bbox: 0.0040, loss: 0.0075
2022-03-27 22:11:08,353 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 2:25:35, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0035, loss_bbox: 0.0016, loss: 0.0051
2022-03-27 22:11:13,789 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 4 days, 0:21:44, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0030, loss_bbox: 0.0032, loss: 0.0062
2022-03-27 22:11:19,440 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 22:33:56, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0027, loss: 0.0056
2022-03-27 22:11:23,999 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 20:28:53, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0024, loss: 0.0050
2022-03-27 22:11:28,714 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 18:37:16, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0025, loss_bbox: 0.0024, loss: 0.0049
2022-03-27 22:11:33,140 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 16:47:43, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0020, loss: 0.0044
2022-03-27 22:11:38,423 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 15:24:46, time: 0.106, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0023, loss: 0.0045
2022-03-27 22:11:42,995 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 13:53:09, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0026, loss: 0.0047
2022-03-27 22:11:47,447 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 12:25:11, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0014, loss: 0.0035
2022-03-27 22:11:52,073 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 11:06:37, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0020, loss: 0.0040
2022-03-27 22:11:57,740 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 10:12:31, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0017, loss: 0.0036
2022-03-27 22:12:02,075 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 8:57:42, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0011, loss: 0.0030
2022-03-27 22:12:06,994 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 7:57:44, time: 0.098, data_time: 0.002, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0024, loss: 0.0042
2022-03-27 22:12:11,630 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 6:56:12, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0023, loss: 0.0041
2022-03-27 22:12:17,438 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 6:17:56, time: 0.116, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0025, loss: 0.0043
2022-03-27 22:12:22,225 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 5:25:21, time: 0.096, data_time: 0.002, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0012, loss: 0.0029
2022-03-27 22:12:26,999 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 4:35:15, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0007, loss: 0.0023
2022-03-27 22:12:31,661 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 3:46:00, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0011, loss: 0.0026
2022-03-27 22:12:37,106 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 3:11:02, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0012, loss: 0.0026
2022-03-27 22:12:41,766 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 2:26:24, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0015, loss: 0.0030
2022-03-27 22:12:46,603 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 1:46:28, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0015, loss: 0.0030
2022-03-27 22:12:51,475 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 3 days, 1:08:53, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0013, loss: 0.0026
2022-03-27 22:12:57,302 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 3 days, 0:45:58, time: 0.116, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0010, loss: 0.0023
2022-03-27 22:13:01,983 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 3 days, 0:08:57, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0014, loss: 0.0027
2022-03-27 22:13:04,016 - mmdet - INFO - __benchmark_total_time(h):0.09104509817229377
2022-03-27 22:13:04,017 - mmdet - INFO - __benchmark_pure_training_time(h):0.09093089030848608
2022-03-27 22:13:04,017 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09797958227304313
2022-03-27 22:13:04,018 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 22:13:04,018 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[10741,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 22:13:21,629 [32mINFO[0m: log service ip address is: 10.142.5.213:13642[0m
2022-03-27 22:13:21,630 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 22:14:07,960 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 22:14:07,962 - mmdet - INFO - Distributed training: False
2022-03-27 22:14:09,203 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 22:14:09,259 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:14:09,259 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:14:09,448 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.72s)
creating index...
index created!
loading annotations into memory...
Done (t=0.38s)
creating index...
index created!
2022-03-27 22:14:23,896 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 22:14:23,897 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 22:14:23,898 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 22:14:23,898 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 22:16:15,157 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 45 days, 6:42:52, time: 2.224, data_time: 0.096, memory: 1826, loss_cls: 18.9170, loss_bbox: 3.1406, loss: 22.0576
2022-03-27 22:16:19,585 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 23 days, 13:00:41, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 7.5707, loss_bbox: 0.8516, loss: 8.4223
2022-03-27 22:16:24,415 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 8:24:11, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.5172, loss_bbox: 0.1199, loss: 0.6371
2022-03-27 22:16:30,108 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 20:11:11, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.1576, loss_bbox: 0.0404, loss: 0.1980
2022-03-27 22:16:34,763 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 15:38:51, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0809, loss_bbox: 0.0339, loss: 0.1148
2022-03-27 22:16:39,674 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 5:01:49, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0506, loss_bbox: 0.0444, loss: 0.0949
2022-03-27 22:16:44,509 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 4:11:48, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0763, loss_bbox: 0.0863, loss: 0.1625
2022-03-27 22:16:50,512 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 10:59:26, time: 0.120, data_time: 0.001, memory: 1826, loss_cls: 0.0227, loss_bbox: 0.0097, loss: 0.0324
2022-03-27 22:16:55,417 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 20:25:41, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0166, loss_bbox: 0.0144, loss: 0.0310
2022-03-27 22:17:00,251 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 8:42:26, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0135, loss_bbox: 0.0126, loss: 0.0261
2022-03-27 22:17:04,790 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 22:50:50, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0115, loss_bbox: 0.0091, loss: 0.0205
2022-03-27 22:17:10,423 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 15:31:17, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0094, loss_bbox: 0.0100, loss: 0.0194
2022-03-27 22:17:15,231 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 8:42:36, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0079, loss_bbox: 0.0057, loss: 0.0135
2022-03-27 22:17:19,909 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 2:46:40, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0059, loss_bbox: 0.0034, loss: 0.0092
2022-03-27 22:17:24,599 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 21:38:34, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0050, loss_bbox: 0.0033, loss: 0.0083
2022-03-27 22:17:30,109 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 17:38:57, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0052, loss_bbox: 0.0017, loss: 0.0069
2022-03-27 22:17:34,626 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 13:33:26, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0039, loss_bbox: 0.0014, loss: 0.0053
2022-03-27 22:17:39,541 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 10:08:09, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0036, loss_bbox: 0.0007, loss: 0.0042
2022-03-27 22:17:44,088 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 6:52:58, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0034, loss_bbox: 0.0010, loss: 0.0044
2022-03-27 22:17:49,503 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 4:22:47, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0031, loss_bbox: 0.0014, loss: 0.0045
2022-03-27 22:17:54,574 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 1:57:27, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0006, loss: 0.0034
2022-03-27 22:17:59,696 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 23:46:32, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0011, loss: 0.0038
2022-03-27 22:18:04,811 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 21:46:45, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0025, loss_bbox: 0.0007, loss: 0.0033
2022-03-27 22:18:10,310 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 20:06:14, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0004, loss: 0.0028
2022-03-27 22:18:15,038 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 18:16:00, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0005, loss: 0.0028
2022-03-27 22:18:19,823 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 16:35:21, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0007, loss: 0.0028
2022-03-27 22:18:24,631 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 15:02:41, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0005, loss: 0.0026
2022-03-27 22:18:30,034 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 13:48:56, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0009, loss: 0.0029
2022-03-27 22:18:34,766 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 12:26:58, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0005, loss: 0.0024
2022-03-27 22:18:39,583 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 11:11:58, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0005, loss: 0.0024
2022-03-27 22:18:44,357 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 10:01:01, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0006, loss: 0.0023
2022-03-27 22:18:50,030 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 9:10:48, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0011, loss: 0.0029
2022-03-27 22:18:55,079 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 8:12:49, time: 0.101, data_time: 0.002, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0004, loss: 0.0021
2022-03-27 22:19:00,048 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 7:16:44, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0004, loss: 0.0020
2022-03-27 22:19:04,920 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 6:22:15, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0006, loss: 0.0022
2022-03-27 22:19:10,942 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 5:49:25, time: 0.120, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0006, loss: 0.0021
2022-03-27 22:19:15,675 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 4:58:04, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0004, loss: 0.0019
2022-03-27 22:19:20,433 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 4:09:44, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0006, loss: 0.0020
2022-03-27 22:19:25,356 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 3:26:21, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0004, loss: 0.0018
2022-03-27 22:19:31,348 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 3:00:44, time: 0.120, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0006, loss: 0.0019
2022-03-27 22:19:35,848 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 2:15:09, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0006, loss: 0.0019
2022-03-27 22:19:40,590 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 3 days, 1:35:06, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0005, loss: 0.0019
2022-03-27 22:19:45,413 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 3 days, 0:57:58, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0004, loss: 0.0017
2022-03-27 22:19:51,182 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 3 days, 0:35:02, time: 0.115, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0005, loss: 0.0018
2022-03-27 22:19:53,182 - mmdet - INFO - __benchmark_total_time(h):0.09157901141378615
2022-03-27 22:19:53,182 - mmdet - INFO - __benchmark_pure_training_time(h):0.09146768344773186
2022-03-27 22:19:53,183 - mmdet - INFO - __benchmark_avg_iter_time(s):0.10093586237637789
2022-03-27 22:19:53,183 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 22:19:53,183 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[50563,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 22:20:11,490 [32mINFO[0m: log service ip address is: 10.142.5.213:25030[0m
2022-03-27 22:20:11,491 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 22:20:55,685 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 22:20:55,687 - mmdet - INFO - Distributed training: False
2022-03-27 22:20:56,998 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 22:20:57,049 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:20:57,050 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:20:57,250 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=12.45s)
creating index...
index created!
loading annotations into memory...
Done (t=0.35s)
creating index...
index created!
2022-03-27 22:21:13,530 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 22:21:13,532 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 22:21:13,532 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 22:21:13,532 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 22:23:01,476 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 43 days, 22:17:21, time: 2.158, data_time: 0.093, memory: 1826, loss_cls: 19.1867, loss_bbox: 2.8309, loss: 22.0176
2022-03-27 22:23:06,362 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 22 days, 23:00:23, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 6.2986, loss_bbox: 1.0366, loss: 7.3353
2022-03-27 22:23:11,628 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 0:27:54, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.6403, loss_bbox: 0.2345, loss: 0.8748
2022-03-27 22:23:16,115 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 11:18:38, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.1684, loss_bbox: 0.1206, loss: 0.2890
2022-03-27 22:23:21,259 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 9:29:02, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0892, loss_bbox: 0.0597, loss: 0.1489
2022-03-27 22:23:26,156 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 8 days, 23:52:50, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0627, loss_bbox: 0.0963, loss: 0.1590
2022-03-27 22:23:31,491 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 0:28:37, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0470, loss_bbox: 0.0460, loss: 0.0931
2022-03-27 22:23:36,857 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 6:39:01, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0263, loss_bbox: 0.0443, loss: 0.0706
2022-03-27 22:23:41,837 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 16:56:00, time: 0.105, data_time: 0.006, memory: 1826, loss_cls: 0.0317, loss_bbox: 0.0505, loss: 0.0823
2022-03-27 22:23:47,124 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 5:59:24, time: 0.106, data_time: 0.001, memory: 1826, loss_cls: 0.0152, loss_bbox: 0.0169, loss: 0.0321
2022-03-27 22:23:51,732 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 20:27:01, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0147, loss_bbox: 0.0265, loss: 0.0412
2022-03-27 22:23:56,867 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 12:46:17, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0099, loss_bbox: 0.0103, loss: 0.0201
2022-03-27 22:24:01,907 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 6:28:47, time: 0.104, data_time: 0.004, memory: 1826, loss_cls: 0.0076, loss_bbox: 0.0036, loss: 0.0112
2022-03-27 22:24:07,257 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 1:10:27, time: 0.107, data_time: 0.002, memory: 1826, loss_cls: 0.0066, loss_bbox: 0.0082, loss: 0.0148
2022-03-27 22:24:11,981 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 20:10:12, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0055, loss_bbox: 0.0052, loss: 0.0108
2022-03-27 22:24:17,377 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 16:11:54, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0050, loss_bbox: 0.0067, loss: 0.0118
2022-03-27 22:24:22,114 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 12:19:10, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0044, loss_bbox: 0.0068, loss: 0.0113
2022-03-27 22:24:27,165 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 9:02:19, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0053, loss_bbox: 0.0036, loss: 0.0089
2022-03-27 22:24:31,708 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 5:50:31, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0036, loss_bbox: 0.0042, loss: 0.0078
2022-03-27 22:24:36,270 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 2:58:29, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0034, loss_bbox: 0.0029, loss: 0.0063
2022-03-27 22:24:41,428 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 0:39:27, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0033, loss_bbox: 0.0009, loss: 0.0042
2022-03-27 22:24:45,947 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 22:16:02, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0025, loss: 0.0054
2022-03-27 22:24:51,010 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 20:18:56, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0034, loss: 0.0061
2022-03-27 22:24:55,911 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 18:27:42, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0004, loss: 0.0031
2022-03-27 22:25:01,111 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 16:52:14, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0021, loss: 0.0045
2022-03-27 22:25:05,937 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 15:15:46, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0018, loss: 0.0040
2022-03-27 22:25:10,833 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 13:47:54, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0011, loss: 0.0032
2022-03-27 22:25:15,644 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 12:24:40, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0019, loss: 0.0041
2022-03-27 22:25:21,063 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 11:19:16, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0032, loss: 0.0053
2022-03-27 22:25:25,720 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 10:03:29, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0003, loss: 0.0023
2022-03-27 22:25:30,453 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 8:53:57, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0008, loss: 0.0026
2022-03-27 22:25:35,173 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 7:48:33, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0014, loss: 0.0032
2022-03-27 22:25:40,525 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 6:58:17, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0013, loss: 0.0030
2022-03-27 22:25:45,320 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 6:01:25, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0018, loss: 0.0035
2022-03-27 22:25:50,405 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 5:12:34, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0004, loss: 0.0020
2022-03-27 22:25:55,230 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 4:22:20, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0010, loss: 0.0026
2022-03-27 22:26:00,780 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 3:46:08, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0010, loss: 0.0026
2022-03-27 22:26:05,133 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 2:53:31, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0013, loss: 0.0028
2022-03-27 22:26:09,887 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 2:09:33, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0014, loss: 0.0028
2022-03-27 22:26:14,823 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 1:30:28, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0004, loss: 0.0018
2022-03-27 22:26:20,305 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 1:01:06, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0012, loss: 0.0026
2022-03-27 22:26:24,945 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 3 days, 0:21:20, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0010, loss: 0.0024
2022-03-27 22:26:30,019 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 23:49:17, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0011, loss: 0.0024
2022-03-27 22:26:34,530 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 23:11:22, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0009, loss: 0.0022
2022-03-27 22:26:36,560 - mmdet - INFO - __benchmark_total_time(h):0.089833142624961
2022-03-27 22:26:36,561 - mmdet - INFO - __benchmark_pure_training_time(h):0.08972983174853855
2022-03-27 22:26:36,561 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09863233828282618
2022-03-27 22:26:36,561 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 22:26:36,562 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[56875,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 22:26:53,817 [32mINFO[0m: log service ip address is: 10.142.5.213:12306[0m
2022-03-27 22:26:53,818 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 22:27:38,605 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 22:27:38,607 - mmdet - INFO - Distributed training: False
2022-03-27 22:27:39,884 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 22:27:39,937 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:27:39,938 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:27:40,130 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.15s)
creating index...
index created!
loading annotations into memory...
Done (t=0.38s)
creating index...
index created!
2022-03-27 22:27:54,444 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 22:27:54,448 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 22:27:54,450 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 22:27:54,450 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 22:29:44,939 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 44 days, 23:16:02, time: 2.209, data_time: 0.096, memory: 1826, loss_cls: 18.9638, loss_bbox: 2.8227, loss: 21.7865
2022-03-27 22:29:49,757 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 23 days, 11:11:18, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 6.2190, loss_bbox: 0.9015, loss: 7.1205
2022-03-27 22:29:54,990 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 8:29:12, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.4793, loss_bbox: 0.1291, loss: 0.6083
2022-03-27 22:30:00,710 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 20:17:42, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.1512, loss_bbox: 0.0538, loss: 0.2050
2022-03-27 22:30:05,668 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 16:20:35, time: 0.099, data_time: 0.002, memory: 1826, loss_cls: 0.0831, loss_bbox: 0.0698, loss: 0.1529
2022-03-27 22:30:10,594 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 5:37:29, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0463, loss_bbox: 0.0333, loss: 0.0796
2022-03-27 22:30:15,456 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 4:44:59, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0316, loss_bbox: 0.0391, loss: 0.0707
2022-03-27 22:30:21,372 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 11:22:06, time: 0.118, data_time: 0.001, memory: 1826, loss_cls: 0.0236, loss_bbox: 0.0277, loss: 0.0513
2022-03-27 22:30:25,903 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 20:21:31, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0166, loss_bbox: 0.0266, loss: 0.0432
2022-03-27 22:30:30,649 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 8:33:15, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0154, loss_bbox: 0.0159, loss: 0.0313
2022-03-27 22:30:35,675 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 23:08:54, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0098, loss_bbox: 0.0096, loss: 0.0193
2022-03-27 22:30:41,390 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 15:51:50, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.0078, loss_bbox: 0.0084, loss: 0.0162
2022-03-27 22:30:45,941 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 8:49:51, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0068, loss_bbox: 0.0075, loss: 0.0143
2022-03-27 22:30:50,906 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 3:05:17, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0060, loss_bbox: 0.0052, loss: 0.0112
2022-03-27 22:30:55,460 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 21:50:44, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0053, loss_bbox: 0.0058, loss: 0.0111
2022-03-27 22:31:01,089 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 17:54:43, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0046, loss_bbox: 0.0074, loss: 0.0121
2022-03-27 22:31:05,638 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 13:49:24, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0046, loss_bbox: 0.0049, loss: 0.0095
2022-03-27 22:31:10,386 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 10:17:26, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0039, loss_bbox: 0.0057, loss: 0.0096
2022-03-27 22:31:15,365 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 7:15:29, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0039, loss_bbox: 0.0037, loss: 0.0075
2022-03-27 22:31:20,921 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 4:48:12, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0035, loss_bbox: 0.0017, loss: 0.0052
2022-03-27 22:31:25,744 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 2:14:39, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0036, loss_bbox: 0.0051, loss: 0.0087
2022-03-27 22:31:30,365 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 23:49:31, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0030, loss_bbox: 0.0031, loss: 0.0061
2022-03-27 22:31:35,140 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 21:41:08, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0034, loss: 0.0060
2022-03-27 22:31:40,774 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 20:04:19, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0020, loss: 0.0044
2022-03-27 22:31:45,440 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 18:12:30, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0004, loss: 0.0027
2022-03-27 22:31:50,010 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 16:26:59, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0019, loss: 0.0041
2022-03-27 22:31:54,929 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 14:57:18, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0031, loss: 0.0054
2022-03-27 22:32:00,198 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 13:40:57, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0012, loss: 0.0031
2022-03-27 22:32:05,229 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 12:25:13, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0014, loss: 0.0032
2022-03-27 22:32:09,967 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 11:08:40, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0006, loss: 0.0024
2022-03-27 22:32:14,847 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 9:59:46, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0010, loss: 0.0027
2022-03-27 22:32:20,587 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 9:11:01, time: 0.115, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0014, loss: 0.0031
2022-03-27 22:32:25,184 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 8:04:55, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0013, loss: 0.0029
2022-03-27 22:32:29,483 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 6:57:31, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0014, loss: 0.0030
2022-03-27 22:32:34,175 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 6:00:35, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0008, loss: 0.0023
2022-03-27 22:32:39,617 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 5:18:51, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0008, loss: 0.0022
2022-03-27 22:32:44,026 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 4:23:15, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0007, loss: 0.0021
2022-03-27 22:32:48,568 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 3:32:32, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0014, loss: 0.0028
2022-03-27 22:32:53,317 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 2:47:31, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0007, loss: 0.0020
2022-03-27 22:32:59,002 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 2:18:19, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0009, loss: 0.0021
2022-03-27 22:33:03,812 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 1:38:15, time: 0.096, data_time: 0.002, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0008, loss: 0.0021
2022-03-27 22:33:08,269 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 3 days, 0:55:00, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0006, loss: 0.0018
2022-03-27 22:33:12,970 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 3 days, 0:17:14, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0008, loss: 0.0020
2022-03-27 22:33:17,196 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 23:34:45, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0009, loss: 0.0021
2022-03-27 22:33:19,754 - mmdet - INFO - __benchmark_total_time(h):0.0904760190513399
2022-03-27 22:33:19,754 - mmdet - INFO - __benchmark_pure_training_time(h):0.09036196966965994
2022-03-27 22:33:19,757 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09642135751592767
2022-03-27 22:33:19,758 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 22:33:19,758 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[62062,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 22:33:36,005 [32mINFO[0m: log service ip address is: 10.142.5.213:31417[0m
2022-03-27 22:33:36,005 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 22:34:21,731 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 22:34:21,733 - mmdet - INFO - Distributed training: False
2022-03-27 22:34:23,027 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 22:34:23,077 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:34:23,078 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:34:23,276 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.41s)
creating index...
index created!
loading annotations into memory...
Done (t=0.40s)
creating index...
index created!
2022-03-27 22:34:37,411 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 22:34:37,412 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 22:34:37,412 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 22:34:37,412 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 22:36:24,955 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 43 days, 18:24:36, time: 2.150, data_time: 0.093, memory: 1826, loss_cls: 19.4848, loss_bbox: 2.9292, loss: 22.4140
2022-03-27 22:36:29,986 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 22 days, 21:46:44, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 7.7510, loss_bbox: 0.7759, loss: 8.5269
2022-03-27 22:36:34,584 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 15 days, 21:28:33, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.4877, loss_bbox: 0.1245, loss: 0.6122
2022-03-27 22:36:39,770 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 10:45:35, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.1524, loss_bbox: 0.0749, loss: 0.2273
2022-03-27 22:36:44,786 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 8:49:07, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0871, loss_bbox: 0.0472, loss: 0.1343
2022-03-27 22:36:49,764 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 8 days, 23:26:46, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0455, loss_bbox: 0.0331, loss: 0.0786
2022-03-27 22:36:54,664 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 7 days, 23:29:58, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0338, loss_bbox: 0.0376, loss: 0.0714
2022-03-27 22:37:00,404 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 6:33:33, time: 0.115, data_time: 0.001, memory: 1826, loss_cls: 0.0292, loss_bbox: 0.0479, loss: 0.0770
2022-03-27 22:37:04,729 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 15:51:34, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0247, loss_bbox: 0.0357, loss: 0.0604
2022-03-27 22:37:09,815 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 4:50:24, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0150, loss_bbox: 0.0218, loss: 0.0368
2022-03-27 22:37:15,029 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 19:56:13, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0126, loss_bbox: 0.0167, loss: 0.0293
2022-03-27 22:37:21,056 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 13:10:25, time: 0.120, data_time: 0.001, memory: 1826, loss_cls: 0.0100, loss_bbox: 0.0093, loss: 0.0193
2022-03-27 22:37:25,870 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 6:32:44, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0078, loss_bbox: 0.0100, loss: 0.0178
2022-03-27 22:37:30,986 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 1:04:26, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0071, loss_bbox: 0.0076, loss: 0.0147
2022-03-27 22:37:35,855 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 20:10:07, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0064, loss_bbox: 0.0023, loss: 0.0087
2022-03-27 22:37:41,470 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 16:19:51, time: 0.112, data_time: 0.001, memory: 1826, loss_cls: 0.0047, loss_bbox: 0.0034, loss: 0.0081
2022-03-27 22:37:46,668 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 12:42:31, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0041, loss_bbox: 0.0016, loss: 0.0057
2022-03-27 22:37:51,772 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 9:26:08, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0037, loss_bbox: 0.0014, loss: 0.0050
2022-03-27 22:37:56,650 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 6:23:31, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0034, loss_bbox: 0.0009, loss: 0.0043
2022-03-27 22:38:02,789 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 4:15:50, time: 0.123, data_time: 0.001, memory: 1826, loss_cls: 0.0032, loss_bbox: 0.0015, loss: 0.0047
2022-03-27 22:38:07,765 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 1:48:10, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0030, loss_bbox: 0.0014, loss: 0.0044
2022-03-27 22:38:12,874 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 23:37:17, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0028, loss_bbox: 0.0014, loss: 0.0042
2022-03-27 22:38:17,587 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 21:27:49, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0013, loss: 0.0039
2022-03-27 22:38:23,305 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 19:53:30, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.0025, loss_bbox: 0.0005, loss: 0.0030
2022-03-27 22:38:28,398 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 18:12:21, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0012, loss: 0.0035
2022-03-27 22:38:33,354 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 16:35:37, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0010, loss: 0.0032
2022-03-27 22:38:38,869 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 15:18:08, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0011, loss: 0.0032
2022-03-27 22:38:43,993 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 13:58:15, time: 0.103, data_time: 0.002, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0008, loss: 0.0028
2022-03-27 22:38:48,736 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 12:36:05, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0009, loss: 0.0028
2022-03-27 22:38:53,474 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 11:19:12, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0013, loss: 0.0032
2022-03-27 22:38:59,428 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 10:30:17, time: 0.119, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0011, loss: 0.0030
2022-03-27 22:39:04,241 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 9:23:36, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0005, loss: 0.0023
2022-03-27 22:39:09,258 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 8:24:33, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0008, loss: 0.0025
2022-03-27 22:39:14,585 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 7:34:18, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0012, loss: 0.0029
2022-03-27 22:39:20,111 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 6:49:49, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0007, loss: 0.0023
2022-03-27 22:39:25,330 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 6:03:38, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0009, loss: 0.0025
2022-03-27 22:39:30,262 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 5:14:56, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0005, loss: 0.0020
2022-03-27 22:39:35,206 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 4:29:03, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0007, loss: 0.0022
2022-03-27 22:39:40,813 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 3:55:23, time: 0.112, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0009, loss: 0.0024
2022-03-27 22:39:45,726 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 3:13:23, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0010, loss: 0.0025
2022-03-27 22:39:50,748 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 2:34:54, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0009, loss: 0.0023
2022-03-27 22:39:55,583 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 3 days, 1:55:40, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0006, loss: 0.0019
2022-03-27 22:40:01,515 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 3 days, 1:33:04, time: 0.118, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0007, loss: 0.0021
2022-03-27 22:40:06,807 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 3 days, 1:03:10, time: 0.106, data_time: 0.003, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0010, loss: 0.0023
2022-03-27 22:40:08,936 - mmdet - INFO - __benchmark_total_time(h):0.09220666057533689
2022-03-27 22:40:08,936 - mmdet - INFO - __benchmark_pure_training_time(h):0.09208991507689158
2022-03-27 22:40:08,938 - mmdet - INFO - __benchmark_avg_iter_time(s):0.10352570431811231
2022-03-27 22:40:08,938 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 22:40:08,938 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[37201,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 22:40:27,338 [32mINFO[0m: log service ip address is: 10.142.5.213:21652[0m
2022-03-27 22:40:27,339 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 22:41:13,199 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 22:41:13,201 - mmdet - INFO - Distributed training: False
2022-03-27 22:41:14,443 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 22:41:14,497 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:41:14,498 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:41:14,690 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.68s)
creating index...
index created!
loading annotations into memory...
Done (t=0.38s)
creating index...
index created!
2022-03-27 22:41:29,296 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 22:41:29,298 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 22:41:29,298 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 22:41:29,298 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 22:43:16,547 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 43 days, 15:36:12, time: 2.144, data_time: 0.095, memory: 1826, loss_cls: 19.0838, loss_bbox: 3.2197, loss: 22.3035
2022-03-27 22:43:21,478 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 22 days, 19:53:33, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 6.9372, loss_bbox: 0.7163, loss: 7.6535
2022-03-27 22:43:26,357 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 15 days, 21:08:24, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.5155, loss_bbox: 0.1242, loss: 0.6397
2022-03-27 22:43:31,753 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 11:00:33, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.1740, loss_bbox: 0.0591, loss: 0.2331
2022-03-27 22:43:36,754 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 8:59:25, time: 0.100, data_time: 0.002, memory: 1826, loss_cls: 0.0973, loss_bbox: 0.0498, loss: 0.1471
2022-03-27 22:43:41,703 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 8 days, 23:32:40, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0570, loss_bbox: 0.0352, loss: 0.0922
2022-03-27 22:43:46,365 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 7 days, 23:15:19, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0395, loss_bbox: 0.0352, loss: 0.0747
2022-03-27 22:43:52,243 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 6:31:08, time: 0.118, data_time: 0.001, memory: 1826, loss_cls: 0.0266, loss_bbox: 0.0211, loss: 0.0477
2022-03-27 22:43:57,204 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 16:30:37, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0185, loss_bbox: 0.0166, loss: 0.0351
2022-03-27 22:44:02,147 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 5:16:58, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0140, loss_bbox: 0.0100, loss: 0.0240
2022-03-27 22:44:06,887 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 19:55:14, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0113, loss_bbox: 0.0046, loss: 0.0159
2022-03-27 22:44:12,696 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 12:58:29, time: 0.116, data_time: 0.001, memory: 1826, loss_cls: 0.0094, loss_bbox: 0.0065, loss: 0.0158
2022-03-27 22:44:17,836 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 6:36:59, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0080, loss_bbox: 0.0052, loss: 0.0133
2022-03-27 22:44:23,031 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 1:11:22, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0068, loss_bbox: 0.0042, loss: 0.0111
2022-03-27 22:44:28,113 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 20:24:59, time: 0.102, data_time: 0.002, memory: 1826, loss_cls: 0.0060, loss_bbox: 0.0044, loss: 0.0104
2022-03-27 22:44:33,614 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 16:29:37, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0054, loss_bbox: 0.0037, loss: 0.0092
2022-03-27 22:44:38,400 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 12:37:32, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0050, loss_bbox: 0.0008, loss: 0.0058
2022-03-27 22:44:43,433 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 9:19:09, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0045, loss_bbox: 0.0027, loss: 0.0072
2022-03-27 22:44:48,043 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 6:08:29, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0042, loss_bbox: 0.0036, loss: 0.0077
2022-03-27 22:44:53,214 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 3:33:19, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0038, loss_bbox: 0.0002, loss: 0.0040
2022-03-27 22:44:57,835 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 0:57:43, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0035, loss_bbox: 0.0017, loss: 0.0051
2022-03-27 22:45:03,086 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 22:52:54, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0032, loss_bbox: 0.0017, loss: 0.0050
2022-03-27 22:45:07,526 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 20:38:23, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0030, loss_bbox: 0.0001, loss: 0.0032
2022-03-27 22:45:13,027 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 19:00:49, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0028, loss_bbox: 0.0011, loss: 0.0040
2022-03-27 22:45:17,695 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 17:11:48, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0010, loss: 0.0037
2022-03-27 22:45:22,266 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 15:28:46, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0008, loss: 0.0034
2022-03-27 22:45:26,772 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 13:52:06, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0008, loss: 0.0032
2022-03-27 22:45:31,992 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 12:37:07, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0003, loss: 0.0026
2022-03-27 22:45:36,627 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 11:15:30, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0011, loss: 0.0034
2022-03-27 22:45:41,236 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 9:58:47, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0013, loss: 0.0035
2022-03-27 22:45:45,714 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 8:44:40, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0002, loss: 0.0023
2022-03-27 22:45:50,562 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 7:41:49, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0008, loss: 0.0028
2022-03-27 22:45:54,854 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 6:33:02, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0004, loss: 0.0024
2022-03-27 22:45:59,827 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 5:39:54, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0006, loss: 0.0025
2022-03-27 22:46:04,524 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 4:45:17, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0006, loss: 0.0025
2022-03-27 22:46:09,842 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 4:03:44, time: 0.106, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0010, loss: 0.0027
2022-03-27 22:46:14,479 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 3:13:41, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0004, loss: 0.0021
2022-03-27 22:46:19,139 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 2:26:34, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0005, loss: 0.0021
2022-03-27 22:46:23,798 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 1:41:55, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0008, loss: 0.0024
2022-03-27 22:46:28,302 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 0:57:11, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0005, loss: 0.0022
2022-03-27 22:46:33,668 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 0:26:54, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0007, loss: 0.0023
2022-03-27 22:46:38,225 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 2 days, 23:46:52, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0004, loss: 0.0019
2022-03-27 22:46:43,059 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 23:12:23, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0006, loss: 0.0021
2022-03-27 22:46:47,597 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 22:35:36, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0005, loss: 0.0020
2022-03-27 22:46:50,186 - mmdet - INFO - __benchmark_total_time(h):0.08924670815467835
2022-03-27 22:46:50,192 - mmdet - INFO - __benchmark_pure_training_time(h):0.08913531243801116
2022-03-27 22:46:50,193 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09458200343243488
2022-03-27 22:46:50,193 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 22:46:50,193 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[43754,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 22:47:06,815 [32mINFO[0m: log service ip address is: 10.142.5.213:25146[0m
2022-03-27 22:47:06,816 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 22:47:52,234 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 22:47:52,236 - mmdet - INFO - Distributed training: False
2022-03-27 22:47:53,550 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 22:47:53,632 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:47:53,634 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:47:53,939 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=11.62s)
creating index...
index created!
loading annotations into memory...
Done (t=0.39s)
creating index...
index created!
2022-03-27 22:48:09,513 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 22:48:09,514 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 22:48:09,514 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 22:48:09,514 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 22:49:57,315 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 43 days, 20:59:27, time: 2.155, data_time: 0.095, memory: 1826, loss_cls: 19.2884, loss_bbox: 3.1609, loss: 22.4494
2022-03-27 22:50:02,355 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 22 days, 23:07:54, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 7.4132, loss_bbox: 0.8133, loss: 8.2265
2022-03-27 22:50:07,087 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 15 days, 22:49:23, time: 0.095, data_time: 0.002, memory: 1826, loss_cls: 0.4382, loss_bbox: 0.1893, loss: 0.6275
2022-03-27 22:50:12,912 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 13:19:35, time: 0.116, data_time: 0.001, memory: 1826, loss_cls: 0.1257, loss_bbox: 0.0529, loss: 0.1786
2022-03-27 22:50:17,854 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 10:43:02, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0630, loss_bbox: 0.0359, loss: 0.0989
2022-03-27 22:50:22,948 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 1:13:36, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0388, loss_bbox: 0.0343, loss: 0.0731
2022-03-27 22:50:27,900 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 1:05:43, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0289, loss_bbox: 0.0382, loss: 0.0671
2022-03-27 22:50:33,684 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 8:00:46, time: 0.116, data_time: 0.001, memory: 1826, loss_cls: 0.0198, loss_bbox: 0.0250, loss: 0.0447
2022-03-27 22:50:38,505 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 17:41:15, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0157, loss_bbox: 0.0232, loss: 0.0389
2022-03-27 22:50:43,313 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 6:12:42, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0116, loss_bbox: 0.0166, loss: 0.0282
2022-03-27 22:50:47,733 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 20:28:46, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0104, loss_bbox: 0.0148, loss: 0.0252
2022-03-27 22:50:52,972 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 13:01:43, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0069, loss_bbox: 0.0097, loss: 0.0166
2022-03-27 22:50:57,706 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 6:21:10, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0055, loss_bbox: 0.0054, loss: 0.0109
2022-03-27 22:51:02,435 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 0:37:26, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0052, loss_bbox: 0.0055, loss: 0.0107
2022-03-27 22:51:07,462 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 19:51:14, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0050, loss_bbox: 0.0081, loss: 0.0131
2022-03-27 22:51:13,087 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 16:02:18, time: 0.112, data_time: 0.001, memory: 1826, loss_cls: 0.0041, loss_bbox: 0.0040, loss: 0.0081
2022-03-27 22:51:17,878 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 12:12:05, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0036, loss_bbox: 0.0058, loss: 0.0095
2022-03-27 22:51:22,774 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 8:50:37, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0033, loss_bbox: 0.0028, loss: 0.0061
2022-03-27 22:51:27,219 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 5:36:28, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0015, loss: 0.0043
2022-03-27 22:51:32,475 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 3:05:15, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0012, loss: 0.0038
2022-03-27 22:51:37,266 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 0:35:53, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0031, loss: 0.0055
2022-03-27 22:51:42,260 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 22:25:16, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0015, loss: 0.0037
2022-03-27 22:51:47,227 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 20:25:20, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0008, loss: 0.0028
2022-03-27 22:51:53,280 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 19:01:46, time: 0.121, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0014, loss: 0.0033
2022-03-27 22:51:58,132 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 17:16:58, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0015, loss: 0.0032
2022-03-27 22:52:03,056 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 15:41:45, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0004, loss: 0.0021
2022-03-27 22:52:07,723 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 14:08:00, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0008, loss: 0.0024
2022-03-27 22:52:13,218 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 12:58:02, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0010, loss: 0.0025
2022-03-27 22:52:17,688 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 11:32:34, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0006, loss: 0.0020
2022-03-27 22:52:22,313 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 10:15:42, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0003, loss: 0.0017
2022-03-27 22:52:27,161 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 9:07:56, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0008, loss: 0.0021
2022-03-27 22:52:32,940 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 8:21:17, time: 0.115, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0007, loss: 0.0020
2022-03-27 22:52:37,736 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 7:20:23, time: 0.096, data_time: 0.002, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0007, loss: 0.0020
2022-03-27 22:52:42,501 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 6:22:19, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0010, loss: 0.0022
2022-03-27 22:52:47,274 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 5:27:43, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0009, loss: 0.0021
2022-03-27 22:52:52,935 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 4:50:33, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0007, loss: 0.0018
2022-03-27 22:52:57,869 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 4:03:58, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0005, loss: 0.0016
2022-03-27 22:53:02,845 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 3:20:26, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0009, loss: 0.0020
2022-03-27 22:53:07,838 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 2:39:22, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0008, loss: 0.0018
2022-03-27 22:53:13,305 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 2:07:14, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0010, loss_bbox: 0.0004, loss: 0.0015
2022-03-27 22:53:18,185 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 1:28:24, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0010, loss_bbox: 0.0008, loss: 0.0018
2022-03-27 22:53:23,223 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 3 days, 0:53:34, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0010, loss_bbox: 0.0003, loss: 0.0013
2022-03-27 22:53:28,266 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 3 days, 0:20:24, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0010, loss_bbox: 0.0005, loss: 0.0015
2022-03-27 22:53:34,013 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 23:58:02, time: 0.115, data_time: 0.001, memory: 1826, loss_cls: 0.0009, loss_bbox: 0.0007, loss: 0.0016
2022-03-27 22:53:36,090 - mmdet - INFO - __benchmark_total_time(h):0.09083096279038323
2022-03-27 22:53:36,091 - mmdet - INFO - __benchmark_pure_training_time(h):0.09071555879380967
2022-03-27 22:53:36,091 - mmdet - INFO - __benchmark_avg_iter_time(s):0.10076901915071013
2022-03-27 22:53:36,091 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 22:53:36,091 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[48304,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 22:53:52,511 [32mINFO[0m: log service ip address is: 10.142.5.213:12208[0m
2022-03-27 22:53:52,512 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 22:54:39,708 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 22:54:39,710 - mmdet - INFO - Distributed training: False
2022-03-27 22:54:40,985 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 22:54:41,074 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:54:41,076 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 22:54:41,379 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.30s)
creating index...
index created!
loading annotations into memory...
Done (t=0.36s)
creating index...
index created!
2022-03-27 22:54:55,407 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 22:54:55,407 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 22:54:55,407 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 22:54:55,407 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 22:56:46,569 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 45 days, 5:47:51, time: 2.222, data_time: 0.094, memory: 1826, loss_cls: 19.5319, loss_bbox: 3.1101, loss: 22.6421
2022-03-27 22:56:51,337 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 23 days, 14:11:55, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 6.5529, loss_bbox: 1.0038, loss: 7.5568
2022-03-27 22:56:56,393 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 9:55:09, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.6286, loss_bbox: 0.2142, loss: 0.8428
2022-03-27 22:57:02,041 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 21:12:38, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.1806, loss_bbox: 0.0918, loss: 0.2724
2022-03-27 22:57:07,168 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 17:23:36, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.1155, loss_bbox: 0.1226, loss: 0.2380
2022-03-27 22:57:12,224 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 6:43:15, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0833, loss_bbox: 0.0747, loss: 0.1580
2022-03-27 22:57:16,969 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 5:31:11, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0417, loss_bbox: 0.0448, loss: 0.0865
2022-03-27 22:57:22,812 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 11:57:35, time: 0.117, data_time: 0.001, memory: 1826, loss_cls: 0.0352, loss_bbox: 0.0313, loss: 0.0665
2022-03-27 22:57:27,642 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 21:12:18, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0245, loss_bbox: 0.0345, loss: 0.0589
2022-03-27 22:57:32,703 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 9:37:15, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0178, loss_bbox: 0.0320, loss: 0.0498
2022-03-27 22:57:37,462 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 23:52:45, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0200, loss_bbox: 0.0362, loss: 0.0562
2022-03-27 22:57:42,856 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 16:15:20, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0129, loss_bbox: 0.0146, loss: 0.0275
2022-03-27 22:57:47,854 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 9:32:49, time: 0.101, data_time: 0.002, memory: 1826, loss_cls: 0.0091, loss_bbox: 0.0115, loss: 0.0206
2022-03-27 22:57:52,819 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 3:45:14, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0078, loss_bbox: 0.0081, loss: 0.0159
2022-03-27 22:57:57,442 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 22:30:36, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0065, loss_bbox: 0.0085, loss: 0.0150
2022-03-27 22:58:02,770 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 18:20:55, time: 0.106, data_time: 0.001, memory: 1826, loss_cls: 0.0065, loss_bbox: 0.0035, loss: 0.0099
2022-03-27 22:58:07,383 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 14:16:24, time: 0.092, data_time: 0.002, memory: 1826, loss_cls: 0.0052, loss_bbox: 0.0062, loss: 0.0115
2022-03-27 22:58:12,344 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 10:50:11, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0042, loss_bbox: 0.0047, loss: 0.0089
2022-03-27 22:58:17,281 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 7:44:53, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0041, loss_bbox: 0.0020, loss: 0.0061
2022-03-27 22:58:22,762 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 5:13:56, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0039, loss_bbox: 0.0028, loss: 0.0067
2022-03-27 22:58:27,523 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 2:37:29, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0034, loss_bbox: 0.0035, loss: 0.0069
2022-03-27 22:58:32,238 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 4 days, 0:13:52, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0030, loss_bbox: 0.0025, loss: 0.0055
2022-03-27 22:58:36,889 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 22:01:13, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0003, loss: 0.0032
2022-03-27 22:58:42,477 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 20:22:20, time: 0.112, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0035, loss: 0.0064
2022-03-27 22:58:47,191 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 18:31:02, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0025, loss_bbox: 0.0026, loss: 0.0052
2022-03-27 22:58:52,328 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 16:57:40, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0025, loss_bbox: 0.0005, loss: 0.0030
2022-03-27 22:58:57,076 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 15:22:56, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0023, loss: 0.0047
2022-03-27 22:59:02,618 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 14:11:27, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0021, loss: 0.0043
2022-03-27 22:59:07,375 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 12:49:09, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0005, loss: 0.0026
2022-03-27 22:59:12,550 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 11:40:21, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0012, loss: 0.0032
2022-03-27 22:59:17,184 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 10:25:53, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0025, loss: 0.0045
2022-03-27 22:59:22,656 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 9:31:19, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0015, loss: 0.0033
2022-03-27 22:59:27,463 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 8:28:19, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0005, loss: 0.0024
2022-03-27 22:59:32,423 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 7:31:41, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0021, loss: 0.0039
2022-03-27 22:59:37,242 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 6:35:48, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0007, loss: 0.0025
2022-03-27 22:59:42,887 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 5:56:28, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0008, loss: 0.0024
2022-03-27 22:59:47,432 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 5:01:56, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0018, loss: 0.0034
2022-03-27 22:59:52,311 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 4:15:20, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0010, loss: 0.0025
2022-03-27 22:59:56,831 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 3:25:49, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0004, loss: 0.0019
2022-03-27 23:00:02,402 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 2:54:04, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0010, loss: 0.0024
2022-03-27 23:00:06,997 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 2:10:00, time: 0.092, data_time: 0.004, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0010, loss: 0.0024
2022-03-27 23:00:11,417 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 3 days, 1:25:34, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0016, loss: 0.0030
2022-03-27 23:00:16,206 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 3 days, 0:48:12, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0007, loss: 0.0020
2022-03-27 23:00:21,830 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 3 days, 0:23:36, time: 0.112, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0011, loss: 0.0024
2022-03-27 23:00:23,861 - mmdet - INFO - __benchmark_total_time(h):0.09134313709206052
2022-03-27 23:00:23,861 - mmdet - INFO - __benchmark_pure_training_time(h):0.0912371102306578
2022-03-27 23:00:23,868 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09938889473944634
2022-03-27 23:00:23,868 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 23:00:23,868 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[22663,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 23:00:39,960 [32mINFO[0m: log service ip address is: 10.142.5.213:45840[0m
2022-03-27 23:00:39,960 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 23:01:25,005 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 23:01:25,007 - mmdet - INFO - Distributed training: False
2022-03-27 23:01:26,270 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 23:01:26,323 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 23:01:26,324 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 23:01:26,516 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.71s)
creating index...
index created!
loading annotations into memory...
Done (t=0.39s)
creating index...
index created!
2022-03-27 23:01:41,002 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 23:01:41,003 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 23:01:41,004 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 23:01:41,004 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 23:03:30,413 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 44 days, 12:42:10, time: 2.187, data_time: 0.094, memory: 1826, loss_cls: 19.1317, loss_bbox: 3.1779, loss: 22.3096
2022-03-27 23:03:35,487 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 23 days, 7:09:47, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 7.0360, loss_bbox: 0.8018, loss: 7.8378
2022-03-27 23:03:40,315 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 4:28:37, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.6093, loss_bbox: 0.1909, loss: 0.8002
2022-03-27 23:03:46,148 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 17:34:43, time: 0.117, data_time: 0.001, memory: 1826, loss_cls: 0.1676, loss_bbox: 0.0498, loss: 0.2175
2022-03-27 23:03:50,913 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 13:47:19, time: 0.096, data_time: 0.002, memory: 1826, loss_cls: 0.0805, loss_bbox: 0.0476, loss: 0.1281
2022-03-27 23:03:55,403 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 2:47:25, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0479, loss_bbox: 0.0197, loss: 0.0677
2022-03-27 23:03:59,774 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 1:37:53, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0302, loss_bbox: 0.0180, loss: 0.0482
2022-03-27 23:04:05,480 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 8:22:40, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.0260, loss_bbox: 0.0361, loss: 0.0621
2022-03-27 23:04:10,250 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 17:58:05, time: 0.096, data_time: 0.002, memory: 1826, loss_cls: 0.0220, loss_bbox: 0.0193, loss: 0.0413
2022-03-27 23:04:14,916 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 6:19:24, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0152, loss_bbox: 0.0153, loss: 0.0306
2022-03-27 23:04:19,692 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 20:53:35, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0113, loss_bbox: 0.0089, loss: 0.0203
2022-03-27 23:04:25,202 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 13:37:45, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0092, loss_bbox: 0.0089, loss: 0.0181
2022-03-27 23:04:29,647 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 6:41:28, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0084, loss_bbox: 0.0080, loss: 0.0164
2022-03-27 23:04:34,277 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 0:52:05, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0070, loss_bbox: 0.0048, loss: 0.0118
2022-03-27 23:04:38,813 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 19:45:40, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0063, loss_bbox: 0.0072, loss: 0.0136
2022-03-27 23:04:44,241 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 15:49:55, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0056, loss_bbox: 0.0041, loss: 0.0097
2022-03-27 23:04:48,726 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 11:49:53, time: 0.090, data_time: 0.002, memory: 1826, loss_cls: 0.0048, loss_bbox: 0.0032, loss: 0.0080
2022-03-27 23:04:53,010 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 8:09:41, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0045, loss_bbox: 0.0037, loss: 0.0082
2022-03-27 23:04:57,321 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 4:53:38, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0041, loss_bbox: 0.0028, loss: 0.0069
2022-03-27 23:05:02,890 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 2:33:52, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0039, loss_bbox: 0.0025, loss: 0.0063
2022-03-27 23:05:07,641 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 0:04:42, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0035, loss_bbox: 0.0031, loss: 0.0066
2022-03-27 23:05:12,458 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 21:50:45, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0036, loss_bbox: 0.0016, loss: 0.0053
2022-03-27 23:05:17,073 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 19:43:26, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0033, loss_bbox: 0.0029, loss: 0.0062
2022-03-27 23:05:22,784 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 18:13:26, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0017, loss: 0.0046
2022-03-27 23:05:27,203 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 16:20:16, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0014, loss: 0.0042
2022-03-27 23:05:31,728 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 14:38:12, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0011, loss: 0.0036
2022-03-27 23:05:36,306 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 13:04:57, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0025, loss_bbox: 0.0018, loss: 0.0042
2022-03-27 23:05:42,006 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 12:01:32, time: 0.114, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0003, loss: 0.0027
2022-03-27 23:05:46,641 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 10:41:23, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0017, loss: 0.0040
2022-03-27 23:05:51,027 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 9:21:27, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0013, loss: 0.0035
2022-03-27 23:05:55,551 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 8:09:21, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0012, loss: 0.0033
2022-03-27 23:05:59,894 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 6:58:31, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0011, loss: 0.0032
2022-03-27 23:06:05,285 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 6:10:20, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0014, loss: 0.0033
2022-03-27 23:06:09,621 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 5:07:00, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0013, loss: 0.0032
2022-03-27 23:06:13,910 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 4:06:28, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0011, loss: 0.0030
2022-03-27 23:06:18,476 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 3:13:46, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0010, loss: 0.0029
2022-03-27 23:06:24,234 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 2:42:43, time: 0.115, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0004, loss: 0.0022
2022-03-27 23:06:28,852 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 1:55:54, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0010, loss: 0.0027
2022-03-27 23:06:33,472 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 1:11:25, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0007, loss: 0.0023
2022-03-27 23:06:38,201 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 0:30:44, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0010, loss: 0.0026
2022-03-27 23:06:43,999 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 0:07:14, time: 0.116, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0005, loss: 0.0020
2022-03-27 23:06:48,551 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 2 days, 23:27:38, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0006, loss: 0.0021
2022-03-27 23:06:52,961 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 22:47:52, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0007, loss: 0.0022
2022-03-27 23:06:57,693 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 22:14:11, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0008, loss: 0.0023
2022-03-27 23:06:59,668 - mmdet - INFO - __benchmark_total_time(h):0.08863312866952684
2022-03-27 23:06:59,673 - mmdet - INFO - __benchmark_pure_training_time(h):0.08851795448197258
2022-03-27 23:06:59,674 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09491801690626574
2022-03-27 23:06:59,674 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 23:06:59,674 - mmdet - INFO - __benchmark_mem_cached(mb):3072
/mnt/lustre/jianglijuan/view-res
