[SH-IDC1-10-142-5-213][[53125,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 18:54:13,064 [32mINFO[0m: log service ip address is: 10.142.5.213:46521[0m
2022-03-27 18:54:13,065 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
2022-03-27 18:55:09,043 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 18:55:09,048 - mmdet - INFO - Distributed training: False
2022-03-27 18:55:09,959 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 18:55:10,130 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 18:55:10,130 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 18:55:10,516 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.66s)
creating index...
index created!
loading annotations into memory...
Done (t=0.36s)
creating index...
index created!
2022-03-27 18:55:24,240 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 18:55:24,240 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 18:55:24,241 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 18:55:24,241 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
2022-03-27 18:55:45,679 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 3 days, 11:37:32, time: 0.428, data_time: 0.090, memory: 3399, loss_rpn_cls: 0.4104, loss_rpn_bbox: 0.0369, loss_cls: 1.4974, acc: 88.1367, loss_bbox: 0.0639, loss_mask: 0.6021, loss: 2.6108
2022-03-27 18:55:53,648 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 2 days, 9:22:59, time: 0.159, data_time: 0.001, memory: 3580, loss_rpn_cls: 0.0485, loss_rpn_bbox: 0.0122, loss_cls: 0.6219, acc: 96.1699, loss_bbox: 0.1732, loss_mask: 0.2545, loss: 1.1103
2022-03-27 18:56:02,010 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 2 days, 1:08:23, time: 0.167, data_time: 0.001, memory: 3581, loss_rpn_cls: 0.0115, loss_rpn_bbox: 0.0125, loss_cls: 0.5094, acc: 98.6191, loss_bbox: 0.1156, loss_mask: 0.1066, loss: 0.7555
2022-03-27 18:56:10,114 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 1 day, 20:46:34, time: 0.162, data_time: 0.001, memory: 3581, loss_rpn_cls: 0.0039, loss_rpn_bbox: 0.0121, loss_cls: 0.2599, acc: 99.0781, loss_bbox: 0.0753, loss_mask: 0.0751, loss: 0.4264
2022-03-27 18:56:19,382 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 1 day, 19:03:20, time: 0.185, data_time: 0.001, memory: 3593, loss_rpn_cls: 0.0035, loss_rpn_bbox: 0.0110, loss_cls: 0.0697, acc: 99.1992, loss_bbox: 0.0650, loss_mask: 0.0654, loss: 0.2148
2022-03-27 18:56:27,551 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 1 day, 17:12:04, time: 0.164, data_time: 0.001, memory: 3593, loss_rpn_cls: 0.0028, loss_rpn_bbox: 0.0100, loss_cls: 0.0296, acc: 99.1797, loss_bbox: 0.0568, loss_mask: 0.0576, loss: 0.1568
2022-03-27 18:56:35,371 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 1 day, 15:40:39, time: 0.156, data_time: 0.001, memory: 3593, loss_rpn_cls: 0.0028, loss_rpn_bbox: 0.0095, loss_cls: 0.0241, acc: 99.3477, loss_bbox: 0.0527, loss_mask: 0.0517, loss: 0.1407
2022-03-27 18:56:44,375 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 1 day, 15:06:31, time: 0.180, data_time: 0.001, memory: 3593, loss_rpn_cls: 0.0024, loss_rpn_bbox: 0.0080, loss_cls: 0.0205, acc: 99.3496, loss_bbox: 0.0492, loss_mask: 0.0490, loss: 0.1291
2022-03-27 18:56:52,072 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 1 day, 14:06:20, time: 0.154, data_time: 0.001, memory: 3593, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0087, loss_cls: 0.0179, acc: 99.4551, loss_bbox: 0.0431, loss_mask: 0.0431, loss: 0.1148
2022-03-27 18:57:00,253 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 1 day, 13:29:08, time: 0.163, data_time: 0.001, memory: 3593, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0083, loss_cls: 0.0152, acc: 99.5527, loss_bbox: 0.0414, loss_mask: 0.0387, loss: 0.1056
2022-03-27 18:57:08,141 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 1 day, 12:52:36, time: 0.158, data_time: 0.001, memory: 3593, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0074, loss_cls: 0.0165, acc: 99.4707, loss_bbox: 0.0375, loss_mask: 0.0362, loss: 0.0995
2022-03-27 18:57:15,869 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 1 day, 12:18:59, time: 0.155, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0061, loss_cls: 0.0137, acc: 99.5625, loss_bbox: 0.0331, loss_mask: 0.0332, loss: 0.0878
2022-03-27 18:57:24,811 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 1 day, 12:12:17, time: 0.179, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0061, loss_cls: 0.0118, acc: 99.6465, loss_bbox: 0.0299, loss_mask: 0.0292, loss: 0.0785
2022-03-27 18:57:32,729 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 1 day, 11:49:37, time: 0.159, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0057, loss_cls: 0.0112, acc: 99.6562, loss_bbox: 0.0254, loss_mask: 0.0265, loss: 0.0701
2022-03-27 18:57:41,429 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 1 day, 11:41:58, time: 0.174, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0064, loss_cls: 0.0099, acc: 99.6699, loss_bbox: 0.0258, loss_mask: 0.0245, loss: 0.0679
2022-03-27 18:57:49,208 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 1 day, 11:21:50, time: 0.156, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0051, loss_cls: 0.0095, acc: 99.7227, loss_bbox: 0.0243, loss_mask: 0.0244, loss: 0.0643
2022-03-27 18:57:57,862 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 1 day, 11:14:46, time: 0.171, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0056, loss_cls: 0.0089, acc: 99.7402, loss_bbox: 0.0266, loss_mask: 0.0240, loss: 0.0663
2022-03-27 18:58:05,896 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 1 day, 11:03:00, time: 0.163, data_time: 0.003, memory: 3597, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0053, loss_cls: 0.0096, acc: 99.7129, loss_bbox: 0.0234, loss_mask: 0.0230, loss: 0.0625
2022-03-27 18:58:13,927 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 1 day, 10:51:08, time: 0.161, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0045, loss_cls: 0.0066, acc: 99.7773, loss_bbox: 0.0214, loss_mask: 0.0209, loss: 0.0544
2022-03-27 18:58:22,789 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 1 day, 10:50:12, time: 0.177, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0048, loss_cls: 0.0073, acc: 99.7695, loss_bbox: 0.0202, loss_mask: 0.0206, loss: 0.0539
2022-03-27 18:58:30,717 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 1 day, 10:38:58, time: 0.159, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0050, loss_cls: 0.0074, acc: 99.7578, loss_bbox: 0.0212, loss_mask: 0.0195, loss: 0.0541
2022-03-27 18:58:39,552 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 1 day, 10:38:20, time: 0.177, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0042, loss_cls: 0.0067, acc: 99.8203, loss_bbox: 0.0203, loss_mask: 0.0187, loss: 0.0508
2022-03-27 18:58:47,390 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 1 day, 10:27:39, time: 0.157, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0045, loss_cls: 0.0063, acc: 99.7832, loss_bbox: 0.0189, loss_mask: 0.0185, loss: 0.0490
2022-03-27 18:58:55,134 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 1 day, 10:16:53, time: 0.155, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0050, loss_cls: 0.0061, acc: 99.7676, loss_bbox: 0.0191, loss_mask: 0.0186, loss: 0.0498
2022-03-27 18:59:03,743 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 1 day, 10:15:02, time: 0.172, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0042, loss_cls: 0.0058, acc: 99.8027, loss_bbox: 0.0187, loss_mask: 0.0176, loss: 0.0472
2022-03-27 18:59:12,625 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 1 day, 10:15:53, time: 0.178, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0040, loss_cls: 0.0055, acc: 99.8281, loss_bbox: 0.0172, loss_mask: 0.0169, loss: 0.0442
2022-03-27 18:59:21,553 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 1 day, 10:16:57, time: 0.178, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0042, loss_cls: 0.0046, acc: 99.8516, loss_bbox: 0.0172, loss_mask: 0.0164, loss: 0.0431
2022-03-27 18:59:30,105 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 1 day, 10:14:53, time: 0.171, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0038, loss_cls: 0.0069, acc: 99.8086, loss_bbox: 0.0182, loss_mask: 0.0163, loss: 0.0460
2022-03-27 18:59:38,900 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 1 day, 10:14:40, time: 0.175, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0038, loss_cls: 0.0060, acc: 99.8105, loss_bbox: 0.0168, loss_mask: 0.0157, loss: 0.0431
2022-03-27 18:59:46,885 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 1 day, 10:08:31, time: 0.160, data_time: 0.002, memory: 3597, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0036, loss_cls: 0.0067, acc: 99.7891, loss_bbox: 0.0161, loss_mask: 0.0157, loss: 0.0428
2022-03-27 18:59:55,457 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 10:07:00, time: 0.171, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0033, loss_cls: 0.0054, acc: 99.8301, loss_bbox: 0.0161, loss_mask: 0.0154, loss: 0.0409
2022-03-27 19:00:04,462 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 10:08:36, time: 0.180, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0036, loss_cls: 0.0056, acc: 99.8184, loss_bbox: 0.0159, loss_mask: 0.0150, loss: 0.0407
2022-03-27 19:00:12,910 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 10:06:23, time: 0.169, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0035, loss_cls: 0.0038, acc: 99.8945, loss_bbox: 0.0148, loss_mask: 0.0143, loss: 0.0370
2022-03-27 19:00:21,695 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 10:06:30, time: 0.176, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0037, loss_cls: 0.0043, acc: 99.8730, loss_bbox: 0.0148, loss_mask: 0.0138, loss: 0.0372
2022-03-27 19:00:29,854 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 10:02:29, time: 0.163, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0036, loss_cls: 0.0035, acc: 99.8770, loss_bbox: 0.0151, loss_mask: 0.0144, loss: 0.0373
2022-03-27 19:00:38,614 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 10:02:29, time: 0.175, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0035, loss_cls: 0.0034, acc: 99.8848, loss_bbox: 0.0147, loss_mask: 0.0134, loss: 0.0357
2022-03-27 19:00:46,508 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 9:57:03, time: 0.158, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0034, loss_cls: 0.0057, acc: 99.8203, loss_bbox: 0.0146, loss_mask: 0.0137, loss: 0.0380
2022-03-27 19:00:54,913 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 9:55:03, time: 0.168, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0034, loss_cls: 0.0037, acc: 99.8926, loss_bbox: 0.0152, loss_mask: 0.0130, loss: 0.0358
2022-03-27 19:01:03,769 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 9:55:48, time: 0.177, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0033, loss_cls: 0.0035, acc: 99.9004, loss_bbox: 0.0146, loss_mask: 0.0134, loss: 0.0355
2022-03-27 19:01:11,867 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 9:52:08, time: 0.162, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0033, loss_cls: 0.0024, acc: 99.9336, loss_bbox: 0.0130, loss_mask: 0.0122, loss: 0.0314
2022-03-27 19:01:20,983 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 9:54:23, time: 0.182, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0035, loss_cls: 0.0033, acc: 99.9062, loss_bbox: 0.0143, loss_mask: 0.0123, loss: 0.0340
2022-03-27 19:01:28,973 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 9:50:19, time: 0.160, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0031, loss_cls: 0.0036, acc: 99.8965, loss_bbox: 0.0131, loss_mask: 0.0118, loss: 0.0321
2022-03-27 19:01:36,992 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 9:46:33, time: 0.160, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0032, loss_cls: 0.0039, acc: 99.8789, loss_bbox: 0.0137, loss_mask: 0.0114, loss: 0.0327
2022-03-27 19:01:46,349 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 9:50:03, time: 0.187, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0035, loss_cls: 0.0036, acc: 99.8984, loss_bbox: 0.0139, loss_mask: 0.0123, loss: 0.0339
2022-03-27 19:01:49,807 - mmdet - INFO - __benchmark_total_time(h):0.10720712218019697
2022-03-27 19:01:49,807 - mmdet - INFO - __benchmark_pure_training_time(h):0.10710159811708662
2022-03-27 19:01:49,808 - mmdet - INFO - __benchmark_avg_iter_time(s):0.17124771214388942
2022-03-27 19:01:49,808 - mmdet - INFO - __benchmark_mem_alloc(mb):3597
2022-03-27 19:01:49,808 - mmdet - INFO - __benchmark_mem_cached(mb):4592
[SH-IDC1-10-142-5-213][[61286,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 19:02:05,993 [32mINFO[0m: log service ip address is: 10.142.5.213:23976[0m
2022-03-27 19:02:05,993 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
2022-03-27 19:02:51,346 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 19:02:51,349 - mmdet - INFO - Distributed training: False
2022-03-27 19:02:52,248 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 19:02:52,390 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:02:52,391 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:02:52,859 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=11.13s)
creating index...
index created!
loading annotations into memory...
Done (t=0.46s)
creating index...
index created!
2022-03-27 19:03:07,271 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 19:03:07,271 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 19:03:07,272 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 19:03:07,272 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
2022-03-27 19:03:27,751 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 3 days, 7:44:45, time: 0.408, data_time: 0.089, memory: 3414, loss_rpn_cls: 0.3880, loss_rpn_bbox: 0.0330, loss_cls: 1.5026, acc: 88.6582, loss_bbox: 0.0614, loss_mask: 0.5698, loss: 2.5548
2022-03-27 19:03:35,546 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 2 days, 7:08:01, time: 0.156, data_time: 0.002, memory: 3571, loss_rpn_cls: 0.0403, loss_rpn_bbox: 0.0119, loss_cls: 0.7449, acc: 96.7227, loss_bbox: 0.1842, loss_mask: 0.2241, loss: 1.2054
2022-03-27 19:03:44,068 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 1 day, 23:51:19, time: 0.170, data_time: 0.001, memory: 3574, loss_rpn_cls: 0.0063, loss_rpn_bbox: 0.0131, loss_cls: 0.3335, acc: 98.9492, loss_bbox: 0.1008, loss_mask: 0.1006, loss: 0.5543
2022-03-27 19:03:52,117 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 1 day, 19:45:18, time: 0.161, data_time: 0.001, memory: 3574, loss_rpn_cls: 0.0035, loss_rpn_bbox: 0.0116, loss_cls: 0.2259, acc: 99.1602, loss_bbox: 0.0710, loss_mask: 0.0758, loss: 0.3879
2022-03-27 19:04:01,370 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 1 day, 18:13:50, time: 0.185, data_time: 0.001, memory: 3574, loss_rpn_cls: 0.0034, loss_rpn_bbox: 0.0114, loss_cls: 0.1063, acc: 99.2969, loss_bbox: 0.0587, loss_mask: 0.0661, loss: 0.2458
2022-03-27 19:04:09,647 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 1 day, 16:34:31, time: 0.165, data_time: 0.001, memory: 3574, loss_rpn_cls: 0.0030, loss_rpn_bbox: 0.0100, loss_cls: 0.0281, acc: 99.3184, loss_bbox: 0.0563, loss_mask: 0.0584, loss: 0.1558
2022-03-27 19:04:18,160 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 1 day, 15:25:42, time: 0.167, data_time: 0.001, memory: 3574, loss_rpn_cls: 0.0024, loss_rpn_bbox: 0.0088, loss_cls: 0.0244, acc: 99.3594, loss_bbox: 0.0520, loss_mask: 0.0534, loss: 0.1411
2022-03-27 19:04:26,493 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 1 day, 14:39:24, time: 0.170, data_time: 0.005, memory: 3574, loss_rpn_cls: 0.0026, loss_rpn_bbox: 0.0090, loss_cls: 0.0197, acc: 99.4336, loss_bbox: 0.0486, loss_mask: 0.0497, loss: 0.1295
2022-03-27 19:04:34,463 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 1 day, 13:48:56, time: 0.159, data_time: 0.001, memory: 3574, loss_rpn_cls: 0.0024, loss_rpn_bbox: 0.0091, loss_cls: 0.0172, acc: 99.4844, loss_bbox: 0.0465, loss_mask: 0.0427, loss: 0.1179
2022-03-27 19:04:43,226 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 1 day, 13:27:17, time: 0.175, data_time: 0.001, memory: 3578, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0086, loss_cls: 0.0133, acc: 99.6426, loss_bbox: 0.0418, loss_mask: 0.0390, loss: 0.1045
2022-03-27 19:04:51,217 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 1 day, 12:53:14, time: 0.160, data_time: 0.001, memory: 3578, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0074, loss_cls: 0.0135, acc: 99.5762, loss_bbox: 0.0380, loss_mask: 0.0363, loss: 0.0973
2022-03-27 19:05:00,119 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 1 day, 12:42:25, time: 0.178, data_time: 0.001, memory: 3587, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0071, loss_cls: 0.0116, acc: 99.6562, loss_bbox: 0.0344, loss_mask: 0.0325, loss: 0.0873
2022-03-27 19:05:07,907 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 1 day, 12:13:07, time: 0.156, data_time: 0.001, memory: 3587, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0063, loss_cls: 0.0094, acc: 99.7285, loss_bbox: 0.0305, loss_mask: 0.0302, loss: 0.0779
2022-03-27 19:05:15,909 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 1 day, 11:51:46, time: 0.160, data_time: 0.001, memory: 3587, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0065, loss_cls: 0.0095, acc: 99.6777, loss_bbox: 0.0294, loss_mask: 0.0291, loss: 0.0760
2022-03-27 19:05:24,518 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 1 day, 11:42:37, time: 0.172, data_time: 0.001, memory: 3587, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0059, loss_cls: 0.0093, acc: 99.7266, loss_bbox: 0.0279, loss_mask: 0.0265, loss: 0.0709
2022-03-27 19:05:33,043 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 1 day, 11:33:20, time: 0.170, data_time: 0.001, memory: 3587, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0058, loss_cls: 0.0093, acc: 99.7168, loss_bbox: 0.0286, loss_mask: 0.0254, loss: 0.0705
2022-03-27 19:05:41,799 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 1 day, 11:28:20, time: 0.175, data_time: 0.001, memory: 3587, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0060, loss_cls: 0.0084, acc: 99.7246, loss_bbox: 0.0249, loss_mask: 0.0246, loss: 0.0651
2022-03-27 19:05:49,844 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 1 day, 11:14:39, time: 0.161, data_time: 0.001, memory: 3587, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0054, loss_cls: 0.0081, acc: 99.7520, loss_bbox: 0.0236, loss_mask: 0.0229, loss: 0.0612
2022-03-27 19:05:57,515 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 1 day, 10:57:49, time: 0.154, data_time: 0.001, memory: 3587, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0056, loss_cls: 0.0062, acc: 99.8047, loss_bbox: 0.0253, loss_mask: 0.0221, loss: 0.0605
2022-03-27 19:06:06,815 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 1 day, 11:01:38, time: 0.186, data_time: 0.001, memory: 3587, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0049, loss_cls: 0.0057, acc: 99.8086, loss_bbox: 0.0221, loss_mask: 0.0208, loss: 0.0546
2022-03-27 19:06:14,746 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 1 day, 10:49:51, time: 0.159, data_time: 0.001, memory: 3587, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0044, loss_cls: 0.0041, acc: 99.8945, loss_bbox: 0.0207, loss_mask: 0.0189, loss: 0.0489
2022-03-27 19:06:23,644 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 1 day, 10:49:26, time: 0.178, data_time: 0.001, memory: 3587, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0045, loss_cls: 0.0053, acc: 99.8398, loss_bbox: 0.0209, loss_mask: 0.0179, loss: 0.0493
2022-03-27 19:06:31,712 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 1 day, 10:40:34, time: 0.161, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0043, loss_cls: 0.0045, acc: 99.8730, loss_bbox: 0.0207, loss_mask: 0.0185, loss: 0.0487
2022-03-27 19:06:40,220 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 1 day, 10:36:44, time: 0.170, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0043, loss_cls: 0.0048, acc: 99.8770, loss_bbox: 0.0198, loss_mask: 0.0180, loss: 0.0476
2022-03-27 19:06:48,457 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 1 day, 10:30:40, time: 0.165, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0042, loss_cls: 0.0046, acc: 99.8594, loss_bbox: 0.0193, loss_mask: 0.0175, loss: 0.0465
2022-03-27 19:06:56,344 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 1 day, 10:21:52, time: 0.158, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0041, loss_cls: 0.0049, acc: 99.8457, loss_bbox: 0.0198, loss_mask: 0.0175, loss: 0.0470
2022-03-27 19:07:05,063 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 1 day, 10:20:58, time: 0.174, data_time: 0.001, memory: 3608, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0037, loss_cls: 0.0040, acc: 99.8828, loss_bbox: 0.0181, loss_mask: 0.0166, loss: 0.0430
2022-03-27 19:07:13,874 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 1 day, 10:20:53, time: 0.176, data_time: 0.001, memory: 3608, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0038, loss_cls: 0.0056, acc: 99.8203, loss_bbox: 0.0172, loss_mask: 0.0156, loss: 0.0429
2022-03-27 19:07:22,545 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 1 day, 10:19:38, time: 0.173, data_time: 0.001, memory: 3608, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0041, loss_cls: 0.0058, acc: 99.8398, loss_bbox: 0.0174, loss_mask: 0.0168, loss: 0.0449
2022-03-27 19:07:31,172 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 1 day, 10:18:12, time: 0.173, data_time: 0.001, memory: 3608, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0040, loss_cls: 0.0030, acc: 99.9258, loss_bbox: 0.0171, loss_mask: 0.0160, loss: 0.0407
2022-03-27 19:07:39,738 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 10:16:18, time: 0.171, data_time: 0.001, memory: 3617, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0036, loss_cls: 0.0029, acc: 99.9102, loss_bbox: 0.0174, loss_mask: 0.0148, loss: 0.0393
2022-03-27 19:07:47,903 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 10:10:31, time: 0.160, data_time: 0.001, memory: 3617, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0035, loss_cls: 0.0040, acc: 99.8613, loss_bbox: 0.0163, loss_mask: 0.0154, loss: 0.0398
2022-03-27 19:07:55,744 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 10:04:53, time: 0.160, data_time: 0.004, memory: 3617, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0038, loss_cls: 0.0040, acc: 99.8965, loss_bbox: 0.0155, loss_mask: 0.0142, loss: 0.0382
2022-03-27 19:08:04,575 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 10:05:22, time: 0.177, data_time: 0.001, memory: 3617, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0035, loss_cls: 0.0036, acc: 99.8750, loss_bbox: 0.0156, loss_mask: 0.0136, loss: 0.0369
2022-03-27 19:08:12,821 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 10:01:50, time: 0.165, data_time: 0.001, memory: 3617, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0037, loss_cls: 0.0045, acc: 99.8887, loss_bbox: 0.0154, loss_mask: 0.0137, loss: 0.0380
2022-03-27 19:08:21,306 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 10:00:11, time: 0.170, data_time: 0.001, memory: 3617, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0035, loss_cls: 0.0055, acc: 99.8594, loss_bbox: 0.0165, loss_mask: 0.0144, loss: 0.0404
2022-03-27 19:08:29,342 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 9:55:39, time: 0.161, data_time: 0.001, memory: 3617, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0033, loss_cls: 0.0062, acc: 99.8223, loss_bbox: 0.0175, loss_mask: 0.0147, loss: 0.0423
2022-03-27 19:08:37,262 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 9:50:43, time: 0.158, data_time: 0.001, memory: 3617, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0029, loss_cls: 0.0052, acc: 99.8633, loss_bbox: 0.0152, loss_mask: 0.0148, loss: 0.0388
2022-03-27 19:08:45,810 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 9:49:47, time: 0.171, data_time: 0.001, memory: 3617, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0033, loss_cls: 0.0045, acc: 99.8496, loss_bbox: 0.0153, loss_mask: 0.0138, loss: 0.0373
2022-03-27 19:08:53,566 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 9:44:12, time: 0.155, data_time: 0.001, memory: 3617, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0033, loss_cls: 0.0040, acc: 99.8633, loss_bbox: 0.0138, loss_mask: 0.0138, loss: 0.0355
2022-03-27 19:09:02,285 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 9:44:26, time: 0.174, data_time: 0.001, memory: 3617, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0032, loss_cls: 0.0026, acc: 99.9277, loss_bbox: 0.0138, loss_mask: 0.0130, loss: 0.0331
2022-03-27 19:09:10,227 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 9:40:19, time: 0.159, data_time: 0.001, memory: 3617, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0031, loss_cls: 0.0028, acc: 99.9219, loss_bbox: 0.0144, loss_mask: 0.0123, loss: 0.0331
2022-03-27 19:09:18,262 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 9:35:06, time: 0.154, data_time: 0.001, memory: 3617, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0032, loss_cls: 0.0030, acc: 99.9102, loss_bbox: 0.0136, loss_mask: 0.0126, loss: 0.0329
2022-03-27 19:09:26,497 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 9:34:40, time: 0.171, data_time: 0.008, memory: 3617, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0035, loss_cls: 0.0035, acc: 99.8887, loss_bbox: 0.0135, loss_mask: 0.0124, loss: 0.0334
2022-03-27 19:09:29,836 - mmdet - INFO - __benchmark_total_time(h):0.10640148407883114
2022-03-27 19:09:29,837 - mmdet - INFO - __benchmark_pure_training_time(h):0.10626766509479947
2022-03-27 19:09:29,839 - mmdet - INFO - __benchmark_avg_iter_time(s):0.16627434988717338
2022-03-27 19:09:29,839 - mmdet - INFO - __benchmark_mem_alloc(mb):3606
2022-03-27 19:09:29,839 - mmdet - INFO - __benchmark_mem_cached(mb):4592
[SH-IDC1-10-142-5-213][[34730,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 19:09:47,903 [32mINFO[0m: log service ip address is: 10.142.5.213:41951[0m
2022-03-27 19:09:47,903 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
2022-03-27 19:10:38,273 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 19:10:38,276 - mmdet - INFO - Distributed training: False
2022-03-27 19:10:39,181 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 19:10:39,964 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:10:39,966 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:10:40,495 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.64s)
creating index...
index created!
loading annotations into memory...
Done (t=0.37s)
creating index...
index created!
2022-03-27 19:10:54,028 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 19:10:54,029 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 19:10:54,030 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 19:10:54,030 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
2022-03-27 19:11:15,493 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 3 days, 11:40:44, time: 0.428, data_time: 0.090, memory: 3484, loss_rpn_cls: 0.4276, loss_rpn_bbox: 0.0340, loss_cls: 1.4940, acc: 89.9844, loss_bbox: 0.0903, loss_mask: 0.6482, loss: 2.6943
2022-03-27 19:11:24,566 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 2 days, 11:34:34, time: 0.182, data_time: 0.001, memory: 3589, loss_rpn_cls: 0.0475, loss_rpn_bbox: 0.0124, loss_cls: 0.4834, acc: 95.5059, loss_bbox: 0.2247, loss_mask: 0.2812, loss: 1.0493
2022-03-27 19:11:32,940 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 2 days, 2:37:22, time: 0.167, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0096, loss_rpn_bbox: 0.0133, loss_cls: 0.1795, acc: 98.7246, loss_bbox: 0.1147, loss_mask: 0.0994, loss: 0.4165
2022-03-27 19:11:41,865 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 1 day, 22:41:11, time: 0.179, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0042, loss_rpn_bbox: 0.0119, loss_cls: 0.1519, acc: 99.1211, loss_bbox: 0.0731, loss_mask: 0.0740, loss: 0.3151
2022-03-27 19:11:50,027 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 1 day, 19:43:10, time: 0.163, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0036, loss_rpn_bbox: 0.0099, loss_cls: 0.0955, acc: 99.2676, loss_bbox: 0.0654, loss_mask: 0.0629, loss: 0.2372
2022-03-27 19:11:58,077 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 1 day, 17:40:41, time: 0.161, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0027, loss_rpn_bbox: 0.0104, loss_cls: 0.1108, acc: 99.3105, loss_bbox: 0.0605, loss_mask: 0.0533, loss: 0.2376
2022-03-27 19:12:07,415 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 1 day, 16:55:56, time: 0.187, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0025, loss_rpn_bbox: 0.0082, loss_cls: 0.0598, acc: 99.3789, loss_bbox: 0.0524, loss_mask: 0.0489, loss: 0.1719
2022-03-27 19:12:15,724 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 1 day, 15:51:54, time: 0.166, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0024, loss_rpn_bbox: 0.0082, loss_cls: 0.0244, acc: 99.3828, loss_bbox: 0.0507, loss_mask: 0.0438, loss: 0.1296
2022-03-27 19:12:25,029 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 1 day, 15:28:36, time: 0.186, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0021, loss_rpn_bbox: 0.0085, loss_cls: 0.0206, acc: 99.4219, loss_bbox: 0.0447, loss_mask: 0.0392, loss: 0.1151
2022-03-27 19:12:33,167 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 1 day, 14:42:08, time: 0.163, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0077, loss_cls: 0.0166, acc: 99.4746, loss_bbox: 0.0356, loss_mask: 0.0377, loss: 0.0995
2022-03-27 19:12:42,666 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 1 day, 14:33:22, time: 0.190, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0072, loss_cls: 0.0168, acc: 99.4941, loss_bbox: 0.0371, loss_mask: 0.0343, loss: 0.0970
2022-03-27 19:12:50,829 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 1 day, 13:59:46, time: 0.163, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0066, loss_cls: 0.0143, acc: 99.5488, loss_bbox: 0.0322, loss_mask: 0.0307, loss: 0.0853
2022-03-27 19:13:00,028 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 1 day, 13:50:04, time: 0.184, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0074, loss_cls: 0.0122, acc: 99.5742, loss_bbox: 0.0306, loss_mask: 0.0288, loss: 0.0807
2022-03-27 19:13:08,172 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 1 day, 13:24:07, time: 0.163, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0068, loss_cls: 0.0149, acc: 99.6016, loss_bbox: 0.0294, loss_mask: 0.0273, loss: 0.0797
2022-03-27 19:13:16,229 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 1 day, 13:00:10, time: 0.161, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0053, loss_cls: 0.0102, acc: 99.6934, loss_bbox: 0.0257, loss_mask: 0.0263, loss: 0.0690
2022-03-27 19:13:25,019 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 1 day, 12:50:00, time: 0.176, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0057, loss_cls: 0.0109, acc: 99.6641, loss_bbox: 0.0256, loss_mask: 0.0242, loss: 0.0676
2022-03-27 19:13:33,208 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 1 day, 12:32:34, time: 0.164, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0053, loss_cls: 0.0099, acc: 99.6777, loss_bbox: 0.0235, loss_mask: 0.0230, loss: 0.0630
2022-03-27 19:13:41,910 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 1 day, 12:23:56, time: 0.174, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0047, loss_cls: 0.0094, acc: 99.6973, loss_bbox: 0.0235, loss_mask: 0.0212, loss: 0.0596
2022-03-27 19:13:50,018 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 1 day, 12:08:43, time: 0.162, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0046, loss_cls: 0.0078, acc: 99.7793, loss_bbox: 0.0195, loss_mask: 0.0204, loss: 0.0531
2022-03-27 19:13:58,272 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 1 day, 11:56:52, time: 0.165, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0047, loss_cls: 0.0058, acc: 99.8281, loss_bbox: 0.0216, loss_mask: 0.0189, loss: 0.0519
2022-03-27 19:14:07,104 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 1 day, 11:52:29, time: 0.177, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0044, loss_cls: 0.0064, acc: 99.7988, loss_bbox: 0.0182, loss_mask: 0.0186, loss: 0.0484
2022-03-27 19:14:15,215 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 1 day, 11:40:41, time: 0.162, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0046, loss_cls: 0.0064, acc: 99.8105, loss_bbox: 0.0204, loss_mask: 0.0180, loss: 0.0502
2022-03-27 19:14:24,433 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 1 day, 11:41:27, time: 0.185, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0042, loss_cls: 0.0060, acc: 99.8203, loss_bbox: 0.0205, loss_mask: 0.0172, loss: 0.0486
2022-03-27 19:14:32,512 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 1 day, 11:30:50, time: 0.161, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0047, loss_cls: 0.0041, acc: 99.9082, loss_bbox: 0.0185, loss_mask: 0.0174, loss: 0.0456
2022-03-27 19:14:41,817 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 1 day, 11:32:40, time: 0.186, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0045, loss_cls: 0.0044, acc: 99.8730, loss_bbox: 0.0175, loss_mask: 0.0162, loss: 0.0433
2022-03-27 19:14:50,032 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 1 day, 11:24:26, time: 0.164, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0043, loss_cls: 0.0045, acc: 99.8848, loss_bbox: 0.0179, loss_mask: 0.0162, loss: 0.0437
2022-03-27 19:14:58,165 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 1 day, 11:16:06, time: 0.163, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0037, loss_cls: 0.0043, acc: 99.8809, loss_bbox: 0.0180, loss_mask: 0.0156, loss: 0.0425
2022-03-27 19:15:07,197 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 1 day, 11:15:51, time: 0.181, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0039, loss_cls: 0.0040, acc: 99.8809, loss_bbox: 0.0163, loss_mask: 0.0149, loss: 0.0398
2022-03-27 19:15:15,099 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 1 day, 11:06:30, time: 0.158, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0039, loss_cls: 0.0044, acc: 99.8633, loss_bbox: 0.0165, loss_mask: 0.0155, loss: 0.0410
2022-03-27 19:15:24,225 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 1 day, 11:07:22, time: 0.183, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0036, loss_cls: 0.0057, acc: 99.8184, loss_bbox: 0.0156, loss_mask: 0.0154, loss: 0.0409
2022-03-27 19:15:32,450 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 11:01:19, time: 0.164, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0040, loss_cls: 0.0060, acc: 99.8301, loss_bbox: 0.0151, loss_mask: 0.0156, loss: 0.0413
2022-03-27 19:15:41,072 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 10:58:37, time: 0.173, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0035, loss_cls: 0.0041, acc: 99.8711, loss_bbox: 0.0147, loss_mask: 0.0143, loss: 0.0372
2022-03-27 19:15:49,498 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 10:54:31, time: 0.168, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0038, loss_cls: 0.0036, acc: 99.9082, loss_bbox: 0.0139, loss_mask: 0.0134, loss: 0.0353
2022-03-27 19:15:57,653 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 10:48:57, time: 0.163, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0039, loss_cls: 0.0046, acc: 99.8613, loss_bbox: 0.0139, loss_mask: 0.0145, loss: 0.0375
2022-03-27 19:16:06,369 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 10:47:23, time: 0.174, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0040, loss_cls: 0.0047, acc: 99.8730, loss_bbox: 0.0148, loss_mask: 0.0139, loss: 0.0380
2022-03-27 19:16:14,645 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 10:42:57, time: 0.165, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0032, loss_cls: 0.0045, acc: 99.8652, loss_bbox: 0.0138, loss_mask: 0.0138, loss: 0.0359
2022-03-27 19:16:23,519 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 10:42:40, time: 0.178, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0038, loss_cls: 0.0045, acc: 99.8730, loss_bbox: 0.0135, loss_mask: 0.0136, loss: 0.0361
2022-03-27 19:16:31,767 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 10:38:28, time: 0.165, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0039, loss_cls: 0.0041, acc: 99.8887, loss_bbox: 0.0150, loss_mask: 0.0130, loss: 0.0366
2022-03-27 19:16:40,501 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 10:37:25, time: 0.175, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0031, loss_cls: 0.0033, acc: 99.8965, loss_bbox: 0.0139, loss_mask: 0.0124, loss: 0.0334
2022-03-27 19:16:49,105 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 10:35:39, time: 0.172, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0032, loss_cls: 0.0027, acc: 99.9238, loss_bbox: 0.0127, loss_mask: 0.0130, loss: 0.0321
2022-03-27 19:16:57,277 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 10:31:30, time: 0.163, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0035, loss_cls: 0.0041, acc: 99.8906, loss_bbox: 0.0131, loss_mask: 0.0129, loss: 0.0342
2022-03-27 19:17:06,109 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 10:31:12, time: 0.177, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0031, loss_cls: 0.0045, acc: 99.8457, loss_bbox: 0.0126, loss_mask: 0.0126, loss: 0.0335
2022-03-27 19:17:14,413 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 10:28:01, time: 0.166, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0032, loss_cls: 0.0038, acc: 99.9043, loss_bbox: 0.0123, loss_mask: 0.0125, loss: 0.0323
2022-03-27 19:17:23,536 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 10:29:22, time: 0.183, data_time: 0.001, memory: 3624, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0033, loss_cls: 0.0042, acc: 99.8633, loss_bbox: 0.0125, loss_mask: 0.0125, loss: 0.0330
2022-03-27 19:17:26,885 - mmdet - INFO - __benchmark_total_time(h):0.10923449695110321
2022-03-27 19:17:26,885 - mmdet - INFO - __benchmark_pure_training_time(h):0.1091263488928477
2022-03-27 19:17:26,886 - mmdet - INFO - __benchmark_avg_iter_time(s):0.17104560726291532
2022-03-27 19:17:26,886 - mmdet - INFO - __benchmark_mem_alloc(mb):3624
2022-03-27 19:17:26,886 - mmdet - INFO - __benchmark_mem_cached(mb):4592
[SH-IDC1-10-142-5-213][[43052,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 19:17:43,179 [32mINFO[0m: log service ip address is: 10.142.5.213:33118[0m
2022-03-27 19:17:43,180 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
2022-03-27 19:18:28,172 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 19:18:28,174 - mmdet - INFO - Distributed training: False
2022-03-27 19:18:28,992 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 19:18:29,143 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:18:29,144 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:18:29,591 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.46s)
creating index...
index created!
loading annotations into memory...
Done (t=0.36s)
creating index...
index created!
2022-03-27 19:18:43,214 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 19:18:43,214 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 19:18:43,214 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 19:18:43,215 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
2022-03-27 19:19:04,623 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 3 days, 11:30:34, time: 0.427, data_time: 0.089, memory: 3409, loss_rpn_cls: 0.4231, loss_rpn_bbox: 0.0387, loss_cls: 1.6844, acc: 87.9121, loss_bbox: 0.0427, loss_mask: 0.6257, loss: 2.8146
2022-03-27 19:19:13,817 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 2 days, 11:42:38, time: 0.184, data_time: 0.001, memory: 3549, loss_rpn_cls: 0.0528, loss_rpn_bbox: 0.0107, loss_cls: 0.6035, acc: 95.9004, loss_bbox: 0.2045, loss_mask: 0.2433, loss: 1.1147
2022-03-27 19:19:22,256 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 2 days, 2:47:52, time: 0.169, data_time: 0.001, memory: 3592, loss_rpn_cls: 0.0091, loss_rpn_bbox: 0.0125, loss_cls: 0.2482, acc: 98.7793, loss_bbox: 0.1066, loss_mask: 0.1031, loss: 0.4793
2022-03-27 19:19:30,955 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 1 day, 22:35:58, time: 0.174, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0045, loss_rpn_bbox: 0.0122, loss_cls: 0.2040, acc: 99.2832, loss_bbox: 0.0757, loss_mask: 0.0758, loss: 0.3722
2022-03-27 19:19:39,245 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 1 day, 19:44:56, time: 0.166, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0036, loss_rpn_bbox: 0.0115, loss_cls: 0.1208, acc: 99.2637, loss_bbox: 0.0640, loss_mask: 0.0621, loss: 0.2621
2022-03-27 19:19:47,450 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 1 day, 17:48:09, time: 0.164, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0030, loss_rpn_bbox: 0.0092, loss_cls: 0.0410, acc: 99.3672, loss_bbox: 0.0566, loss_mask: 0.0569, loss: 0.1666
2022-03-27 19:19:56,667 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 1 day, 16:58:30, time: 0.184, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0028, loss_rpn_bbox: 0.0090, loss_cls: 0.0267, acc: 99.2793, loss_bbox: 0.0520, loss_mask: 0.0522, loss: 0.1428
2022-03-27 19:20:05,183 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 1 day, 16:00:11, time: 0.170, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0022, loss_rpn_bbox: 0.0080, loss_cls: 0.0206, acc: 99.4043, loss_bbox: 0.0475, loss_mask: 0.0453, loss: 0.1235
2022-03-27 19:20:13,575 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 1 day, 15:12:05, time: 0.168, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0025, loss_rpn_bbox: 0.0084, loss_cls: 0.0195, acc: 99.4316, loss_bbox: 0.0419, loss_mask: 0.0437, loss: 0.1160
2022-03-27 19:20:22,065 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 1 day, 14:35:31, time: 0.170, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0075, loss_cls: 0.0122, acc: 99.6348, loss_bbox: 0.0393, loss_mask: 0.0392, loss: 0.1000
2022-03-27 19:20:30,738 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 1 day, 14:09:47, time: 0.174, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0074, loss_cls: 0.0140, acc: 99.5996, loss_bbox: 0.0397, loss_mask: 0.0364, loss: 0.0993
2022-03-27 19:20:38,762 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 1 day, 13:35:29, time: 0.160, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0069, loss_cls: 0.0119, acc: 99.6211, loss_bbox: 0.0351, loss_mask: 0.0312, loss: 0.0869
2022-03-27 19:20:46,998 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 1 day, 13:10:12, time: 0.165, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0068, loss_cls: 0.0112, acc: 99.6797, loss_bbox: 0.0337, loss_mask: 0.0286, loss: 0.0819
2022-03-27 19:20:55,386 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 1 day, 12:51:11, time: 0.168, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0053, loss_cls: 0.0103, acc: 99.6641, loss_bbox: 0.0282, loss_mask: 0.0277, loss: 0.0728
2022-03-27 19:21:03,280 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 1 day, 12:26:58, time: 0.158, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0051, loss_cls: 0.0099, acc: 99.7012, loss_bbox: 0.0243, loss_mask: 0.0250, loss: 0.0654
2022-03-27 19:21:11,743 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 1 day, 12:13:58, time: 0.169, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0055, loss_cls: 0.0084, acc: 99.7520, loss_bbox: 0.0252, loss_mask: 0.0237, loss: 0.0641
2022-03-27 19:21:19,918 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 1 day, 11:58:35, time: 0.164, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0052, loss_cls: 0.0078, acc: 99.7363, loss_bbox: 0.0234, loss_mask: 0.0234, loss: 0.0610
2022-03-27 19:21:27,648 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 1 day, 11:39:08, time: 0.155, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0055, loss_cls: 0.0083, acc: 99.7363, loss_bbox: 0.0241, loss_mask: 0.0227, loss: 0.0617
2022-03-27 19:21:36,304 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 1 day, 11:33:06, time: 0.173, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0052, loss_cls: 0.0069, acc: 99.7930, loss_bbox: 0.0235, loss_mask: 0.0228, loss: 0.0594
2022-03-27 19:21:44,775 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 1 day, 11:25:26, time: 0.169, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0049, loss_cls: 0.0060, acc: 99.8242, loss_bbox: 0.0215, loss_mask: 0.0214, loss: 0.0547
2022-03-27 19:21:53,378 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 1 day, 11:20:04, time: 0.172, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0052, loss_cls: 0.0058, acc: 99.8203, loss_bbox: 0.0211, loss_mask: 0.0201, loss: 0.0531
2022-03-27 19:22:02,051 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 1 day, 11:15:51, time: 0.173, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0052, loss_cls: 0.0052, acc: 99.8555, loss_bbox: 0.0216, loss_mask: 0.0193, loss: 0.0523
2022-03-27 19:22:10,477 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 1 day, 11:09:31, time: 0.169, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0043, loss_cls: 0.0070, acc: 99.7754, loss_bbox: 0.0186, loss_mask: 0.0193, loss: 0.0501
2022-03-27 19:22:18,450 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 1 day, 10:59:16, time: 0.159, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0043, loss_cls: 0.0053, acc: 99.8438, loss_bbox: 0.0179, loss_mask: 0.0181, loss: 0.0464
2022-03-27 19:22:26,903 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 1 day, 10:54:13, time: 0.169, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0042, loss_cls: 0.0064, acc: 99.7988, loss_bbox: 0.0182, loss_mask: 0.0180, loss: 0.0477
2022-03-27 19:22:35,730 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 1 day, 10:53:08, time: 0.177, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0036, loss_cls: 0.0049, acc: 99.8516, loss_bbox: 0.0162, loss_mask: 0.0171, loss: 0.0424
2022-03-27 19:22:44,200 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 1 day, 10:48:46, time: 0.169, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0038, loss_cls: 0.0035, acc: 99.8965, loss_bbox: 0.0152, loss_mask: 0.0177, loss: 0.0409
2022-03-27 19:22:52,752 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 1 day, 10:45:35, time: 0.171, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0042, loss_cls: 0.0055, acc: 99.8242, loss_bbox: 0.0164, loss_mask: 0.0174, loss: 0.0442
2022-03-27 19:23:01,258 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 1 day, 10:42:09, time: 0.170, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0038, loss_cls: 0.0048, acc: 99.8457, loss_bbox: 0.0147, loss_mask: 0.0163, loss: 0.0404
2022-03-27 19:23:09,261 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 1 day, 10:34:43, time: 0.159, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0040, loss_cls: 0.0047, acc: 99.8574, loss_bbox: 0.0158, loss_mask: 0.0160, loss: 0.0411
2022-03-27 19:23:17,736 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 10:31:57, time: 0.170, data_time: 0.002, memory: 3606, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0037, loss_cls: 0.0043, acc: 99.8691, loss_bbox: 0.0154, loss_mask: 0.0158, loss: 0.0398
2022-03-27 19:23:25,660 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 10:24:58, time: 0.158, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0033, loss_cls: 0.0051, acc: 99.8379, loss_bbox: 0.0144, loss_mask: 0.0153, loss: 0.0388
2022-03-27 19:23:33,958 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 10:21:05, time: 0.166, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0042, loss_cls: 0.0040, acc: 99.8633, loss_bbox: 0.0159, loss_mask: 0.0155, loss: 0.0402
2022-03-27 19:23:42,781 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 10:21:03, time: 0.176, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0035, loss_cls: 0.0040, acc: 99.8770, loss_bbox: 0.0155, loss_mask: 0.0150, loss: 0.0387
2022-03-27 19:23:51,318 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 10:19:04, time: 0.171, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0034, loss_cls: 0.0047, acc: 99.8379, loss_bbox: 0.0145, loss_mask: 0.0142, loss: 0.0375
2022-03-27 19:23:58,974 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 10:11:30, time: 0.153, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0041, loss_cls: 0.0051, acc: 99.8203, loss_bbox: 0.0161, loss_mask: 0.0149, loss: 0.0410
2022-03-27 19:24:06,983 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 10:06:31, time: 0.160, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0041, loss_cls: 0.0052, acc: 99.8262, loss_bbox: 0.0166, loss_mask: 0.0146, loss: 0.0412
2022-03-27 19:24:15,238 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 10:03:20, time: 0.165, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0033, loss_cls: 0.0045, acc: 99.8828, loss_bbox: 0.0157, loss_mask: 0.0150, loss: 0.0392
2022-03-27 19:24:23,163 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 9:58:19, time: 0.159, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0033, loss_cls: 0.0034, acc: 99.8887, loss_bbox: 0.0141, loss_mask: 0.0142, loss: 0.0357
2022-03-27 19:24:31,783 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 9:57:40, time: 0.173, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0036, loss_cls: 0.0049, acc: 99.8496, loss_bbox: 0.0146, loss_mask: 0.0142, loss: 0.0379
2022-03-27 19:24:39,835 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 9:53:42, time: 0.161, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0034, loss_cls: 0.0049, acc: 99.8613, loss_bbox: 0.0154, loss_mask: 0.0144, loss: 0.0388
2022-03-27 19:24:47,829 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 9:49:40, time: 0.160, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0032, loss_cls: 0.0046, acc: 99.8535, loss_bbox: 0.0143, loss_mask: 0.0139, loss: 0.0366
2022-03-27 19:24:56,293 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 9:48:20, time: 0.169, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0028, loss_cls: 0.0046, acc: 99.8535, loss_bbox: 0.0127, loss_mask: 0.0131, loss: 0.0337
2022-03-27 19:25:04,429 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 9:45:19, time: 0.163, data_time: 0.001, memory: 3606, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0035, loss_cls: 0.0062, acc: 99.7891, loss_bbox: 0.0146, loss_mask: 0.0150, loss: 0.0398
2022-03-27 19:25:07,684 - mmdet - INFO - __benchmark_total_time(h):0.10690380619631873
2022-03-27 19:25:07,685 - mmdet - INFO - __benchmark_pure_training_time(h):0.10679709388150109
2022-03-27 19:25:07,685 - mmdet - INFO - __benchmark_avg_iter_time(s):0.1659960339476655
2022-03-27 19:25:07,686 - mmdet - INFO - __benchmark_mem_alloc(mb):3606
2022-03-27 19:25:07,686 - mmdet - INFO - __benchmark_mem_cached(mb):4624
[SH-IDC1-10-142-5-213][[48730,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 19:25:26,131 [32mINFO[0m: log service ip address is: 10.142.5.213:16776[0m
2022-03-27 19:25:26,132 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
2022-03-27 19:26:10,652 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 19:26:10,655 - mmdet - INFO - Distributed training: False
2022-03-27 19:26:11,583 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 19:26:11,684 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:26:11,685 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:26:12,064 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.85s)
creating index...
index created!
loading annotations into memory...
Done (t=0.47s)
creating index...
index created!
2022-03-27 19:26:25,869 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 19:26:25,872 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 19:26:25,872 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 19:26:25,872 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
2022-03-27 19:26:46,980 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 3 days, 10:20:33, time: 0.421, data_time: 0.090, memory: 3504, loss_rpn_cls: 0.3652, loss_rpn_bbox: 0.0233, loss_cls: 1.2720, acc: 87.7109, loss_bbox: 0.1046, loss_mask: 0.6111, loss: 2.3762
2022-03-27 19:26:55,830 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 2 days, 10:27:57, time: 0.177, data_time: 0.001, memory: 3599, loss_rpn_cls: 0.0445, loss_rpn_bbox: 0.0089, loss_cls: 0.4817, acc: 95.3691, loss_bbox: 0.2273, loss_mask: 0.2759, loss: 1.0383
2022-03-27 19:27:04,103 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 2 days, 1:45:01, time: 0.165, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0149, loss_rpn_bbox: 0.0068, loss_cls: 0.0856, acc: 98.1777, loss_bbox: 0.1463, loss_mask: 0.1462, loss: 0.3999
2022-03-27 19:27:12,867 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 1 day, 21:52:29, time: 0.175, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0045, loss_rpn_bbox: 0.0074, loss_cls: 0.0450, acc: 99.0234, loss_bbox: 0.0801, loss_mask: 0.0771, loss: 0.2141
2022-03-27 19:27:21,117 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 1 day, 19:08:22, time: 0.165, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0028, loss_rpn_bbox: 0.0079, loss_cls: 0.0446, acc: 99.1328, loss_bbox: 0.0628, loss_mask: 0.0613, loss: 0.1794
2022-03-27 19:27:29,118 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 1 day, 17:09:40, time: 0.160, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0028, loss_rpn_bbox: 0.0058, loss_cls: 0.0520, acc: 99.2539, loss_bbox: 0.0553, loss_mask: 0.0558, loss: 0.1717
2022-03-27 19:27:38,106 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 1 day, 16:17:45, time: 0.180, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0066, loss_cls: 0.0558, acc: 99.2715, loss_bbox: 0.0525, loss_mask: 0.0492, loss: 0.1661
2022-03-27 19:27:46,270 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 1 day, 15:14:23, time: 0.163, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0022, loss_rpn_bbox: 0.0055, loss_cls: 0.0584, acc: 99.3730, loss_bbox: 0.0478, loss_mask: 0.0451, loss: 0.1590
2022-03-27 19:27:55,738 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 1 day, 14:59:20, time: 0.189, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0052, loss_cls: 0.0512, acc: 99.5645, loss_bbox: 0.0453, loss_mask: 0.0400, loss: 0.1432
2022-03-27 19:28:04,065 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 1 day, 14:20:15, time: 0.166, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0055, loss_cls: 0.0496, acc: 99.4941, loss_bbox: 0.0429, loss_mask: 0.0359, loss: 0.1354
2022-03-27 19:28:12,792 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 1 day, 13:57:02, time: 0.175, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0047, loss_cls: 0.0474, acc: 99.5547, loss_bbox: 0.0414, loss_mask: 0.0350, loss: 0.1302
2022-03-27 19:28:20,967 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 1 day, 13:26:38, time: 0.163, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0042, loss_cls: 0.0339, acc: 99.6348, loss_bbox: 0.0360, loss_mask: 0.0316, loss: 0.1072
2022-03-27 19:28:29,022 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 1 day, 12:59:00, time: 0.161, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0037, loss_cls: 0.0215, acc: 99.6992, loss_bbox: 0.0343, loss_mask: 0.0291, loss: 0.0897
2022-03-27 19:28:38,298 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 1 day, 12:55:35, time: 0.186, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0037, loss_cls: 0.0144, acc: 99.7148, loss_bbox: 0.0324, loss_mask: 0.0271, loss: 0.0790
2022-03-27 19:28:46,414 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 1 day, 12:34:22, time: 0.162, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0034, loss_cls: 0.0134, acc: 99.6641, loss_bbox: 0.0311, loss_mask: 0.0267, loss: 0.0762
2022-03-27 19:28:55,109 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 1 day, 12:24:28, time: 0.174, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0031, loss_cls: 0.0121, acc: 99.7090, loss_bbox: 0.0288, loss_mask: 0.0249, loss: 0.0699
2022-03-27 19:29:03,780 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 1 day, 12:15:13, time: 0.173, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0028, loss_cls: 0.0122, acc: 99.6387, loss_bbox: 0.0265, loss_mask: 0.0244, loss: 0.0669
2022-03-27 19:29:12,750 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 1 day, 12:11:02, time: 0.180, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0030, loss_cls: 0.0108, acc: 99.7207, loss_bbox: 0.0246, loss_mask: 0.0229, loss: 0.0622
2022-03-27 19:29:21,284 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 1 day, 12:01:44, time: 0.171, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0031, loss_cls: 0.0110, acc: 99.6836, loss_bbox: 0.0248, loss_mask: 0.0235, loss: 0.0634
2022-03-27 19:29:29,267 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 1 day, 11:47:03, time: 0.160, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0030, loss_cls: 0.0086, acc: 99.7383, loss_bbox: 0.0230, loss_mask: 0.0216, loss: 0.0568
2022-03-27 19:29:37,955 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 1 day, 11:41:32, time: 0.174, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0025, loss_cls: 0.0085, acc: 99.7441, loss_bbox: 0.0222, loss_mask: 0.0207, loss: 0.0549
2022-03-27 19:29:46,094 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 1 day, 11:30:37, time: 0.163, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0028, loss_cls: 0.0085, acc: 99.7285, loss_bbox: 0.0217, loss_mask: 0.0201, loss: 0.0539
2022-03-27 19:29:55,008 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 1 day, 11:28:39, time: 0.178, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0030, loss_cls: 0.0068, acc: 99.8223, loss_bbox: 0.0207, loss_mask: 0.0199, loss: 0.0511
2022-03-27 19:30:03,274 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 1 day, 11:20:24, time: 0.165, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0029, loss_cls: 0.0060, acc: 99.8320, loss_bbox: 0.0191, loss_mask: 0.0191, loss: 0.0477
2022-03-27 19:30:12,047 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 1 day, 11:17:38, time: 0.176, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0028, loss_cls: 0.0054, acc: 99.8359, loss_bbox: 0.0188, loss_mask: 0.0181, loss: 0.0459
2022-03-27 19:30:20,573 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 1 day, 11:12:46, time: 0.170, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0029, loss_cls: 0.0061, acc: 99.8320, loss_bbox: 0.0194, loss_mask: 0.0174, loss: 0.0465
2022-03-27 19:30:28,770 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 1 day, 11:05:28, time: 0.164, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0025, loss_cls: 0.0034, acc: 99.9082, loss_bbox: 0.0185, loss_mask: 0.0158, loss: 0.0409
2022-03-27 19:30:37,596 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 1 day, 11:03:55, time: 0.177, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0023, loss_cls: 0.0066, acc: 99.8086, loss_bbox: 0.0187, loss_mask: 0.0160, loss: 0.0440
2022-03-27 19:30:45,699 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 1 day, 10:56:31, time: 0.162, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0024, loss_cls: 0.0056, acc: 99.8555, loss_bbox: 0.0193, loss_mask: 0.0161, loss: 0.0438
2022-03-27 19:30:54,543 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 1 day, 10:55:34, time: 0.177, data_time: 0.002, memory: 3614, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0025, loss_cls: 0.0050, acc: 99.8496, loss_bbox: 0.0176, loss_mask: 0.0158, loss: 0.0414
2022-03-27 19:31:02,720 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 10:49:33, time: 0.164, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0022, loss_cls: 0.0057, acc: 99.8652, loss_bbox: 0.0166, loss_mask: 0.0149, loss: 0.0399
2022-03-27 19:31:11,697 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 10:49:45, time: 0.180, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0025, loss_cls: 0.0047, acc: 99.8633, loss_bbox: 0.0183, loss_mask: 0.0154, loss: 0.0413
2022-03-27 19:31:19,593 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 10:42:18, time: 0.158, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0034, acc: 99.8926, loss_bbox: 0.0151, loss_mask: 0.0141, loss: 0.0351
2022-03-27 19:31:27,832 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 10:37:31, time: 0.165, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0021, loss_cls: 0.0022, acc: 99.9492, loss_bbox: 0.0151, loss_mask: 0.0140, loss: 0.0338
2022-03-27 19:31:36,383 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 10:35:13, time: 0.171, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0024, loss_cls: 0.0026, acc: 99.9414, loss_bbox: 0.0165, loss_mask: 0.0138, loss: 0.0357
2022-03-27 19:31:45,642 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 10:37:35, time: 0.185, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0041, acc: 99.8750, loss_bbox: 0.0155, loss_mask: 0.0134, loss: 0.0354
2022-03-27 19:31:53,954 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 10:33:49, time: 0.166, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0021, loss_cls: 0.0033, acc: 99.9160, loss_bbox: 0.0147, loss_mask: 0.0131, loss: 0.0336
2022-03-27 19:32:03,053 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 10:35:07, time: 0.182, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0022, loss_cls: 0.0028, acc: 99.9238, loss_bbox: 0.0164, loss_mask: 0.0139, loss: 0.0357
2022-03-27 19:32:11,664 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 10:33:23, time: 0.172, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0021, loss_cls: 0.0024, acc: 99.9414, loss_bbox: 0.0142, loss_mask: 0.0129, loss: 0.0319
2022-03-27 19:32:19,611 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 10:27:54, time: 0.159, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0029, acc: 99.9492, loss_bbox: 0.0143, loss_mask: 0.0121, loss: 0.0317
2022-03-27 19:32:28,323 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 10:27:00, time: 0.174, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0030, acc: 99.9082, loss_bbox: 0.0149, loss_mask: 0.0120, loss: 0.0324
2022-03-27 19:32:36,874 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 10:25:15, time: 0.171, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0030, acc: 99.9258, loss_bbox: 0.0140, loss_mask: 0.0121, loss: 0.0312
2022-03-27 19:32:45,659 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 10:24:49, time: 0.176, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0021, loss_cls: 0.0021, acc: 99.9453, loss_bbox: 0.0135, loss_mask: 0.0125, loss: 0.0305
2022-03-27 19:32:54,172 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 10:23:01, time: 0.170, data_time: 0.001, memory: 3614, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0029, acc: 99.9238, loss_bbox: 0.0139, loss_mask: 0.0114, loss: 0.0303
2022-03-27 19:32:57,513 - mmdet - INFO - __benchmark_total_time(h):0.10892546037832895
2022-03-27 19:32:57,513 - mmdet - INFO - __benchmark_pure_training_time(h):0.10878888719611697
2022-03-27 19:32:57,514 - mmdet - INFO - __benchmark_avg_iter_time(s):0.1708941204802735
2022-03-27 19:32:57,514 - mmdet - INFO - __benchmark_mem_alloc(mb):3614
2022-03-27 19:32:57,514 - mmdet - INFO - __benchmark_mem_cached(mb):4624
[SH-IDC1-10-142-5-213][[23511,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 19:33:13,736 [32mINFO[0m: log service ip address is: 10.142.5.213:58677[0m
2022-03-27 19:33:13,737 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
2022-03-27 19:33:58,836 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 19:33:58,838 - mmdet - INFO - Distributed training: False
2022-03-27 19:33:59,665 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 19:33:59,821 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:33:59,823 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:34:00,285 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.81s)
creating index...
index created!
loading annotations into memory...
Done (t=0.35s)
creating index...
index created!
2022-03-27 19:34:14,220 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 19:34:14,220 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 19:34:14,221 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 19:34:14,221 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
2022-03-27 19:34:34,976 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 3 days, 8:55:58, time: 0.414, data_time: 0.089, memory: 3496, loss_rpn_cls: 0.4493, loss_rpn_bbox: 0.0263, loss_cls: 1.0923, acc: 88.6348, loss_bbox: 0.0890, loss_mask: 0.6443, loss: 2.3012
2022-03-27 19:34:44,213 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 2 days, 10:31:44, time: 0.185, data_time: 0.001, memory: 3604, loss_rpn_cls: 0.0406, loss_rpn_bbox: 0.0096, loss_cls: 0.3545, acc: 95.8613, loss_bbox: 0.2273, loss_mask: 0.2535, loss: 0.8855
2022-03-27 19:34:52,597 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 2 days, 1:55:45, time: 0.168, data_time: 0.001, memory: 3604, loss_rpn_cls: 0.0077, loss_rpn_bbox: 0.0070, loss_cls: 0.0597, acc: 98.7871, loss_bbox: 0.1075, loss_mask: 0.1087, loss: 0.2907
2022-03-27 19:35:01,687 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 1 day, 22:19:50, time: 0.182, data_time: 0.001, memory: 3621, loss_rpn_cls: 0.0035, loss_rpn_bbox: 0.0079, loss_cls: 0.0471, acc: 99.0430, loss_bbox: 0.0783, loss_mask: 0.0793, loss: 0.2160
2022-03-27 19:35:09,859 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 1 day, 19:26:54, time: 0.163, data_time: 0.001, memory: 3625, loss_rpn_cls: 0.0024, loss_rpn_bbox: 0.0075, loss_cls: 0.0463, acc: 99.1875, loss_bbox: 0.0680, loss_mask: 0.0660, loss: 0.1902
2022-03-27 19:35:18,292 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 1 day, 17:41:33, time: 0.169, data_time: 0.001, memory: 3625, loss_rpn_cls: 0.0026, loss_rpn_bbox: 0.0071, loss_cls: 0.0465, acc: 99.4102, loss_bbox: 0.0557, loss_mask: 0.0570, loss: 0.1688
2022-03-27 19:35:27,399 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 1 day, 16:49:12, time: 0.182, data_time: 0.001, memory: 3625, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0061, loss_cls: 0.0496, acc: 99.5801, loss_bbox: 0.0539, loss_mask: 0.0524, loss: 0.1640
2022-03-27 19:35:35,754 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 1 day, 15:47:29, time: 0.167, data_time: 0.001, memory: 3625, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0056, loss_cls: 0.0943, acc: 99.5117, loss_bbox: 0.0512, loss_mask: 0.0452, loss: 0.1980
2022-03-27 19:35:45,035 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 1 day, 15:23:53, time: 0.186, data_time: 0.001, memory: 3628, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0055, loss_cls: 0.0591, acc: 99.4688, loss_bbox: 0.0494, loss_mask: 0.0426, loss: 0.1584
2022-03-27 19:35:53,497 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 1 day, 14:45:28, time: 0.169, data_time: 0.001, memory: 3628, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0048, loss_cls: 0.0359, acc: 99.5820, loss_bbox: 0.0445, loss_mask: 0.0380, loss: 0.1247
2022-03-27 19:36:02,537 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 1 day, 14:26:39, time: 0.181, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0045, loss_cls: 0.0577, acc: 99.5391, loss_bbox: 0.0421, loss_mask: 0.0348, loss: 0.1407
2022-03-27 19:36:10,868 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 1 day, 13:56:54, time: 0.167, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0041, loss_cls: 0.0270, acc: 99.5156, loss_bbox: 0.0384, loss_mask: 0.0327, loss: 0.1034
2022-03-27 19:36:19,046 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 1 day, 13:29:04, time: 0.164, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0044, loss_cls: 0.0201, acc: 99.5742, loss_bbox: 0.0376, loss_mask: 0.0307, loss: 0.0942
2022-03-27 19:36:28,268 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 1 day, 13:22:41, time: 0.185, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0035, loss_cls: 0.0151, acc: 99.7031, loss_bbox: 0.0315, loss_mask: 0.0274, loss: 0.0786
2022-03-27 19:36:36,603 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 1 day, 13:03:03, time: 0.167, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0035, loss_cls: 0.0135, acc: 99.6191, loss_bbox: 0.0311, loss_mask: 0.0257, loss: 0.0748
2022-03-27 19:36:45,005 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 1 day, 12:47:02, time: 0.168, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0032, loss_cls: 0.0112, acc: 99.6699, loss_bbox: 0.0265, loss_mask: 0.0236, loss: 0.0654
2022-03-27 19:36:53,432 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 1 day, 12:33:07, time: 0.168, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0038, loss_cls: 0.0116, acc: 99.6758, loss_bbox: 0.0275, loss_mask: 0.0237, loss: 0.0676
2022-03-27 19:37:01,957 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 1 day, 12:22:07, time: 0.171, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0034, loss_cls: 0.0096, acc: 99.7305, loss_bbox: 0.0253, loss_mask: 0.0219, loss: 0.0612
2022-03-27 19:37:09,938 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 1 day, 12:05:31, time: 0.160, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0031, loss_cls: 0.0080, acc: 99.7598, loss_bbox: 0.0242, loss_mask: 0.0209, loss: 0.0572
2022-03-27 19:37:18,241 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 1 day, 11:54:15, time: 0.166, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0032, loss_cls: 0.0100, acc: 99.6816, loss_bbox: 0.0242, loss_mask: 0.0203, loss: 0.0583
2022-03-27 19:37:26,861 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 1 day, 11:47:42, time: 0.173, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0034, loss_cls: 0.0095, acc: 99.7090, loss_bbox: 0.0223, loss_mask: 0.0199, loss: 0.0559
2022-03-27 19:37:35,226 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 1 day, 11:38:54, time: 0.167, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0029, loss_cls: 0.0070, acc: 99.7910, loss_bbox: 0.0218, loss_mask: 0.0191, loss: 0.0515
2022-03-27 19:37:44,127 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 1 day, 11:36:25, time: 0.178, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0026, loss_cls: 0.0050, acc: 99.8535, loss_bbox: 0.0209, loss_mask: 0.0185, loss: 0.0477
2022-03-27 19:37:52,321 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 1 day, 11:27:08, time: 0.164, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0028, loss_cls: 0.0045, acc: 99.8672, loss_bbox: 0.0201, loss_mask: 0.0172, loss: 0.0452
2022-03-27 19:38:00,191 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 1 day, 11:15:40, time: 0.158, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0026, loss_cls: 0.0063, acc: 99.7988, loss_bbox: 0.0192, loss_mask: 0.0170, loss: 0.0458
2022-03-27 19:38:09,389 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 1 day, 11:16:57, time: 0.184, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0027, loss_cls: 0.0059, acc: 99.8184, loss_bbox: 0.0181, loss_mask: 0.0166, loss: 0.0439
2022-03-27 19:38:17,420 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 1 day, 11:07:59, time: 0.161, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0026, loss_cls: 0.0062, acc: 99.8086, loss_bbox: 0.0185, loss_mask: 0.0165, loss: 0.0444
2022-03-27 19:38:26,035 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 1 day, 11:04:37, time: 0.172, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0022, loss_cls: 0.0044, acc: 99.8867, loss_bbox: 0.0175, loss_mask: 0.0162, loss: 0.0408
2022-03-27 19:38:34,611 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 1 day, 11:01:05, time: 0.171, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0024, loss_cls: 0.0050, acc: 99.8398, loss_bbox: 0.0161, loss_mask: 0.0154, loss: 0.0393
2022-03-27 19:38:43,445 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 1 day, 10:59:49, time: 0.177, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0023, loss_cls: 0.0043, acc: 99.8809, loss_bbox: 0.0164, loss_mask: 0.0147, loss: 0.0382
2022-03-27 19:38:51,675 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 10:54:04, time: 0.165, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0026, loss_cls: 0.0045, acc: 99.8457, loss_bbox: 0.0171, loss_mask: 0.0154, loss: 0.0401
2022-03-27 19:38:59,754 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 10:47:34, time: 0.162, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0022, loss_cls: 0.0044, acc: 99.8711, loss_bbox: 0.0162, loss_mask: 0.0143, loss: 0.0375
2022-03-27 19:39:08,775 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 10:48:08, time: 0.180, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0024, loss_cls: 0.0038, acc: 99.8906, loss_bbox: 0.0160, loss_mask: 0.0150, loss: 0.0378
2022-03-27 19:39:16,744 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 10:41:22, time: 0.159, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0021, loss_cls: 0.0057, acc: 99.8145, loss_bbox: 0.0149, loss_mask: 0.0142, loss: 0.0373
2022-03-27 19:39:25,625 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 10:41:09, time: 0.178, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0046, acc: 99.8457, loss_bbox: 0.0153, loss_mask: 0.0142, loss: 0.0368
2022-03-27 19:39:33,274 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 10:32:51, time: 0.153, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0024, loss_cls: 0.0032, acc: 99.9180, loss_bbox: 0.0156, loss_mask: 0.0142, loss: 0.0359
2022-03-27 19:39:42,188 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 10:33:06, time: 0.178, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0025, loss_cls: 0.0033, acc: 99.9082, loss_bbox: 0.0147, loss_mask: 0.0140, loss: 0.0351
2022-03-27 19:39:50,131 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 10:27:16, time: 0.159, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0023, loss_cls: 0.0051, acc: 99.8496, loss_bbox: 0.0149, loss_mask: 0.0142, loss: 0.0370
2022-03-27 19:39:58,147 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 10:22:10, time: 0.160, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0022, loss_cls: 0.0039, acc: 99.8809, loss_bbox: 0.0141, loss_mask: 0.0130, loss: 0.0336
2022-03-27 19:40:07,354 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 10:24:19, time: 0.184, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0021, loss_cls: 0.0036, acc: 99.9082, loss_bbox: 0.0137, loss_mask: 0.0126, loss: 0.0324
2022-03-27 19:40:15,583 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 10:20:44, time: 0.164, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0031, acc: 99.9043, loss_bbox: 0.0136, loss_mask: 0.0133, loss: 0.0324
2022-03-27 19:40:24,558 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 10:21:31, time: 0.180, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0023, loss_cls: 0.0041, acc: 99.8867, loss_bbox: 0.0141, loss_mask: 0.0131, loss: 0.0339
2022-03-27 19:40:32,751 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 10:17:58, time: 0.164, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0026, acc: 99.9199, loss_bbox: 0.0142, loss_mask: 0.0128, loss: 0.0321
2022-03-27 19:40:40,762 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 10:13:38, time: 0.160, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0019, loss_cls: 0.0029, acc: 99.9004, loss_bbox: 0.0127, loss_mask: 0.0123, loss: 0.0302
2022-03-27 19:40:45,126 - mmdet - INFO - __benchmark_total_time(h):0.10868747267458174
2022-03-27 19:40:45,126 - mmdet - INFO - __benchmark_pure_training_time(h):0.10858463486035665
2022-03-27 19:40:45,127 - mmdet - INFO - __benchmark_avg_iter_time(s):0.16904023429611464
2022-03-27 19:40:45,127 - mmdet - INFO - __benchmark_mem_alloc(mb):3631
2022-03-27 19:40:45,127 - mmdet - INFO - __benchmark_mem_cached(mb):4624
[SH-IDC1-10-142-5-213][[31292,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 19:41:01,915 [32mINFO[0m: log service ip address is: 10.142.5.213:19878[0m
2022-03-27 19:41:01,916 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
2022-03-27 19:41:47,130 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 19:41:47,132 - mmdet - INFO - Distributed training: False
2022-03-27 19:41:48,022 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 19:41:48,102 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:41:48,103 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:41:48,528 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.82s)
creating index...
index created!
loading annotations into memory...
Done (t=0.48s)
creating index...
index created!
2022-03-27 19:42:02,755 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 19:42:02,756 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 19:42:02,757 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 19:42:02,757 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
2022-03-27 19:42:23,158 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 3 days, 7:34:25, time: 0.407, data_time: 0.089, memory: 3444, loss_rpn_cls: 0.4425, loss_rpn_bbox: 0.0404, loss_cls: 1.4127, acc: 88.2988, loss_bbox: 0.0763, loss_mask: 0.6080, loss: 2.5799
2022-03-27 19:42:31,845 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 2 days, 8:46:21, time: 0.174, data_time: 0.001, memory: 3583, loss_rpn_cls: 0.0436, loss_rpn_bbox: 0.0128, loss_cls: 0.5412, acc: 95.6973, loss_bbox: 0.2176, loss_mask: 0.2315, loss: 1.0465
2022-03-27 19:42:39,837 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 2 days, 0:15:08, time: 0.160, data_time: 0.001, memory: 3594, loss_rpn_cls: 0.0097, loss_rpn_bbox: 0.0117, loss_cls: 0.1928, acc: 98.7480, loss_bbox: 0.1031, loss_mask: 0.0933, loss: 0.4106
2022-03-27 19:42:47,899 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 1 day, 20:03:31, time: 0.161, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0041, loss_rpn_bbox: 0.0116, loss_cls: 0.1496, acc: 99.1758, loss_bbox: 0.0730, loss_mask: 0.0682, loss: 0.3065
2022-03-27 19:42:56,577 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 1 day, 18:01:34, time: 0.174, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0029, loss_rpn_bbox: 0.0096, loss_cls: 0.1793, acc: 99.2051, loss_bbox: 0.0596, loss_mask: 0.0594, loss: 0.3108
2022-03-27 19:43:04,687 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 1 day, 16:18:04, time: 0.162, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0028, loss_rpn_bbox: 0.0093, loss_cls: 0.0933, acc: 99.1758, loss_bbox: 0.0588, loss_mask: 0.0521, loss: 0.2163
2022-03-27 19:43:13,016 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 1 day, 15:11:29, time: 0.167, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0027, loss_rpn_bbox: 0.0099, loss_cls: 0.0250, acc: 99.4004, loss_bbox: 0.0518, loss_mask: 0.0487, loss: 0.1380
2022-03-27 19:43:20,947 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 1 day, 14:09:45, time: 0.159, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0026, loss_rpn_bbox: 0.0096, loss_cls: 0.0228, acc: 99.3789, loss_bbox: 0.0491, loss_mask: 0.0444, loss: 0.1285
2022-03-27 19:43:29,011 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 1 day, 13:25:02, time: 0.161, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0022, loss_rpn_bbox: 0.0084, loss_cls: 0.0176, acc: 99.4375, loss_bbox: 0.0439, loss_mask: 0.0402, loss: 0.1123
2022-03-27 19:43:38,065 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 1 day, 13:12:43, time: 0.181, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0085, loss_cls: 0.0142, acc: 99.5957, loss_bbox: 0.0407, loss_mask: 0.0381, loss: 0.1036
2022-03-27 19:43:46,301 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 1 day, 12:44:52, time: 0.165, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0067, loss_cls: 0.0134, acc: 99.6016, loss_bbox: 0.0352, loss_mask: 0.0326, loss: 0.0897
2022-03-27 19:43:55,128 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 1 day, 12:33:32, time: 0.177, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0069, loss_cls: 0.0133, acc: 99.6133, loss_bbox: 0.0351, loss_mask: 0.0299, loss: 0.0869
2022-03-27 19:44:03,112 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 1 day, 12:08:29, time: 0.160, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0065, loss_cls: 0.0084, acc: 99.7266, loss_bbox: 0.0316, loss_mask: 0.0265, loss: 0.0742
2022-03-27 19:44:11,142 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 1 day, 11:47:53, time: 0.161, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0065, loss_cls: 0.0074, acc: 99.7715, loss_bbox: 0.0309, loss_mask: 0.0251, loss: 0.0713
2022-03-27 19:44:20,107 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 1 day, 11:44:31, time: 0.179, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0061, loss_cls: 0.0067, acc: 99.8320, loss_bbox: 0.0285, loss_mask: 0.0237, loss: 0.0662
2022-03-27 19:44:28,345 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 1 day, 11:30:57, time: 0.165, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0057, loss_cls: 0.0094, acc: 99.6992, loss_bbox: 0.0273, loss_mask: 0.0226, loss: 0.0661
2022-03-27 19:44:37,677 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 1 day, 11:34:02, time: 0.187, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0054, loss_cls: 0.0069, acc: 99.7988, loss_bbox: 0.0240, loss_mask: 0.0221, loss: 0.0596
2022-03-27 19:44:45,684 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 1 day, 11:19:32, time: 0.160, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0052, loss_cls: 0.0066, acc: 99.8164, loss_bbox: 0.0244, loss_mask: 0.0208, loss: 0.0581
2022-03-27 19:44:54,455 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 1 day, 11:16:00, time: 0.175, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0045, loss_cls: 0.0085, acc: 99.7324, loss_bbox: 0.0256, loss_mask: 0.0217, loss: 0.0614
2022-03-27 19:45:02,649 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 1 day, 11:05:58, time: 0.164, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0049, loss_cls: 0.0065, acc: 99.8027, loss_bbox: 0.0211, loss_mask: 0.0194, loss: 0.0530
2022-03-27 19:45:10,840 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 1 day, 10:56:54, time: 0.164, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0046, loss_cls: 0.0080, acc: 99.7539, loss_bbox: 0.0229, loss_mask: 0.0184, loss: 0.0550
2022-03-27 19:45:19,808 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 1 day, 10:56:54, time: 0.179, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0046, loss_cls: 0.0059, acc: 99.8164, loss_bbox: 0.0219, loss_mask: 0.0191, loss: 0.0523
2022-03-27 19:45:27,955 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 1 day, 10:48:28, time: 0.163, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0037, loss_cls: 0.0044, acc: 99.8574, loss_bbox: 0.0203, loss_mask: 0.0172, loss: 0.0465
2022-03-27 19:45:36,724 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 1 day, 10:46:54, time: 0.175, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0044, loss_cls: 0.0046, acc: 99.8750, loss_bbox: 0.0203, loss_mask: 0.0170, loss: 0.0470
2022-03-27 19:45:45,399 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 1 day, 10:44:29, time: 0.173, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0041, loss_cls: 0.0048, acc: 99.8340, loss_bbox: 0.0184, loss_mask: 0.0173, loss: 0.0453
2022-03-27 19:45:53,955 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 1 day, 10:41:15, time: 0.171, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0040, loss_cls: 0.0033, acc: 99.9121, loss_bbox: 0.0175, loss_mask: 0.0154, loss: 0.0411
2022-03-27 19:46:02,735 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 1 day, 10:40:09, time: 0.176, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0041, loss_cls: 0.0036, acc: 99.9141, loss_bbox: 0.0180, loss_mask: 0.0149, loss: 0.0415
2022-03-27 19:46:10,769 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 1 day, 10:32:51, time: 0.161, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0042, loss_cls: 0.0043, acc: 99.8750, loss_bbox: 0.0184, loss_mask: 0.0159, loss: 0.0436
2022-03-27 19:46:19,090 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 1 day, 10:28:23, time: 0.166, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0041, loss_cls: 0.0041, acc: 99.9082, loss_bbox: 0.0205, loss_mask: 0.0161, loss: 0.0455
2022-03-27 19:46:27,224 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 1 day, 10:22:41, time: 0.162, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0044, loss_cls: 0.0030, acc: 99.9219, loss_bbox: 0.0185, loss_mask: 0.0151, loss: 0.0416
2022-03-27 19:46:35,588 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 10:19:12, time: 0.167, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0031, loss_cls: 0.0030, acc: 99.8965, loss_bbox: 0.0146, loss_mask: 0.0148, loss: 0.0362
2022-03-27 19:46:44,167 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 10:17:26, time: 0.172, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0035, loss_cls: 0.0039, acc: 99.8809, loss_bbox: 0.0165, loss_mask: 0.0142, loss: 0.0388
2022-03-27 19:46:52,993 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 10:17:32, time: 0.177, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0033, loss_cls: 0.0054, acc: 99.8516, loss_bbox: 0.0159, loss_mask: 0.0137, loss: 0.0388
2022-03-27 19:47:01,073 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 10:12:28, time: 0.162, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0030, loss_cls: 0.0030, acc: 99.9238, loss_bbox: 0.0150, loss_mask: 0.0136, loss: 0.0351
2022-03-27 19:47:09,761 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 10:11:42, time: 0.174, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0035, loss_cls: 0.0042, acc: 99.8789, loss_bbox: 0.0146, loss_mask: 0.0142, loss: 0.0371
2022-03-27 19:47:18,492 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 10:11:21, time: 0.175, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0028, loss_cls: 0.0055, acc: 99.8516, loss_bbox: 0.0144, loss_mask: 0.0132, loss: 0.0366
2022-03-27 19:47:26,995 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 10:09:29, time: 0.170, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0034, loss_cls: 0.0038, acc: 99.8945, loss_bbox: 0.0154, loss_mask: 0.0135, loss: 0.0366
2022-03-27 19:47:35,939 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 10:10:30, time: 0.179, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0035, loss_cls: 0.0048, acc: 99.8652, loss_bbox: 0.0149, loss_mask: 0.0131, loss: 0.0369
2022-03-27 19:47:44,351 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 10:08:11, time: 0.168, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0036, loss_cls: 0.0037, acc: 99.8926, loss_bbox: 0.0142, loss_mask: 0.0134, loss: 0.0354
2022-03-27 19:47:52,649 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 10:05:23, time: 0.166, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0033, loss_cls: 0.0036, acc: 99.8984, loss_bbox: 0.0137, loss_mask: 0.0129, loss: 0.0340
2022-03-27 19:48:00,817 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 10:01:57, time: 0.163, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0032, loss_cls: 0.0036, acc: 99.8828, loss_bbox: 0.0142, loss_mask: 0.0122, loss: 0.0338
2022-03-27 19:48:09,897 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 10:03:41, time: 0.181, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0033, loss_cls: 0.0042, acc: 99.8906, loss_bbox: 0.0143, loss_mask: 0.0125, loss: 0.0349
2022-03-27 19:48:17,984 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 10:00:01, time: 0.162, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0033, loss_cls: 0.0036, acc: 99.8770, loss_bbox: 0.0139, loss_mask: 0.0125, loss: 0.0339
2022-03-27 19:48:26,957 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 10:01:12, time: 0.179, data_time: 0.001, memory: 3635, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0029, loss_cls: 0.0041, acc: 99.8828, loss_bbox: 0.0132, loss_mask: 0.0129, loss: 0.0335
2022-03-27 19:48:30,376 - mmdet - INFO - __benchmark_total_time(h):0.10781287928422292
2022-03-27 19:48:30,376 - mmdet - INFO - __benchmark_pure_training_time(h):0.10767185939682855
2022-03-27 19:48:30,377 - mmdet - INFO - __benchmark_avg_iter_time(s):0.17024417904826192
2022-03-27 19:48:30,377 - mmdet - INFO - __benchmark_mem_alloc(mb):3635
2022-03-27 19:48:30,377 - mmdet - INFO - __benchmark_mem_cached(mb):4592
[SH-IDC1-10-142-5-213][[6071,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 19:48:46,479 [32mINFO[0m: log service ip address is: 10.142.5.213:52540[0m
2022-03-27 19:48:46,479 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
2022-03-27 19:49:31,454 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 19:49:31,455 - mmdet - INFO - Distributed training: False
2022-03-27 19:49:32,371 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 19:49:32,530 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:49:32,532 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:49:33,075 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=11.64s)
creating index...
index created!
loading annotations into memory...
Done (t=0.35s)
creating index...
index created!
2022-03-27 19:49:47,876 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 19:49:47,877 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 19:49:47,878 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 19:49:47,878 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
2022-03-27 19:50:08,656 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 3 days, 9:00:12, time: 0.414, data_time: 0.089, memory: 3387, loss_rpn_cls: 0.4161, loss_rpn_bbox: 0.0374, loss_cls: 1.3268, acc: 88.0488, loss_bbox: 0.0471, loss_mask: 0.5472, loss: 2.3746
2022-03-27 19:50:18,028 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 2 days, 10:49:09, time: 0.188, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0440, loss_rpn_bbox: 0.0119, loss_cls: 0.4711, acc: 96.3223, loss_bbox: 0.1956, loss_mask: 0.2305, loss: 0.9530
2022-03-27 19:50:26,269 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 2 days, 1:56:40, time: 0.165, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0093, loss_rpn_bbox: 0.0129, loss_cls: 0.2048, acc: 98.6738, loss_bbox: 0.1097, loss_mask: 0.0961, loss: 0.4328
2022-03-27 19:50:34,964 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 1 day, 21:57:11, time: 0.174, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0041, loss_rpn_bbox: 0.0120, loss_cls: 0.1968, acc: 99.0215, loss_bbox: 0.0746, loss_mask: 0.0732, loss: 0.3608
2022-03-27 19:50:42,971 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 1 day, 19:00:45, time: 0.160, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0032, loss_rpn_bbox: 0.0103, loss_cls: 0.1936, acc: 99.1211, loss_bbox: 0.0553, loss_mask: 0.0588, loss: 0.3212
2022-03-27 19:50:50,928 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 1 day, 17:01:36, time: 0.159, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0028, loss_rpn_bbox: 0.0091, loss_cls: 0.1220, acc: 99.3281, loss_bbox: 0.0584, loss_mask: 0.0558, loss: 0.2480
2022-03-27 19:50:59,741 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 1 day, 16:04:54, time: 0.176, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0024, loss_rpn_bbox: 0.0085, loss_cls: 0.0279, acc: 99.3633, loss_bbox: 0.0549, loss_mask: 0.0481, loss: 0.1418
2022-03-27 19:51:07,863 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 1 day, 15:01:56, time: 0.162, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0026, loss_rpn_bbox: 0.0100, loss_cls: 0.0216, acc: 99.4336, loss_bbox: 0.0481, loss_mask: 0.0442, loss: 0.1265
2022-03-27 19:51:17,211 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 1 day, 14:45:08, time: 0.187, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0023, loss_rpn_bbox: 0.0078, loss_cls: 0.0174, acc: 99.4746, loss_bbox: 0.0457, loss_mask: 0.0390, loss: 0.1122
2022-03-27 19:51:25,251 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 1 day, 14:00:46, time: 0.161, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0087, loss_cls: 0.0168, acc: 99.4785, loss_bbox: 0.0447, loss_mask: 0.0376, loss: 0.1099
2022-03-27 19:51:33,747 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 1 day, 13:34:25, time: 0.170, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0022, loss_rpn_bbox: 0.0088, loss_cls: 0.0156, acc: 99.5449, loss_bbox: 0.0400, loss_mask: 0.0342, loss: 0.1008
2022-03-27 19:51:41,789 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 1 day, 13:03:26, time: 0.161, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0060, loss_cls: 0.0123, acc: 99.6094, loss_bbox: 0.0349, loss_mask: 0.0314, loss: 0.0864
2022-03-27 19:51:49,850 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 1 day, 12:37:29, time: 0.161, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0055, loss_cls: 0.0112, acc: 99.6562, loss_bbox: 0.0342, loss_mask: 0.0285, loss: 0.0808
2022-03-27 19:51:58,924 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 1 day, 12:32:12, time: 0.181, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0059, loss_cls: 0.0101, acc: 99.6797, loss_bbox: 0.0313, loss_mask: 0.0262, loss: 0.0748
2022-03-27 19:52:06,916 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 1 day, 12:10:43, time: 0.160, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0053, loss_cls: 0.0104, acc: 99.6953, loss_bbox: 0.0290, loss_mask: 0.0247, loss: 0.0707
2022-03-27 19:52:16,227 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 1 day, 12:11:18, time: 0.186, data_time: 0.001, memory: 3603, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0056, loss_cls: 0.0093, acc: 99.7090, loss_bbox: 0.0294, loss_mask: 0.0235, loss: 0.0691
2022-03-27 19:52:24,313 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 1 day, 11:54:45, time: 0.162, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0048, loss_cls: 0.0104, acc: 99.6660, loss_bbox: 0.0269, loss_mask: 0.0235, loss: 0.0667
2022-03-27 19:52:33,085 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 1 day, 11:49:09, time: 0.176, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0043, loss_cls: 0.0096, acc: 99.7168, loss_bbox: 0.0268, loss_mask: 0.0229, loss: 0.0647
2022-03-27 19:52:40,828 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 1 day, 11:31:19, time: 0.155, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0042, loss_cls: 0.0079, acc: 99.7461, loss_bbox: 0.0229, loss_mask: 0.0211, loss: 0.0569
2022-03-27 19:52:48,634 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 1 day, 11:15:58, time: 0.156, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0043, loss_cls: 0.0066, acc: 99.8008, loss_bbox: 0.0227, loss_mask: 0.0198, loss: 0.0543
2022-03-27 19:52:57,764 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 1 day, 11:16:55, time: 0.183, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0048, loss_cls: 0.0067, acc: 99.8027, loss_bbox: 0.0239, loss_mask: 0.0193, loss: 0.0555
2022-03-27 19:53:05,633 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 1 day, 11:04:18, time: 0.157, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0052, loss_cls: 0.0058, acc: 99.8379, loss_bbox: 0.0245, loss_mask: 0.0190, loss: 0.0555
2022-03-27 19:53:14,553 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 1 day, 11:03:29, time: 0.178, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0045, loss_cls: 0.0041, acc: 99.8750, loss_bbox: 0.0225, loss_mask: 0.0182, loss: 0.0501
2022-03-27 19:53:22,450 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 1 day, 10:52:42, time: 0.158, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0046, loss_cls: 0.0048, acc: 99.8613, loss_bbox: 0.0223, loss_mask: 0.0178, loss: 0.0503
2022-03-27 19:53:30,306 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 1 day, 10:42:26, time: 0.157, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0040, loss_cls: 0.0052, acc: 99.8477, loss_bbox: 0.0204, loss_mask: 0.0180, loss: 0.0485
2022-03-27 19:53:38,787 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 1 day, 10:38:33, time: 0.170, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0034, loss_cls: 0.0036, acc: 99.8828, loss_bbox: 0.0201, loss_mask: 0.0174, loss: 0.0451
2022-03-27 19:53:46,959 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 1 day, 10:32:14, time: 0.163, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0045, loss_cls: 0.0055, acc: 99.8301, loss_bbox: 0.0212, loss_mask: 0.0177, loss: 0.0497
2022-03-27 19:53:56,039 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 1 day, 10:34:01, time: 0.182, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0043, loss_cls: 0.0046, acc: 99.8691, loss_bbox: 0.0193, loss_mask: 0.0170, loss: 0.0459
2022-03-27 19:54:03,928 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 1 day, 10:26:00, time: 0.158, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0044, loss_cls: 0.0037, acc: 99.8730, loss_bbox: 0.0190, loss_mask: 0.0174, loss: 0.0454
2022-03-27 19:54:11,853 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 1 day, 10:18:50, time: 0.159, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0034, loss_cls: 0.0052, acc: 99.8516, loss_bbox: 0.0183, loss_mask: 0.0163, loss: 0.0440
2022-03-27 19:54:20,440 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 10:17:07, time: 0.172, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0036, loss_cls: 0.0048, acc: 99.8496, loss_bbox: 0.0189, loss_mask: 0.0156, loss: 0.0436
2022-03-27 19:54:28,743 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 10:13:21, time: 0.166, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0037, loss_cls: 0.0048, acc: 99.8438, loss_bbox: 0.0197, loss_mask: 0.0155, loss: 0.0444
2022-03-27 19:54:37,671 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 10:14:20, time: 0.179, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0034, loss_cls: 0.0029, acc: 99.9121, loss_bbox: 0.0161, loss_mask: 0.0146, loss: 0.0376
2022-03-27 19:54:45,633 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 10:08:30, time: 0.159, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0036, loss_cls: 0.0044, acc: 99.8730, loss_bbox: 0.0171, loss_mask: 0.0147, loss: 0.0403
2022-03-27 19:54:54,409 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 10:08:33, time: 0.176, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0034, loss_cls: 0.0030, acc: 99.9199, loss_bbox: 0.0188, loss_mask: 0.0139, loss: 0.0398
2022-03-27 19:55:02,034 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 10:01:02, time: 0.152, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0034, loss_cls: 0.0033, acc: 99.8926, loss_bbox: 0.0191, loss_mask: 0.0142, loss: 0.0405
2022-03-27 19:55:10,044 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 9:56:19, time: 0.160, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0036, loss_cls: 0.0042, acc: 99.8887, loss_bbox: 0.0186, loss_mask: 0.0145, loss: 0.0415
2022-03-27 19:55:18,362 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 9:53:50, time: 0.167, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0033, loss_cls: 0.0036, acc: 99.9082, loss_bbox: 0.0169, loss_mask: 0.0139, loss: 0.0383
2022-03-27 19:55:26,871 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 9:52:32, time: 0.170, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0032, loss_cls: 0.0029, acc: 99.9141, loss_bbox: 0.0149, loss_mask: 0.0128, loss: 0.0344
2022-03-27 19:55:35,546 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 9:52:20, time: 0.174, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0036, loss_cls: 0.0034, acc: 99.8906, loss_bbox: 0.0179, loss_mask: 0.0133, loss: 0.0388
2022-03-27 19:55:43,918 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 9:50:22, time: 0.167, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0031, loss_cls: 0.0031, acc: 99.9023, loss_bbox: 0.0159, loss_mask: 0.0133, loss: 0.0361
2022-03-27 19:55:51,759 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 9:45:34, time: 0.157, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0027, loss_cls: 0.0029, acc: 99.9297, loss_bbox: 0.0151, loss_mask: 0.0125, loss: 0.0337
2022-03-27 19:56:00,454 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 9:45:33, time: 0.174, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0030, loss_cls: 0.0029, acc: 99.9219, loss_bbox: 0.0148, loss_mask: 0.0120, loss: 0.0332
2022-03-27 19:56:08,423 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 9:41:43, time: 0.159, data_time: 0.001, memory: 3611, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0032, loss_cls: 0.0026, acc: 99.9355, loss_bbox: 0.0145, loss_mask: 0.0123, loss: 0.0330
2022-03-27 19:56:11,852 - mmdet - INFO - __benchmark_total_time(h):0.10676366647084554
2022-03-27 19:56:11,853 - mmdet - INFO - __benchmark_pure_training_time(h):0.10665950854619344
2022-03-27 19:56:11,853 - mmdet - INFO - __benchmark_avg_iter_time(s):0.16597239001766667
2022-03-27 19:56:11,853 - mmdet - INFO - __benchmark_mem_alloc(mb):3611
2022-03-27 19:56:11,853 - mmdet - INFO - __benchmark_mem_cached(mb):4624
[SH-IDC1-10-142-5-213][[14109,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 19:56:28,598 [32mINFO[0m: log service ip address is: 10.142.5.213:35606[0m
2022-03-27 19:56:28,599 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
2022-03-27 19:57:14,774 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 19:57:14,777 - mmdet - INFO - Distributed training: False
2022-03-27 19:57:15,674 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 19:57:15,770 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:57:15,770 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 19:57:16,298 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.67s)
creating index...
index created!
loading annotations into memory...
Done (t=0.39s)
creating index...
index created!
2022-03-27 19:57:29,857 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 19:57:29,858 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 19:57:29,858 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 19:57:29,859 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
2022-03-27 19:57:50,400 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 3 days, 8:07:52, time: 0.410, data_time: 0.090, memory: 3553, loss_rpn_cls: 0.4096, loss_rpn_bbox: 0.0220, loss_cls: 1.2895, acc: 86.6230, loss_bbox: 0.1260, loss_mask: 0.6414, loss: 2.4886
2022-03-27 19:57:59,218 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 2 days, 9:17:33, time: 0.176, data_time: 0.001, memory: 3597, loss_rpn_cls: 0.0420, loss_rpn_bbox: 0.0092, loss_cls: 0.3681, acc: 95.3633, loss_bbox: 0.2429, loss_mask: 0.2600, loss: 0.9222
2022-03-27 19:58:07,604 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 2 days, 1:06:54, time: 0.168, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0091, loss_rpn_bbox: 0.0065, loss_cls: 0.0718, acc: 98.6289, loss_bbox: 0.1112, loss_mask: 0.1050, loss: 0.3036
2022-03-27 19:58:16,575 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 1 day, 21:36:04, time: 0.179, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0036, loss_rpn_bbox: 0.0083, loss_cls: 0.0582, acc: 98.7871, loss_bbox: 0.0802, loss_mask: 0.0756, loss: 0.2259
2022-03-27 19:58:25,242 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 1 day, 19:14:54, time: 0.173, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0026, loss_rpn_bbox: 0.0065, loss_cls: 0.0599, acc: 99.1953, loss_bbox: 0.0654, loss_mask: 0.0653, loss: 0.1997
2022-03-27 19:58:34,276 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 1 day, 17:55:26, time: 0.181, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0022, loss_rpn_bbox: 0.0057, loss_cls: 0.0747, acc: 99.3477, loss_bbox: 0.0559, loss_mask: 0.0533, loss: 0.1919
2022-03-27 19:58:42,470 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 1 day, 16:30:19, time: 0.164, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0059, loss_cls: 0.0904, acc: 99.3223, loss_bbox: 0.0521, loss_mask: 0.0484, loss: 0.1984
2022-03-27 19:58:50,794 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 1 day, 15:30:00, time: 0.166, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0025, loss_rpn_bbox: 0.0057, loss_cls: 0.0914, acc: 99.4707, loss_bbox: 0.0499, loss_mask: 0.0443, loss: 0.1937
2022-03-27 19:58:59,648 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 1 day, 14:57:26, time: 0.177, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0058, loss_cls: 0.0569, acc: 99.5332, loss_bbox: 0.0446, loss_mask: 0.0428, loss: 0.1519
2022-03-27 19:59:08,257 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 1 day, 14:25:05, time: 0.172, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0050, loss_cls: 0.0361, acc: 99.5820, loss_bbox: 0.0421, loss_mask: 0.0393, loss: 0.1244
2022-03-27 19:59:17,135 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 1 day, 14:04:32, time: 0.178, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0046, loss_cls: 0.0312, acc: 99.4648, loss_bbox: 0.0407, loss_mask: 0.0379, loss: 0.1159
2022-03-27 19:59:25,678 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 1 day, 13:40:49, time: 0.171, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0041, loss_cls: 0.0197, acc: 99.4883, loss_bbox: 0.0371, loss_mask: 0.0333, loss: 0.0955
2022-03-27 19:59:34,629 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 1 day, 13:28:09, time: 0.179, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0040, loss_cls: 0.0171, acc: 99.5098, loss_bbox: 0.0336, loss_mask: 0.0310, loss: 0.0871
2022-03-27 19:59:42,673 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 1 day, 13:02:02, time: 0.161, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0038, loss_cls: 0.0113, acc: 99.6855, loss_bbox: 0.0311, loss_mask: 0.0283, loss: 0.0757
2022-03-27 19:59:50,730 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 1 day, 12:39:31, time: 0.161, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0035, loss_cls: 0.0125, acc: 99.6738, loss_bbox: 0.0307, loss_mask: 0.0267, loss: 0.0743
2022-03-27 19:59:59,564 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 1 day, 12:31:15, time: 0.177, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0034, loss_cls: 0.0109, acc: 99.6191, loss_bbox: 0.0278, loss_mask: 0.0252, loss: 0.0682
2022-03-27 20:00:07,666 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 1 day, 12:13:50, time: 0.162, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0033, loss_cls: 0.0096, acc: 99.7305, loss_bbox: 0.0251, loss_mask: 0.0243, loss: 0.0633
2022-03-27 20:00:16,784 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 1 day, 12:11:39, time: 0.182, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0031, loss_cls: 0.0089, acc: 99.7285, loss_bbox: 0.0233, loss_mask: 0.0228, loss: 0.0589
2022-03-27 20:00:25,097 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 1 day, 11:59:37, time: 0.166, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0027, loss_cls: 0.0092, acc: 99.7344, loss_bbox: 0.0231, loss_mask: 0.0222, loss: 0.0580
2022-03-27 20:00:33,881 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 1 day, 11:54:25, time: 0.176, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0031, loss_cls: 0.0084, acc: 99.7461, loss_bbox: 0.0250, loss_mask: 0.0210, loss: 0.0582
2022-03-27 20:00:41,989 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 1 day, 11:42:03, time: 0.162, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0030, loss_cls: 0.0093, acc: 99.7168, loss_bbox: 0.0220, loss_mask: 0.0207, loss: 0.0556
2022-03-27 20:00:50,242 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 1 day, 11:32:19, time: 0.165, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0027, loss_cls: 0.0100, acc: 99.6719, loss_bbox: 0.0214, loss_mask: 0.0194, loss: 0.0543
2022-03-27 20:00:59,236 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 1 day, 11:31:09, time: 0.180, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0031, loss_cls: 0.0091, acc: 99.6934, loss_bbox: 0.0208, loss_mask: 0.0191, loss: 0.0526
2022-03-27 20:01:07,698 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 1 day, 11:24:38, time: 0.169, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0028, loss_cls: 0.0084, acc: 99.7441, loss_bbox: 0.0212, loss_mask: 0.0182, loss: 0.0514
2022-03-27 20:01:16,520 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 1 day, 11:22:09, time: 0.177, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0026, loss_cls: 0.0066, acc: 99.8125, loss_bbox: 0.0199, loss_mask: 0.0174, loss: 0.0473
2022-03-27 20:01:24,600 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 1 day, 11:13:08, time: 0.162, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0025, loss_cls: 0.0053, acc: 99.8418, loss_bbox: 0.0187, loss_mask: 0.0160, loss: 0.0431
2022-03-27 20:01:32,518 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 1 day, 11:03:23, time: 0.158, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0026, loss_cls: 0.0062, acc: 99.7930, loss_bbox: 0.0189, loss_mask: 0.0166, loss: 0.0449
2022-03-27 20:01:41,810 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 1 day, 11:05:48, time: 0.186, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0025, loss_cls: 0.0051, acc: 99.8301, loss_bbox: 0.0181, loss_mask: 0.0168, loss: 0.0431
2022-03-27 20:01:49,832 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 1 day, 10:57:42, time: 0.160, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0024, loss_cls: 0.0059, acc: 99.8105, loss_bbox: 0.0177, loss_mask: 0.0161, loss: 0.0427
2022-03-27 20:01:58,809 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 1 day, 10:57:44, time: 0.180, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0022, loss_cls: 0.0069, acc: 99.7891, loss_bbox: 0.0183, loss_mask: 0.0153, loss: 0.0432
2022-03-27 20:02:07,226 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 10:53:25, time: 0.168, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0022, loss_cls: 0.0059, acc: 99.8164, loss_bbox: 0.0161, loss_mask: 0.0146, loss: 0.0393
2022-03-27 20:02:16,397 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 10:54:57, time: 0.184, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0025, loss_cls: 0.0072, acc: 99.7578, loss_bbox: 0.0182, loss_mask: 0.0154, loss: 0.0438
2022-03-27 20:02:24,432 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 10:48:15, time: 0.161, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0023, loss_cls: 0.0070, acc: 99.7793, loss_bbox: 0.0176, loss_mask: 0.0154, loss: 0.0428
2022-03-27 20:02:32,473 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 10:42:04, time: 0.161, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0024, loss_cls: 0.0075, acc: 99.7402, loss_bbox: 0.0179, loss_mask: 0.0158, loss: 0.0441
2022-03-27 20:02:40,985 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 10:39:19, time: 0.170, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0026, loss_cls: 0.0061, acc: 99.7930, loss_bbox: 0.0172, loss_mask: 0.0151, loss: 0.0414
2022-03-27 20:02:49,482 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 10:36:37, time: 0.170, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0024, loss_cls: 0.0064, acc: 99.7852, loss_bbox: 0.0164, loss_mask: 0.0143, loss: 0.0399
2022-03-27 20:02:58,034 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 10:34:24, time: 0.171, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0023, loss_cls: 0.0045, acc: 99.8555, loss_bbox: 0.0171, loss_mask: 0.0147, loss: 0.0391
2022-03-27 20:03:06,172 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 10:29:46, time: 0.163, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0022, loss_cls: 0.0050, acc: 99.8555, loss_bbox: 0.0159, loss_mask: 0.0138, loss: 0.0373
2022-03-27 20:03:15,187 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 10:30:37, time: 0.180, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0021, loss_cls: 0.0041, acc: 99.8613, loss_bbox: 0.0161, loss_mask: 0.0131, loss: 0.0358
2022-03-27 20:03:23,319 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 10:25:56, time: 0.162, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0023, loss_cls: 0.0052, acc: 99.7852, loss_bbox: 0.0163, loss_mask: 0.0132, loss: 0.0374
2022-03-27 20:03:31,512 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 10:22:27, time: 0.165, data_time: 0.002, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0046, acc: 99.8555, loss_bbox: 0.0146, loss_mask: 0.0131, loss: 0.0346
2022-03-27 20:03:40,309 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 10:22:09, time: 0.176, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0022, loss_cls: 0.0049, acc: 99.8105, loss_bbox: 0.0152, loss_mask: 0.0135, loss: 0.0362
2022-03-27 20:03:47,979 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 10:15:46, time: 0.153, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0018, loss_cls: 0.0047, acc: 99.8828, loss_bbox: 0.0133, loss_mask: 0.0127, loss: 0.0328
2022-03-27 20:03:57,035 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 10:17:01, time: 0.181, data_time: 0.001, memory: 3631, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0021, loss_cls: 0.0041, acc: 99.8789, loss_bbox: 0.0140, loss_mask: 0.0125, loss: 0.0330
2022-03-27 20:04:00,449 - mmdet - INFO - __benchmark_total_time(h):0.10861281229390038
2022-03-27 20:04:00,449 - mmdet - INFO - __benchmark_pure_training_time(h):0.10849725233183967
2022-03-27 20:04:00,450 - mmdet - INFO - __benchmark_avg_iter_time(s):0.16937115856936644
2022-03-27 20:04:00,450 - mmdet - INFO - __benchmark_mem_alloc(mb):3631
2022-03-27 20:04:00,450 - mmdet - INFO - __benchmark_mem_cached(mb):4592
[SH-IDC1-10-142-5-213][[53114,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 20:04:17,124 [32mINFO[0m: log service ip address is: 10.142.5.213:40787[0m
2022-03-27 20:04:17,125 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
2022-03-27 20:05:01,294 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 20:05:01,297 - mmdet - INFO - Distributed training: False
2022-03-27 20:05:02,184 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 20:05:02,267 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 20:05:02,267 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 20:05:02,643 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.69s)
creating index...
index created!
loading annotations into memory...
Done (t=0.36s)
creating index...
index created!
2022-03-27 20:05:16,377 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 20:05:16,379 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 20:05:16,379 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 20:05:16,379 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
2022-03-27 20:05:37,503 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 3 days, 10:22:52, time: 0.422, data_time: 0.089, memory: 3408, loss_rpn_cls: 0.4011, loss_rpn_bbox: 0.0366, loss_cls: 1.4385, acc: 89.4551, loss_bbox: 0.0588, loss_mask: 0.6544, loss: 2.5894
2022-03-27 20:05:46,036 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 2 days, 9:52:29, time: 0.171, data_time: 0.002, memory: 3609, loss_rpn_cls: 0.0465, loss_rpn_bbox: 0.0121, loss_cls: 0.7447, acc: 95.8945, loss_bbox: 0.2146, loss_mask: 0.2505, loss: 1.2684
2022-03-27 20:05:54,132 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 2 days, 1:07:23, time: 0.162, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0098, loss_rpn_bbox: 0.0108, loss_cls: 0.2574, acc: 98.7969, loss_bbox: 0.1075, loss_mask: 0.1023, loss: 0.4878
2022-03-27 20:06:01,729 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 1 day, 20:15:52, time: 0.152, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0044, loss_rpn_bbox: 0.0103, loss_cls: 0.2258, acc: 99.1738, loss_bbox: 0.0741, loss_mask: 0.0733, loss: 0.3880
2022-03-27 20:06:10,713 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 1 day, 18:25:46, time: 0.180, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0039, loss_rpn_bbox: 0.0120, loss_cls: 0.1076, acc: 99.2930, loss_bbox: 0.0651, loss_mask: 0.0614, loss: 0.2499
2022-03-27 20:06:18,699 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 1 day, 16:33:08, time: 0.160, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0029, loss_rpn_bbox: 0.0095, loss_cls: 0.0353, acc: 99.3555, loss_bbox: 0.0531, loss_mask: 0.0545, loss: 0.1553
2022-03-27 20:06:27,377 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 1 day, 15:36:08, time: 0.174, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0026, loss_rpn_bbox: 0.0089, loss_cls: 0.0235, acc: 99.3125, loss_bbox: 0.0501, loss_mask: 0.0492, loss: 0.1343
2022-03-27 20:06:35,391 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 1 day, 14:33:46, time: 0.160, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0028, loss_rpn_bbox: 0.0084, loss_cls: 0.0258, acc: 99.2734, loss_bbox: 0.0508, loss_mask: 0.0462, loss: 0.1340
2022-03-27 20:06:43,114 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 1 day, 13:37:40, time: 0.154, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0025, loss_rpn_bbox: 0.0087, loss_cls: 0.0183, acc: 99.4082, loss_bbox: 0.0442, loss_mask: 0.0402, loss: 0.1138
2022-03-27 20:06:51,989 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 1 day, 13:19:39, time: 0.177, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0074, loss_cls: 0.0161, acc: 99.5020, loss_bbox: 0.0436, loss_mask: 0.0375, loss: 0.1066
2022-03-27 20:06:59,815 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 1 day, 12:42:39, time: 0.157, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0073, loss_cls: 0.0167, acc: 99.4531, loss_bbox: 0.0394, loss_mask: 0.0349, loss: 0.1003
2022-03-27 20:07:08,298 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 1 day, 12:24:35, time: 0.170, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0071, loss_cls: 0.0140, acc: 99.5742, loss_bbox: 0.0390, loss_mask: 0.0317, loss: 0.0937
2022-03-27 20:07:16,471 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 1 day, 12:03:44, time: 0.163, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0070, loss_cls: 0.0139, acc: 99.6016, loss_bbox: 0.0378, loss_mask: 0.0295, loss: 0.0899
2022-03-27 20:07:25,434 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 1 day, 11:59:02, time: 0.179, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0057, loss_cls: 0.0140, acc: 99.5859, loss_bbox: 0.0338, loss_mask: 0.0277, loss: 0.0826
2022-03-27 20:07:33,190 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 1 day, 11:36:06, time: 0.155, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0059, loss_cls: 0.0108, acc: 99.6191, loss_bbox: 0.0328, loss_mask: 0.0270, loss: 0.0779
2022-03-27 20:07:40,793 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 1 day, 11:13:43, time: 0.152, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0058, loss_cls: 0.0122, acc: 99.6328, loss_bbox: 0.0304, loss_mask: 0.0257, loss: 0.0752
2022-03-27 20:07:49,426 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 1 day, 11:08:13, time: 0.173, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0057, loss_cls: 0.0122, acc: 99.6289, loss_bbox: 0.0296, loss_mask: 0.0252, loss: 0.0742
2022-03-27 20:07:57,077 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 1 day, 10:50:29, time: 0.153, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0051, loss_cls: 0.0087, acc: 99.7285, loss_bbox: 0.0255, loss_mask: 0.0225, loss: 0.0627
2022-03-27 20:08:06,291 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 1 day, 10:53:57, time: 0.184, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0048, loss_cls: 0.0098, acc: 99.6719, loss_bbox: 0.0267, loss_mask: 0.0215, loss: 0.0638
2022-03-27 20:08:13,873 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 1 day, 10:37:51, time: 0.152, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0044, loss_cls: 0.0083, acc: 99.7422, loss_bbox: 0.0228, loss_mask: 0.0204, loss: 0.0568
2022-03-27 20:08:21,396 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 1 day, 10:22:41, time: 0.150, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0040, loss_cls: 0.0086, acc: 99.7578, loss_bbox: 0.0216, loss_mask: 0.0201, loss: 0.0551
2022-03-27 20:08:30,095 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 1 day, 10:21:20, time: 0.174, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0048, loss_cls: 0.0086, acc: 99.7363, loss_bbox: 0.0226, loss_mask: 0.0196, loss: 0.0564
2022-03-27 20:08:37,989 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 1 day, 10:11:55, time: 0.158, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0044, loss_cls: 0.0063, acc: 99.7930, loss_bbox: 0.0216, loss_mask: 0.0181, loss: 0.0513
2022-03-27 20:08:47,312 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 1 day, 10:17:16, time: 0.187, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0041, loss_cls: 0.0064, acc: 99.7969, loss_bbox: 0.0206, loss_mask: 0.0182, loss: 0.0502
2022-03-27 20:08:55,096 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 1 day, 10:07:43, time: 0.156, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0045, loss_cls: 0.0053, acc: 99.8398, loss_bbox: 0.0188, loss_mask: 0.0179, loss: 0.0472
2022-03-27 20:09:02,926 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 1 day, 9:59:20, time: 0.157, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0038, loss_cls: 0.0041, acc: 99.8633, loss_bbox: 0.0182, loss_mask: 0.0166, loss: 0.0435
2022-03-27 20:09:11,468 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 1 day, 9:57:42, time: 0.171, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0036, loss_cls: 0.0050, acc: 99.8496, loss_bbox: 0.0182, loss_mask: 0.0173, loss: 0.0449
2022-03-27 20:09:19,564 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 1 day, 9:52:26, time: 0.162, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0040, loss_cls: 0.0046, acc: 99.8652, loss_bbox: 0.0182, loss_mask: 0.0171, loss: 0.0445
2022-03-27 20:09:28,585 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 1 day, 9:55:03, time: 0.180, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0039, loss_cls: 0.0037, acc: 99.8887, loss_bbox: 0.0174, loss_mask: 0.0161, loss: 0.0419
2022-03-27 20:09:36,480 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 1 day, 9:48:38, time: 0.158, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0038, loss_cls: 0.0038, acc: 99.8770, loss_bbox: 0.0170, loss_mask: 0.0156, loss: 0.0409
2022-03-27 20:09:45,531 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 9:51:25, time: 0.181, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0037, loss_cls: 0.0055, acc: 99.8301, loss_bbox: 0.0173, loss_mask: 0.0156, loss: 0.0428
2022-03-27 20:09:53,489 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 9:46:00, time: 0.159, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0035, loss_cls: 0.0051, acc: 99.8164, loss_bbox: 0.0168, loss_mask: 0.0151, loss: 0.0412
2022-03-27 20:10:01,417 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 9:40:37, time: 0.158, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0036, loss_cls: 0.0037, acc: 99.8711, loss_bbox: 0.0171, loss_mask: 0.0146, loss: 0.0395
2022-03-27 20:10:10,213 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 9:41:36, time: 0.176, data_time: 0.002, memory: 3609, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0031, loss_cls: 0.0046, acc: 99.8809, loss_bbox: 0.0151, loss_mask: 0.0139, loss: 0.0373
2022-03-27 20:10:18,280 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 9:37:36, time: 0.161, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0038, loss_cls: 0.0044, acc: 99.8398, loss_bbox: 0.0155, loss_mask: 0.0139, loss: 0.0382
2022-03-27 20:10:26,584 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 9:35:25, time: 0.166, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0031, loss_cls: 0.0045, acc: 99.8594, loss_bbox: 0.0145, loss_mask: 0.0137, loss: 0.0364
2022-03-27 20:10:34,752 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 9:32:23, time: 0.163, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0034, loss_cls: 0.0038, acc: 99.8672, loss_bbox: 0.0149, loss_mask: 0.0137, loss: 0.0364
2022-03-27 20:10:42,630 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 9:27:51, time: 0.158, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0033, loss_cls: 0.0033, acc: 99.8809, loss_bbox: 0.0138, loss_mask: 0.0121, loss: 0.0331
2022-03-27 20:10:51,158 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 9:27:21, time: 0.170, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0034, loss_cls: 0.0038, acc: 99.8789, loss_bbox: 0.0146, loss_mask: 0.0129, loss: 0.0352
2022-03-27 20:10:59,487 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 9:25:41, time: 0.166, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0030, loss_cls: 0.0042, acc: 99.8633, loss_bbox: 0.0138, loss_mask: 0.0129, loss: 0.0344
2022-03-27 20:11:07,989 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 9:25:07, time: 0.170, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0029, loss_cls: 0.0036, acc: 99.8789, loss_bbox: 0.0140, loss_mask: 0.0126, loss: 0.0336
2022-03-27 20:11:15,862 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 9:21:04, time: 0.157, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0031, loss_cls: 0.0056, acc: 99.7852, loss_bbox: 0.0132, loss_mask: 0.0129, loss: 0.0352
2022-03-27 20:11:23,756 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 9:17:20, time: 0.158, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0030, loss_cls: 0.0030, acc: 99.8906, loss_bbox: 0.0131, loss_mask: 0.0120, loss: 0.0316
2022-03-27 20:11:32,248 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 9:16:54, time: 0.170, data_time: 0.001, memory: 3609, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0027, loss_cls: 0.0040, acc: 99.8828, loss_bbox: 0.0128, loss_mask: 0.0121, loss: 0.0321
2022-03-27 20:11:35,879 - mmdet - INFO - __benchmark_total_time(h):0.1055225494172838
2022-03-27 20:11:35,880 - mmdet - INFO - __benchmark_pure_training_time(h):0.10541655858357747
2022-03-27 20:11:35,882 - mmdet - INFO - __benchmark_avg_iter_time(s):0.1649780804579789
2022-03-27 20:11:35,882 - mmdet - INFO - __benchmark_mem_alloc(mb):3609
2022-03-27 20:11:35,882 - mmdet - INFO - __benchmark_mem_cached(mb):4592
[SH-IDC1-10-142-5-213][[61311,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 20:11:52,974 [32mINFO[0m: log service ip address is: 10.142.5.213:20173[0m
2022-03-27 20:11:52,975 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
2022-03-27 20:12:39,113 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 20:12:39,115 - mmdet - INFO - Distributed training: False
2022-03-27 20:12:39,925 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 20:12:40,009 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 20:12:40,009 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 20:12:40,369 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.61s)
creating index...
index created!
loading annotations into memory...
Done (t=0.36s)
creating index...
index created!
2022-03-27 20:12:53,943 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 20:12:53,944 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 20:12:53,945 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 20:12:53,945 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
2022-03-27 20:13:15,782 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 3 days, 13:11:58, time: 0.436, data_time: 0.090, memory: 3507, loss_rpn_cls: 0.4257, loss_rpn_bbox: 0.0431, loss_cls: 1.3194, acc: 87.4668, loss_bbox: 0.0884, loss_mask: 0.6202, loss: 2.4968
2022-03-27 20:13:23,927 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 2 days, 10:30:45, time: 0.163, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0503, loss_rpn_bbox: 0.0120, loss_cls: 0.4559, acc: 95.9805, loss_bbox: 0.2164, loss_mask: 0.2425, loss: 0.9772
2022-03-27 20:13:33,219 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 2 days, 3:06:55, time: 0.186, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0085, loss_rpn_bbox: 0.0127, loss_cls: 0.1951, acc: 98.9434, loss_bbox: 0.0867, loss_mask: 0.1003, loss: 0.4033
2022-03-27 20:13:41,474 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 1 day, 22:23:34, time: 0.165, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0045, loss_rpn_bbox: 0.0111, loss_cls: 0.1395, acc: 99.0938, loss_bbox: 0.0646, loss_mask: 0.0732, loss: 0.2929
2022-03-27 20:13:50,128 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 1 day, 19:52:37, time: 0.173, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0028, loss_rpn_bbox: 0.0110, loss_cls: 0.1353, acc: 99.3203, loss_bbox: 0.0536, loss_mask: 0.0604, loss: 0.2632
2022-03-27 20:13:58,586 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 1 day, 18:03:56, time: 0.169, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0033, loss_rpn_bbox: 0.0097, loss_cls: 0.0958, acc: 99.4023, loss_bbox: 0.0521, loss_mask: 0.0550, loss: 0.2160
2022-03-27 20:14:07,127 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 1 day, 16:49:26, time: 0.171, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0025, loss_rpn_bbox: 0.0091, loss_cls: 0.0591, acc: 99.4902, loss_bbox: 0.0483, loss_mask: 0.0503, loss: 0.1692
2022-03-27 20:14:15,653 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 1 day, 15:52:49, time: 0.170, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0024, loss_rpn_bbox: 0.0082, loss_cls: 0.0245, acc: 99.4902, loss_bbox: 0.0419, loss_mask: 0.0451, loss: 0.1222
2022-03-27 20:14:23,141 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 1 day, 14:41:50, time: 0.150, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0022, loss_rpn_bbox: 0.0088, loss_cls: 0.0191, acc: 99.5254, loss_bbox: 0.0416, loss_mask: 0.0417, loss: 0.1134
2022-03-27 20:14:31,670 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 1 day, 14:09:25, time: 0.171, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0022, loss_rpn_bbox: 0.0091, loss_cls: 0.0125, acc: 99.6504, loss_bbox: 0.0422, loss_mask: 0.0378, loss: 0.1039
2022-03-27 20:14:39,717 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 1 day, 13:32:23, time: 0.161, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0069, loss_cls: 0.0135, acc: 99.6230, loss_bbox: 0.0374, loss_mask: 0.0343, loss: 0.0938
2022-03-27 20:14:48,836 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 1 day, 13:22:45, time: 0.183, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0065, loss_cls: 0.0115, acc: 99.6719, loss_bbox: 0.0311, loss_mask: 0.0311, loss: 0.0817
2022-03-27 20:14:56,943 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 1 day, 12:56:11, time: 0.162, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0067, loss_cls: 0.0107, acc: 99.7188, loss_bbox: 0.0285, loss_mask: 0.0284, loss: 0.0761
2022-03-27 20:15:06,009 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 1 day, 12:49:27, time: 0.181, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0065, loss_cls: 0.0089, acc: 99.7695, loss_bbox: 0.0286, loss_mask: 0.0270, loss: 0.0722
2022-03-27 20:15:14,043 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 1 day, 12:27:31, time: 0.161, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0059, loss_cls: 0.0083, acc: 99.7773, loss_bbox: 0.0250, loss_mask: 0.0250, loss: 0.0653
2022-03-27 20:15:22,214 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 1 day, 12:10:14, time: 0.163, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0054, loss_cls: 0.0103, acc: 99.7129, loss_bbox: 0.0253, loss_mask: 0.0242, loss: 0.0664
2022-03-27 20:15:31,421 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 1 day, 12:09:17, time: 0.184, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0045, loss_cls: 0.0064, acc: 99.8027, loss_bbox: 0.0226, loss_mask: 0.0223, loss: 0.0572
2022-03-27 20:15:39,222 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 1 day, 11:50:08, time: 0.156, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0052, loss_cls: 0.0080, acc: 99.7734, loss_bbox: 0.0219, loss_mask: 0.0217, loss: 0.0578
2022-03-27 20:15:47,662 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 1 day, 11:40:53, time: 0.169, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0048, loss_cls: 0.0090, acc: 99.7246, loss_bbox: 0.0216, loss_mask: 0.0219, loss: 0.0584
2022-03-27 20:15:55,463 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 1 day, 11:25:01, time: 0.156, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0048, loss_cls: 0.0065, acc: 99.8164, loss_bbox: 0.0203, loss_mask: 0.0205, loss: 0.0530
2022-03-27 20:16:03,138 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 1 day, 11:09:18, time: 0.154, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0050, loss_cls: 0.0087, acc: 99.7695, loss_bbox: 0.0210, loss_mask: 0.0206, loss: 0.0563
2022-03-27 20:16:11,808 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 1 day, 11:05:34, time: 0.173, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0046, loss_cls: 0.0075, acc: 99.7754, loss_bbox: 0.0204, loss_mask: 0.0199, loss: 0.0536
2022-03-27 20:16:19,800 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 1 day, 10:55:10, time: 0.160, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0043, loss_cls: 0.0081, acc: 99.7109, loss_bbox: 0.0201, loss_mask: 0.0194, loss: 0.0528
2022-03-27 20:16:28,434 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 1 day, 10:52:01, time: 0.173, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0046, loss_cls: 0.0069, acc: 99.7617, loss_bbox: 0.0179, loss_mask: 0.0181, loss: 0.0482
2022-03-27 20:16:36,483 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 1 day, 10:43:30, time: 0.161, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0041, loss_cls: 0.0066, acc: 99.7539, loss_bbox: 0.0175, loss_mask: 0.0173, loss: 0.0463
2022-03-27 20:16:44,283 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 1 day, 10:33:30, time: 0.156, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0040, loss_cls: 0.0055, acc: 99.8066, loss_bbox: 0.0188, loss_mask: 0.0167, loss: 0.0455
2022-03-27 20:16:52,833 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 1 day, 10:30:41, time: 0.171, data_time: 0.001, memory: 3572, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0040, loss_cls: 0.0050, acc: 99.8398, loss_bbox: 0.0176, loss_mask: 0.0170, loss: 0.0443
2022-03-27 20:17:01,089 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 1 day, 10:25:36, time: 0.165, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0041, loss_cls: 0.0050, acc: 99.8418, loss_bbox: 0.0167, loss_mask: 0.0173, loss: 0.0439
2022-03-27 20:17:09,813 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 1 day, 10:24:38, time: 0.174, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0039, loss_cls: 0.0042, acc: 99.8770, loss_bbox: 0.0156, loss_mask: 0.0157, loss: 0.0400
2022-03-27 20:17:17,858 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 1 day, 10:18:25, time: 0.161, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0042, loss_cls: 0.0057, acc: 99.8145, loss_bbox: 0.0159, loss_mask: 0.0157, loss: 0.0422
2022-03-27 20:17:26,237 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 10:15:09, time: 0.168, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0036, loss_cls: 0.0040, acc: 99.8906, loss_bbox: 0.0167, loss_mask: 0.0151, loss: 0.0402
2022-03-27 20:17:33,769 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 10:05:51, time: 0.151, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0035, loss_cls: 0.0050, acc: 99.8242, loss_bbox: 0.0144, loss_mask: 0.0151, loss: 0.0387
2022-03-27 20:17:41,586 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 9:59:06, time: 0.156, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0034, loss_cls: 0.0049, acc: 99.8086, loss_bbox: 0.0138, loss_mask: 0.0146, loss: 0.0373
2022-03-27 20:17:50,062 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 9:57:21, time: 0.170, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0036, loss_cls: 0.0057, acc: 99.7988, loss_bbox: 0.0150, loss_mask: 0.0149, loss: 0.0397
2022-03-27 20:17:58,096 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 9:52:40, time: 0.161, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0033, loss_cls: 0.0046, acc: 99.8281, loss_bbox: 0.0157, loss_mask: 0.0138, loss: 0.0381
2022-03-27 20:18:06,331 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 9:49:37, time: 0.165, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0033, loss_cls: 0.0048, acc: 99.8438, loss_bbox: 0.0135, loss_mask: 0.0144, loss: 0.0365
2022-03-27 20:18:14,323 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 9:45:08, time: 0.160, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0031, loss_cls: 0.0049, acc: 99.8320, loss_bbox: 0.0128, loss_mask: 0.0138, loss: 0.0351
2022-03-27 20:18:22,484 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 9:41:54, time: 0.163, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0036, loss_cls: 0.0038, acc: 99.8809, loss_bbox: 0.0134, loss_mask: 0.0137, loss: 0.0350
2022-03-27 20:18:30,571 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 9:38:27, time: 0.162, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0034, loss_cls: 0.0033, acc: 99.9043, loss_bbox: 0.0143, loss_mask: 0.0133, loss: 0.0349
2022-03-27 20:18:38,794 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 9:35:52, time: 0.164, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0031, loss_cls: 0.0030, acc: 99.9141, loss_bbox: 0.0136, loss_mask: 0.0134, loss: 0.0338
2022-03-27 20:18:47,493 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 9:36:14, time: 0.174, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0029, loss_cls: 0.0039, acc: 99.8770, loss_bbox: 0.0120, loss_mask: 0.0137, loss: 0.0330
2022-03-27 20:18:55,698 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 9:33:43, time: 0.164, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0033, loss_cls: 0.0032, acc: 99.8750, loss_bbox: 0.0124, loss_mask: 0.0129, loss: 0.0322
2022-03-27 20:19:03,441 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 9:28:53, time: 0.155, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0030, loss_cls: 0.0039, acc: 99.8418, loss_bbox: 0.0129, loss_mask: 0.0125, loss: 0.0328
2022-03-27 20:19:12,473 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 9:31:05, time: 0.181, data_time: 0.001, memory: 3576, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0031, loss_cls: 0.0035, acc: 99.8652, loss_bbox: 0.0122, loss_mask: 0.0121, loss: 0.0314
2022-03-27 20:19:16,133 - mmdet - INFO - __benchmark_total_time(h):0.10626932289865282
2022-03-27 20:19:16,136 - mmdet - INFO - __benchmark_pure_training_time(h):0.10616252574655745
2022-03-27 20:19:16,143 - mmdet - INFO - __benchmark_avg_iter_time(s):0.16407436614746337
2022-03-27 20:19:16,144 - mmdet - INFO - __benchmark_mem_alloc(mb):3572
2022-03-27 20:19:16,144 - mmdet - INFO - __benchmark_mem_cached(mb):4624
[SH-IDC1-10-142-5-213][[34952,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 20:19:33,499 [32mINFO[0m: log service ip address is: 10.142.5.213:50074[0m
2022-03-27 20:19:33,499 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
2022-03-27 20:20:18,905 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 20:20:18,908 - mmdet - INFO - Distributed training: False
2022-03-27 20:20:19,798 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 20:20:19,880 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 20:20:19,881 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 20:20:20,243 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=11.67s)
creating index...
index created!
loading annotations into memory...
Done (t=0.51s)
creating index...
index created!
2022-03-27 20:20:35,063 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 20:20:35,065 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 20:20:35,066 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 20:20:35,066 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test.nocompiler/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
2022-03-27 20:20:55,936 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 3 days, 9:16:15, time: 0.416, data_time: 0.090, memory: 3501, loss_rpn_cls: 0.4039, loss_rpn_bbox: 0.0405, loss_cls: 1.2626, acc: 89.2285, loss_bbox: 0.1013, loss_mask: 0.6903, loss: 2.4987
2022-03-27 20:21:04,337 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 2 days, 9:03:47, time: 0.168, data_time: 0.002, memory: 3629, loss_rpn_cls: 0.0510, loss_rpn_bbox: 0.0115, loss_cls: 0.5372, acc: 95.1680, loss_bbox: 0.2464, loss_mask: 0.2689, loss: 1.1150
2022-03-27 20:21:13,009 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 2 days, 1:20:01, time: 0.173, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0107, loss_rpn_bbox: 0.0112, loss_cls: 0.3297, acc: 98.4082, loss_bbox: 0.1186, loss_mask: 0.1119, loss: 0.5821
2022-03-27 20:21:21,445 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 1 day, 21:13:58, time: 0.169, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0048, loss_rpn_bbox: 0.0116, loss_cls: 0.1884, acc: 99.2070, loss_bbox: 0.0738, loss_mask: 0.0774, loss: 0.3558
2022-03-27 20:21:30,401 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 1 day, 19:11:30, time: 0.179, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0035, loss_rpn_bbox: 0.0112, loss_cls: 0.1440, acc: 99.2578, loss_bbox: 0.0619, loss_mask: 0.0623, loss: 0.2829
2022-03-27 20:21:38,693 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 1 day, 17:22:53, time: 0.166, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0030, loss_rpn_bbox: 0.0094, loss_cls: 0.0797, acc: 99.2852, loss_bbox: 0.0560, loss_mask: 0.0550, loss: 0.2030
2022-03-27 20:21:48,189 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 1 day, 16:46:19, time: 0.190, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0027, loss_rpn_bbox: 0.0083, loss_cls: 0.0296, acc: 99.3867, loss_bbox: 0.0516, loss_mask: 0.0504, loss: 0.1426
2022-03-27 20:21:56,394 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 1 day, 15:40:37, time: 0.164, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0025, loss_rpn_bbox: 0.0094, loss_cls: 0.0187, acc: 99.4980, loss_bbox: 0.0477, loss_mask: 0.0448, loss: 0.1231
2022-03-27 20:22:04,355 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 1 day, 14:43:23, time: 0.159, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0021, loss_rpn_bbox: 0.0084, loss_cls: 0.0180, acc: 99.4902, loss_bbox: 0.0433, loss_mask: 0.0403, loss: 0.1121
2022-03-27 20:22:12,858 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 1 day, 14:10:10, time: 0.170, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0021, loss_rpn_bbox: 0.0083, loss_cls: 0.0164, acc: 99.5586, loss_bbox: 0.0423, loss_mask: 0.0386, loss: 0.1077
2022-03-27 20:22:20,965 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 1 day, 13:34:25, time: 0.162, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0074, loss_cls: 0.0151, acc: 99.5996, loss_bbox: 0.0380, loss_mask: 0.0345, loss: 0.0968
2022-03-27 20:22:29,757 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 1 day, 13:18:12, time: 0.176, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0068, loss_cls: 0.0135, acc: 99.6016, loss_bbox: 0.0355, loss_mask: 0.0323, loss: 0.0899
2022-03-27 20:22:37,834 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 1 day, 12:51:24, time: 0.161, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0064, loss_cls: 0.0132, acc: 99.6270, loss_bbox: 0.0335, loss_mask: 0.0309, loss: 0.0857
2022-03-27 20:22:47,093 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 1 day, 12:48:17, time: 0.185, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0063, loss_cls: 0.0114, acc: 99.6504, loss_bbox: 0.0303, loss_mask: 0.0279, loss: 0.0773
2022-03-27 20:22:55,210 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 1 day, 12:27:39, time: 0.162, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0055, loss_cls: 0.0114, acc: 99.7070, loss_bbox: 0.0263, loss_mask: 0.0266, loss: 0.0711
2022-03-27 20:23:03,105 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 1 day, 12:06:26, time: 0.158, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0054, loss_cls: 0.0101, acc: 99.7031, loss_bbox: 0.0260, loss_mask: 0.0250, loss: 0.0677
2022-03-27 20:23:11,517 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 1 day, 11:54:44, time: 0.168, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0050, loss_cls: 0.0074, acc: 99.7852, loss_bbox: 0.0252, loss_mask: 0.0231, loss: 0.0619
2022-03-27 20:23:20,048 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 1 day, 11:45:48, time: 0.170, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0046, loss_cls: 0.0093, acc: 99.7207, loss_bbox: 0.0251, loss_mask: 0.0220, loss: 0.0622
2022-03-27 20:23:28,739 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 1 day, 11:39:56, time: 0.174, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0044, loss_cls: 0.0099, acc: 99.7227, loss_bbox: 0.0225, loss_mask: 0.0212, loss: 0.0591
2022-03-27 20:23:37,038 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 1 day, 11:29:57, time: 0.166, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0045, loss_cls: 0.0069, acc: 99.7852, loss_bbox: 0.0222, loss_mask: 0.0197, loss: 0.0543
2022-03-27 20:23:44,969 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 1 day, 11:16:51, time: 0.159, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0043, loss_cls: 0.0082, acc: 99.7520, loss_bbox: 0.0208, loss_mask: 0.0189, loss: 0.0530
2022-03-27 20:23:53,935 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 1 day, 11:15:49, time: 0.179, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0047, loss_cls: 0.0099, acc: 99.7129, loss_bbox: 0.0211, loss_mask: 0.0200, loss: 0.0568
2022-03-27 20:24:02,117 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 1 day, 11:07:01, time: 0.164, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0041, loss_cls: 0.0071, acc: 99.7676, loss_bbox: 0.0195, loss_mask: 0.0192, loss: 0.0508
2022-03-27 20:24:11,520 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 1 day, 11:10:49, time: 0.188, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0047, loss_cls: 0.0068, acc: 99.7773, loss_bbox: 0.0196, loss_mask: 0.0186, loss: 0.0506
2022-03-27 20:24:19,548 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 1 day, 11:01:25, time: 0.161, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0044, loss_cls: 0.0068, acc: 99.7793, loss_bbox: 0.0185, loss_mask: 0.0181, loss: 0.0486
2022-03-27 20:24:28,710 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 1 day, 11:02:55, time: 0.183, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0041, loss_cls: 0.0059, acc: 99.7910, loss_bbox: 0.0186, loss_mask: 0.0172, loss: 0.0467
2022-03-27 20:24:36,500 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 1 day, 10:52:26, time: 0.156, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0044, loss_cls: 0.0051, acc: 99.8516, loss_bbox: 0.0180, loss_mask: 0.0159, loss: 0.0442
2022-03-27 20:24:44,407 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 1 day, 10:43:41, time: 0.158, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0038, loss_cls: 0.0061, acc: 99.8105, loss_bbox: 0.0173, loss_mask: 0.0161, loss: 0.0440
2022-03-27 20:24:53,648 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 1 day, 10:46:17, time: 0.185, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0041, loss_cls: 0.0056, acc: 99.8203, loss_bbox: 0.0173, loss_mask: 0.0165, loss: 0.0444
2022-03-27 20:25:02,122 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 1 day, 10:42:35, time: 0.169, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0036, loss_cls: 0.0054, acc: 99.8184, loss_bbox: 0.0152, loss_mask: 0.0157, loss: 0.0405
2022-03-27 20:25:10,559 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 1 day, 10:39:03, time: 0.169, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0035, loss_cls: 0.0064, acc: 99.8145, loss_bbox: 0.0148, loss_mask: 0.0152, loss: 0.0407
2022-03-27 20:25:19,311 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 1 day, 10:37:53, time: 0.175, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0035, loss_cls: 0.0082, acc: 99.6660, loss_bbox: 0.0165, loss_mask: 0.0155, loss: 0.0442
2022-03-27 20:25:27,620 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 1 day, 10:33:44, time: 0.166, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0041, loss_cls: 0.0058, acc: 99.8262, loss_bbox: 0.0178, loss_mask: 0.0153, loss: 0.0439
2022-03-27 20:25:36,156 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 1 day, 10:31:18, time: 0.171, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0032, loss_cls: 0.0073, acc: 99.7188, loss_bbox: 0.0143, loss_mask: 0.0143, loss: 0.0398
2022-03-27 20:25:44,098 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 1 day, 10:25:05, time: 0.159, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0036, loss_cls: 0.0062, acc: 99.7910, loss_bbox: 0.0150, loss_mask: 0.0139, loss: 0.0393
2022-03-27 20:25:52,467 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 10:21:58, time: 0.167, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0033, loss_cls: 0.0044, acc: 99.8535, loss_bbox: 0.0148, loss_mask: 0.0145, loss: 0.0376
2022-03-27 20:26:00,650 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 10:17:48, time: 0.164, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0035, loss_cls: 0.0048, acc: 99.8281, loss_bbox: 0.0167, loss_mask: 0.0135, loss: 0.0392
2022-03-27 20:26:08,827 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 10:13:50, time: 0.164, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0030, loss_cls: 0.0034, acc: 99.8848, loss_bbox: 0.0145, loss_mask: 0.0134, loss: 0.0348
2022-03-27 20:26:17,664 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 10:14:02, time: 0.177, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0033, loss_cls: 0.0035, acc: 99.8730, loss_bbox: 0.0140, loss_mask: 0.0128, loss: 0.0341
2022-03-27 20:26:25,712 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 10:09:36, time: 0.161, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0030, loss_cls: 0.0044, acc: 99.8418, loss_bbox: 0.0141, loss_mask: 0.0137, loss: 0.0357
2022-03-27 20:26:33,544 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 10:04:08, time: 0.157, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0032, loss_cls: 0.0034, acc: 99.8965, loss_bbox: 0.0142, loss_mask: 0.0127, loss: 0.0341
2022-03-27 20:26:42,008 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 10:02:26, time: 0.169, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0034, loss_cls: 0.0036, acc: 99.8789, loss_bbox: 0.0141, loss_mask: 0.0132, loss: 0.0348
2022-03-27 20:26:50,097 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 9:58:47, time: 0.162, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0030, loss_cls: 0.0039, acc: 99.8887, loss_bbox: 0.0138, loss_mask: 0.0122, loss: 0.0334
2022-03-27 20:26:58,792 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 9:58:30, time: 0.174, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0034, loss_cls: 0.0042, acc: 99.8652, loss_bbox: 0.0130, loss_mask: 0.0129, loss: 0.0340
2022-03-27 20:27:01,939 - mmdet - INFO - __benchmark_total_time(h):0.10761662311024137
2022-03-27 20:27:01,939 - mmdet - INFO - __benchmark_pure_training_time(h):0.10746443523301019
2022-03-27 20:27:01,939 - mmdet - INFO - __benchmark_avg_iter_time(s):0.16726250724716263
2022-03-27 20:27:01,939 - mmdet - INFO - __benchmark_mem_alloc(mb):3639
2022-03-27 20:27:01,940 - mmdet - INFO - __benchmark_mem_cached(mb):4624
/mnt/lustre/jianglijuan/view-res
