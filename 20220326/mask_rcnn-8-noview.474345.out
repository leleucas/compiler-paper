[SH-IDC1-10-142-5-213][[42503,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 16:56:04,868 [32mINFO[0m: log service ip address is: 10.142.5.213:17668[0m
2022-03-27 16:56:04,868 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 16:56:49,708 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 16:56:49,710 - mmdet - INFO - Distributed training: False
2022-03-27 16:56:50,603 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 16:56:50,685 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:56:50,686 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 16:56:51,051 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.59s)
creating index...
index created!
loading annotations into memory...
Done (t=0.35s)
creating index...
index created!
2022-03-27 16:57:04,326 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 16:57:04,327 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 16:57:04,327 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 16:57:04,328 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 16:59:43,680 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 25 days, 22:41:13, time: 3.186, data_time: 0.090, memory: 3465, loss_rpn_cls: 0.3470, loss_rpn_bbox: 0.0140, loss_cls: 1.6958, acc: 86.9180, loss_bbox: 0.0796, loss_mask: 0.6064, loss: 2.7428
2022-03-27 16:59:51,548 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 14:42:13, time: 0.157, data_time: 0.001, memory: 3620, loss_rpn_cls: 0.0336, loss_rpn_bbox: 0.0052, loss_cls: 0.5933, acc: 96.1836, loss_bbox: 0.2012, loss_mask: 0.2367, loss: 1.0700
2022-03-27 16:59:59,994 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 12:47:09, time: 0.169, data_time: 0.001, memory: 3622, loss_rpn_cls: 0.0119, loss_rpn_bbox: 0.0030, loss_cls: 0.1204, acc: 99.0176, loss_bbox: 0.1033, loss_mask: 0.1127, loss: 0.3512
2022-03-27 17:00:08,161 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 11:33:35, time: 0.163, data_time: 0.001, memory: 3622, loss_rpn_cls: 0.0039, loss_rpn_bbox: 0.0034, loss_cls: 0.0818, acc: 99.2676, loss_bbox: 0.0695, loss_mask: 0.0763, loss: 0.2348
2022-03-27 17:00:16,657 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 6:16:07, time: 0.170, data_time: 0.001, memory: 3622, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0038, loss_cls: 0.1265, acc: 99.3691, loss_bbox: 0.0561, loss_mask: 0.0556, loss: 0.2437
2022-03-27 17:00:24,458 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 10:18:00, time: 0.156, data_time: 0.001, memory: 3634, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0042, loss_cls: 0.0735, acc: 99.4668, loss_bbox: 0.0527, loss_mask: 0.0494, loss: 0.1814
2022-03-27 17:00:32,259 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 20:01:55, time: 0.156, data_time: 0.001, memory: 3653, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0037, loss_cls: 0.0669, acc: 99.4512, loss_bbox: 0.0518, loss_mask: 0.0456, loss: 0.1697
2022-03-27 17:00:40,568 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 9:34:26, time: 0.166, data_time: 0.001, memory: 3653, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0037, loss_cls: 0.0435, acc: 99.5254, loss_bbox: 0.0458, loss_mask: 0.0434, loss: 0.1380
2022-03-27 17:00:48,251 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 1:10:30, time: 0.154, data_time: 0.001, memory: 3657, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0031, loss_cls: 0.0210, acc: 99.5781, loss_bbox: 0.0452, loss_mask: 0.0408, loss: 0.1116
2022-03-27 17:00:57,136 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 18:55:08, time: 0.178, data_time: 0.001, memory: 3665, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0031, loss_cls: 0.0136, acc: 99.6875, loss_bbox: 0.0400, loss_mask: 0.0365, loss: 0.0944
2022-03-27 17:01:04,866 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 13:23:41, time: 0.155, data_time: 0.001, memory: 3666, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0031, loss_cls: 0.0166, acc: 99.5293, loss_bbox: 0.0408, loss_mask: 0.0352, loss: 0.0968
2022-03-27 17:01:12,735 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 8:50:07, time: 0.157, data_time: 0.001, memory: 3712, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0028, loss_cls: 0.0128, acc: 99.6270, loss_bbox: 0.0361, loss_mask: 0.0328, loss: 0.0856
2022-03-27 17:01:21,518 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 5:14:48, time: 0.175, data_time: 0.001, memory: 3712, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0024, loss_cls: 0.0111, acc: 99.6738, loss_bbox: 0.0319, loss_mask: 0.0281, loss: 0.0744
2022-03-27 17:01:29,188 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 1:51:56, time: 0.154, data_time: 0.001, memory: 3712, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0025, loss_cls: 0.0105, acc: 99.6641, loss_bbox: 0.0305, loss_mask: 0.0267, loss: 0.0709
2022-03-27 17:01:37,766 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 23:10:05, time: 0.171, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0022, loss_cls: 0.0097, acc: 99.7324, loss_bbox: 0.0271, loss_mask: 0.0254, loss: 0.0652
2022-03-27 17:01:45,396 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 20:34:40, time: 0.153, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0024, loss_cls: 0.0103, acc: 99.7051, loss_bbox: 0.0271, loss_mask: 0.0245, loss: 0.0651
2022-03-27 17:01:53,148 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 18:19:07, time: 0.155, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0021, loss_cls: 0.0087, acc: 99.7422, loss_bbox: 0.0245, loss_mask: 0.0234, loss: 0.0596
2022-03-27 17:02:01,770 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 16:30:00, time: 0.172, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0020, loss_cls: 0.0091, acc: 99.7383, loss_bbox: 0.0219, loss_mask: 0.0211, loss: 0.0548
2022-03-27 17:02:09,611 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 14:42:44, time: 0.157, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0020, loss_cls: 0.0078, acc: 99.7441, loss_bbox: 0.0231, loss_mask: 0.0205, loss: 0.0539
2022-03-27 17:02:18,020 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 13:12:46, time: 0.168, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0018, loss_cls: 0.0096, acc: 99.6875, loss_bbox: 0.0227, loss_mask: 0.0197, loss: 0.0544
2022-03-27 17:02:25,910 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 11:45:37, time: 0.158, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0075, acc: 99.7422, loss_bbox: 0.0203, loss_mask: 0.0187, loss: 0.0488
2022-03-27 17:02:33,587 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 10:24:07, time: 0.154, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0079, acc: 99.7031, loss_bbox: 0.0217, loss_mask: 0.0185, loss: 0.0502
2022-03-27 17:02:42,341 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 9:20:38, time: 0.175, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0016, loss_cls: 0.0064, acc: 99.7852, loss_bbox: 0.0213, loss_mask: 0.0171, loss: 0.0469
2022-03-27 17:02:50,142 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 8:13:07, time: 0.156, data_time: 0.001, memory: 3744, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0088, acc: 99.7168, loss_bbox: 0.0215, loss_mask: 0.0169, loss: 0.0495
2022-03-27 17:02:58,650 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 7:17:38, time: 0.170, data_time: 0.001, memory: 3753, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0070, acc: 99.7910, loss_bbox: 0.0211, loss_mask: 0.0177, loss: 0.0479
2022-03-27 17:03:06,360 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 6:19:13, time: 0.154, data_time: 0.001, memory: 3753, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0055, acc: 99.8574, loss_bbox: 0.0210, loss_mask: 0.0169, loss: 0.0456
2022-03-27 17:03:14,009 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 5:24:37, time: 0.153, data_time: 0.001, memory: 3753, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0055, acc: 99.8145, loss_bbox: 0.0180, loss_mask: 0.0153, loss: 0.0410
2022-03-27 17:03:21,997 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 4:36:42, time: 0.160, data_time: 0.001, memory: 3753, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0043, acc: 99.8789, loss_bbox: 0.0182, loss_mask: 0.0149, loss: 0.0394
2022-03-27 17:03:29,635 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 3:49:16, time: 0.153, data_time: 0.001, memory: 3757, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0062, acc: 99.8008, loss_bbox: 0.0175, loss_mask: 0.0153, loss: 0.0411
2022-03-27 17:03:38,358 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 3:13:28, time: 0.174, data_time: 0.001, memory: 3757, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0066, acc: 99.8047, loss_bbox: 0.0162, loss_mask: 0.0151, loss: 0.0397
2022-03-27 17:03:46,153 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 2:32:59, time: 0.156, data_time: 0.001, memory: 3757, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0066, acc: 99.7910, loss_bbox: 0.0174, loss_mask: 0.0158, loss: 0.0419
2022-03-27 17:03:53,986 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 1:55:16, time: 0.157, data_time: 0.001, memory: 3757, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0050, acc: 99.8262, loss_bbox: 0.0157, loss_mask: 0.0142, loss: 0.0366
2022-03-27 17:04:02,902 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 2 days, 1:27:29, time: 0.178, data_time: 0.001, memory: 3757, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0054, acc: 99.8223, loss_bbox: 0.0178, loss_mask: 0.0138, loss: 0.0392
2022-03-27 17:04:10,631 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 2 days, 0:53:12, time: 0.155, data_time: 0.001, memory: 3757, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0041, acc: 99.8633, loss_bbox: 0.0149, loss_mask: 0.0128, loss: 0.0335
2022-03-27 17:04:19,313 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 2 days, 0:27:10, time: 0.173, data_time: 0.001, memory: 3761, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0039, acc: 99.8984, loss_bbox: 0.0142, loss_mask: 0.0133, loss: 0.0331
2022-03-27 17:04:26,994 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 23:56:10, time: 0.154, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0044, acc: 99.8457, loss_bbox: 0.0158, loss_mask: 0.0140, loss: 0.0361
2022-03-27 17:04:34,648 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 23:26:38, time: 0.153, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0024, acc: 99.9238, loss_bbox: 0.0142, loss_mask: 0.0129, loss: 0.0311
2022-03-27 17:04:43,584 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 23:06:29, time: 0.179, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0037, acc: 99.8828, loss_bbox: 0.0146, loss_mask: 0.0126, loss: 0.0328
2022-03-27 17:04:51,332 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 22:40:19, time: 0.155, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0047, acc: 99.8320, loss_bbox: 0.0141, loss_mask: 0.0129, loss: 0.0333
2022-03-27 17:05:00,159 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 22:21:41, time: 0.176, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0012, loss_cls: 0.0053, acc: 99.8613, loss_bbox: 0.0141, loss_mask: 0.0125, loss: 0.0333
2022-03-27 17:05:07,899 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 21:57:49, time: 0.155, data_time: 0.001, memory: 3787, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0057, acc: 99.8125, loss_bbox: 0.0143, loss_mask: 0.0137, loss: 0.0354
2022-03-27 17:05:15,643 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 21:35:06, time: 0.155, data_time: 0.001, memory: 3787, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0012, loss_cls: 0.0058, acc: 99.8047, loss_bbox: 0.0130, loss_mask: 0.0129, loss: 0.0333
2022-03-27 17:05:24,469 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 21:19:14, time: 0.176, data_time: 0.001, memory: 3787, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0051, acc: 99.8262, loss_bbox: 0.0136, loss_mask: 0.0122, loss: 0.0324
2022-03-27 17:05:32,066 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 20:57:38, time: 0.152, data_time: 0.001, memory: 3787, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0012, loss_cls: 0.0060, acc: 99.7812, loss_bbox: 0.0126, loss_mask: 0.0119, loss: 0.0320
2022-03-27 17:05:35,268 - mmdet - INFO - __benchmark_total_time(h):0.1420303902361128
2022-03-27 17:05:35,268 - mmdet - INFO - __benchmark_pure_training_time(h):0.14192743360996246
2022-03-27 17:05:35,269 - mmdet - INFO - __benchmark_avg_iter_time(s):0.16194910864968162
2022-03-27 17:05:35,269 - mmdet - INFO - __benchmark_mem_alloc(mb):3744
2022-03-27 17:05:35,269 - mmdet - INFO - __benchmark_mem_cached(mb):5616
[SH-IDC1-10-142-5-213][[18486,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 17:05:51,669 [32mINFO[0m: log service ip address is: 10.142.5.213:33442[0m
2022-03-27 17:05:51,670 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 17:06:37,902 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 17:06:37,904 - mmdet - INFO - Distributed training: False
2022-03-27 17:06:38,798 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 17:06:38,886 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 17:06:38,887 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 17:06:39,255 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.70s)
creating index...
index created!
loading annotations into memory...
Done (t=0.38s)
creating index...
index created!
2022-03-27 17:06:52,953 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 17:06:52,953 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 17:06:52,953 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 17:06:52,953 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 17:09:36,855 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 26 days, 16:28:37, time: 3.277, data_time: 0.090, memory: 3587, loss_rpn_cls: 0.3888, loss_rpn_bbox: 0.0130, loss_cls: 1.3278, acc: 86.4590, loss_bbox: 0.1338, loss_mask: 0.6832, loss: 2.5467
2022-03-27 17:09:44,618 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 23:22:59, time: 0.155, data_time: 0.001, memory: 3691, loss_rpn_cls: 0.0330, loss_rpn_bbox: 0.0055, loss_cls: 0.4226, acc: 95.8242, loss_bbox: 0.2286, loss_mask: 0.2689, loss: 0.9587
2022-03-27 17:09:53,629 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 19:18:24, time: 0.180, data_time: 0.001, memory: 3691, loss_rpn_cls: 0.0093, loss_rpn_bbox: 0.0027, loss_cls: 0.2266, acc: 98.8672, loss_bbox: 0.0980, loss_mask: 0.1112, loss: 0.4478
2022-03-27 17:10:01,490 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 16:08:46, time: 0.157, data_time: 0.001, memory: 3691, loss_rpn_cls: 0.0031, loss_rpn_bbox: 0.0041, loss_cls: 0.2765, acc: 99.1738, loss_bbox: 0.0634, loss_mask: 0.0764, loss: 0.4234
2022-03-27 17:10:10,337 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 10:13:23, time: 0.177, data_time: 0.001, memory: 3691, loss_rpn_cls: 0.0027, loss_rpn_bbox: 0.0043, loss_cls: 0.0867, acc: 99.2910, loss_bbox: 0.0609, loss_mask: 0.0657, loss: 0.2203
2022-03-27 17:10:18,443 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 13:47:08, time: 0.162, data_time: 0.001, memory: 3691, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0036, loss_cls: 0.1192, acc: 99.4531, loss_bbox: 0.0605, loss_mask: 0.0577, loss: 0.2429
2022-03-27 17:10:26,109 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 22:56:45, time: 0.153, data_time: 0.001, memory: 3691, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0036, loss_cls: 0.0447, acc: 99.4668, loss_bbox: 0.0483, loss_mask: 0.0532, loss: 0.1515
2022-03-27 17:10:34,577 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 12:12:17, time: 0.169, data_time: 0.001, memory: 3692, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0035, loss_cls: 0.0234, acc: 99.4258, loss_bbox: 0.0514, loss_mask: 0.0489, loss: 0.1287
2022-03-27 17:10:42,684 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 3:41:30, time: 0.162, data_time: 0.001, memory: 3692, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0035, loss_cls: 0.0225, acc: 99.4609, loss_bbox: 0.0454, loss_mask: 0.0446, loss: 0.1175
2022-03-27 17:10:51,123 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 21:00:53, time: 0.169, data_time: 0.001, memory: 3692, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0033, loss_cls: 0.0131, acc: 99.6309, loss_bbox: 0.0405, loss_mask: 0.0384, loss: 0.0968
2022-03-27 17:10:59,309 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 15:27:32, time: 0.164, data_time: 0.001, memory: 3692, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0028, loss_cls: 0.0125, acc: 99.6543, loss_bbox: 0.0387, loss_mask: 0.0363, loss: 0.0916
2022-03-27 17:11:07,824 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 10:56:11, time: 0.170, data_time: 0.001, memory: 3692, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0030, loss_cls: 0.0093, acc: 99.7461, loss_bbox: 0.0360, loss_mask: 0.0313, loss: 0.0804
2022-03-27 17:11:15,459 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 6:50:40, time: 0.153, data_time: 0.001, memory: 3692, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0025, loss_cls: 0.0102, acc: 99.7148, loss_bbox: 0.0305, loss_mask: 0.0302, loss: 0.0744
2022-03-27 17:11:23,180 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 3:21:33, time: 0.154, data_time: 0.001, memory: 3692, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0021, loss_cls: 0.0078, acc: 99.7832, loss_bbox: 0.0276, loss_mask: 0.0284, loss: 0.0667
2022-03-27 17:11:31,464 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 3 days, 0:29:17, time: 0.166, data_time: 0.001, memory: 3692, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0022, loss_cls: 0.0087, acc: 99.7715, loss_bbox: 0.0273, loss_mask: 0.0271, loss: 0.0661
2022-03-27 17:11:39,352 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 21:52:40, time: 0.158, data_time: 0.001, memory: 3692, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0023, loss_cls: 0.0088, acc: 99.7207, loss_bbox: 0.0284, loss_mask: 0.0254, loss: 0.0655
2022-03-27 17:11:47,308 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 19:35:13, time: 0.159, data_time: 0.001, memory: 3692, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0020, loss_cls: 0.0080, acc: 99.7812, loss_bbox: 0.0263, loss_mask: 0.0242, loss: 0.0611
2022-03-27 17:11:54,701 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 17:26:01, time: 0.148, data_time: 0.001, memory: 3692, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0026, loss_cls: 0.0058, acc: 99.8203, loss_bbox: 0.0234, loss_mask: 0.0221, loss: 0.0545
2022-03-27 17:12:02,466 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 15:34:47, time: 0.155, data_time: 0.001, memory: 3692, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0053, acc: 99.8691, loss_bbox: 0.0204, loss_mask: 0.0210, loss: 0.0490
2022-03-27 17:12:10,886 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 14:02:25, time: 0.168, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0019, loss_cls: 0.0063, acc: 99.8145, loss_bbox: 0.0222, loss_mask: 0.0204, loss: 0.0517
2022-03-27 17:12:18,963 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 12:34:54, time: 0.161, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0023, loss_cls: 0.0061, acc: 99.8379, loss_bbox: 0.0227, loss_mask: 0.0195, loss: 0.0512
2022-03-27 17:12:26,587 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 11:10:40, time: 0.153, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0040, acc: 99.9043, loss_bbox: 0.0216, loss_mask: 0.0181, loss: 0.0458
2022-03-27 17:12:35,107 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 10:02:45, time: 0.170, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0058, acc: 99.8418, loss_bbox: 0.0214, loss_mask: 0.0185, loss: 0.0477
2022-03-27 17:12:43,060 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 8:54:53, time: 0.159, data_time: 0.001, memory: 3742, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0045, acc: 99.8711, loss_bbox: 0.0201, loss_mask: 0.0177, loss: 0.0446
2022-03-27 17:12:51,744 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 7:59:28, time: 0.174, data_time: 0.001, memory: 3763, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0016, loss_cls: 0.0043, acc: 99.8770, loss_bbox: 0.0186, loss_mask: 0.0168, loss: 0.0417
2022-03-27 17:12:59,657 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 7:01:15, time: 0.158, data_time: 0.001, memory: 3763, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0044, acc: 99.8496, loss_bbox: 0.0193, loss_mask: 0.0162, loss: 0.0419
2022-03-27 17:13:08,163 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 6:12:30, time: 0.170, data_time: 0.001, memory: 3763, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0068, acc: 99.8145, loss_bbox: 0.0198, loss_mask: 0.0163, loss: 0.0451
2022-03-27 17:13:15,950 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 5:21:14, time: 0.156, data_time: 0.001, memory: 3763, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0046, acc: 99.8672, loss_bbox: 0.0174, loss_mask: 0.0161, loss: 0.0401
2022-03-27 17:13:23,780 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 4:33:46, time: 0.156, data_time: 0.001, memory: 3763, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0046, acc: 99.8809, loss_bbox: 0.0186, loss_mask: 0.0151, loss: 0.0403
2022-03-27 17:13:32,600 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 3:57:14, time: 0.176, data_time: 0.001, memory: 3763, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0013, loss_cls: 0.0048, acc: 99.8633, loss_bbox: 0.0167, loss_mask: 0.0148, loss: 0.0381
2022-03-27 17:13:40,132 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 3:13:20, time: 0.151, data_time: 0.001, memory: 3763, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0041, acc: 99.8828, loss_bbox: 0.0181, loss_mask: 0.0154, loss: 0.0395
2022-03-27 17:13:48,229 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 2:36:17, time: 0.162, data_time: 0.001, memory: 3763, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0066, acc: 99.8066, loss_bbox: 0.0177, loss_mask: 0.0154, loss: 0.0415
2022-03-27 17:13:55,817 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 2 days, 1:57:53, time: 0.152, data_time: 0.001, memory: 3763, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0036, acc: 99.9023, loss_bbox: 0.0170, loss_mask: 0.0145, loss: 0.0369
2022-03-27 17:14:03,904 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 2 days, 1:25:07, time: 0.162, data_time: 0.001, memory: 3771, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0030, acc: 99.9414, loss_bbox: 0.0169, loss_mask: 0.0141, loss: 0.0358
2022-03-27 17:14:12,002 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 2 days, 0:54:21, time: 0.162, data_time: 0.001, memory: 3779, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0028, acc: 99.9434, loss_bbox: 0.0165, loss_mask: 0.0141, loss: 0.0351
2022-03-27 17:14:20,157 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 2 days, 0:25:37, time: 0.163, data_time: 0.001, memory: 3796, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0043, acc: 99.8574, loss_bbox: 0.0174, loss_mask: 0.0139, loss: 0.0376
2022-03-27 17:14:28,010 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 23:56:33, time: 0.157, data_time: 0.001, memory: 3796, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0012, loss_cls: 0.0038, acc: 99.8848, loss_bbox: 0.0171, loss_mask: 0.0131, loss: 0.0356
2022-03-27 17:14:35,531 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 23:26:56, time: 0.150, data_time: 0.001, memory: 3796, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0040, acc: 99.8848, loss_bbox: 0.0160, loss_mask: 0.0139, loss: 0.0357
2022-03-27 17:14:43,385 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 23:00:48, time: 0.157, data_time: 0.001, memory: 3796, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0012, loss_cls: 0.0038, acc: 99.8750, loss_bbox: 0.0150, loss_mask: 0.0130, loss: 0.0333
2022-03-27 17:14:51,827 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 22:39:29, time: 0.169, data_time: 0.001, memory: 3796, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0029, acc: 99.8945, loss_bbox: 0.0148, loss_mask: 0.0125, loss: 0.0319
2022-03-27 17:14:59,734 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 22:16:04, time: 0.158, data_time: 0.001, memory: 3817, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0057, acc: 99.8340, loss_bbox: 0.0160, loss_mask: 0.0135, loss: 0.0369
2022-03-27 17:15:08,147 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 21:56:39, time: 0.168, data_time: 0.001, memory: 3817, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0054, acc: 99.7930, loss_bbox: 0.0159, loss_mask: 0.0132, loss: 0.0362
2022-03-27 17:15:15,928 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 21:34:39, time: 0.156, data_time: 0.001, memory: 3817, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0011, loss_cls: 0.0044, acc: 99.8555, loss_bbox: 0.0141, loss_mask: 0.0123, loss: 0.0321
2022-03-27 17:15:23,651 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 21:13:18, time: 0.154, data_time: 0.001, memory: 3817, loss_rpn_cls: 0.0002, loss_rpn_bbox: 0.0012, loss_cls: 0.0036, acc: 99.8887, loss_bbox: 0.0139, loss_mask: 0.0118, loss: 0.0308
2022-03-27 17:15:26,778 - mmdet - INFO - __benchmark_total_time(h):0.1428421550989151
2022-03-27 17:15:26,779 - mmdet - INFO - __benchmark_pure_training_time(h):0.14272903104623158
2022-03-27 17:15:26,780 - mmdet - INFO - __benchmark_avg_iter_time(s):0.16062106976618656
2022-03-27 17:15:26,780 - mmdet - INFO - __benchmark_mem_alloc(mb):3742
2022-03-27 17:15:26,780 - mmdet - INFO - __benchmark_mem_cached(mb):5616
[SH-IDC1-10-142-5-213][[28055,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 17:15:47,035 [32mINFO[0m: log service ip address is: 10.142.5.213:50108[0m
2022-03-27 17:15:47,036 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 17:16:31,571 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 17:16:31,573 - mmdet - INFO - Distributed training: False
2022-03-27 17:16:32,481 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 17:16:32,566 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 17:16:32,567 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 17:16:33,107 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.43s)
creating index...
index created!
loading annotations into memory...
Done (t=0.35s)
creating index...
index created!
2022-03-27 17:16:46,472 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 17:16:46,473 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 17:16:46,473 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 17:16:46,473 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 17:19:33,522 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 27 days, 4:45:59, time: 3.340, data_time: 0.091, memory: 3519, loss_rpn_cls: 0.3411, loss_rpn_bbox: 0.0140, loss_cls: 1.4474, acc: 88.2754, loss_bbox: 0.0536, loss_mask: 0.5796, loss: 2.4357
2022-03-27 17:19:42,168 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 14 days, 7:15:34, time: 0.173, data_time: 0.001, memory: 3678, loss_rpn_cls: 0.0379, loss_rpn_bbox: 0.0050, loss_cls: 0.5542, acc: 95.7383, loss_bbox: 0.2439, loss_mask: 0.2167, loss: 1.0577
2022-03-27 17:19:50,029 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 23:03:31, time: 0.157, data_time: 0.001, memory: 3722, loss_rpn_cls: 0.0104, loss_rpn_bbox: 0.0034, loss_cls: 0.2463, acc: 98.8145, loss_bbox: 0.1021, loss_mask: 0.0982, loss: 0.4604
2022-03-27 17:19:58,718 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 19:46:43, time: 0.174, data_time: 0.001, memory: 3722, loss_rpn_cls: 0.0043, loss_rpn_bbox: 0.0049, loss_cls: 0.1436, acc: 98.9238, loss_bbox: 0.0734, loss_mask: 0.0745, loss: 0.3007
2022-03-27 17:20:06,365 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 12:11:03, time: 0.153, data_time: 0.001, memory: 3728, loss_rpn_cls: 0.0025, loss_rpn_bbox: 0.0047, loss_cls: 0.1589, acc: 99.1621, loss_bbox: 0.0697, loss_mask: 0.0622, loss: 0.2980
2022-03-27 17:20:14,059 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 15:09:03, time: 0.154, data_time: 0.001, memory: 3728, loss_rpn_cls: 0.0022, loss_rpn_bbox: 0.0047, loss_cls: 0.1058, acc: 99.2422, loss_bbox: 0.0578, loss_mask: 0.0549, loss: 0.2253
2022-03-27 17:20:22,904 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 5 days, 0:46:31, time: 0.177, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0038, loss_cls: 0.0530, acc: 99.3164, loss_bbox: 0.0548, loss_mask: 0.0517, loss: 0.1651
2022-03-27 17:20:30,511 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 13:23:00, time: 0.152, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0040, loss_cls: 0.0242, acc: 99.4238, loss_bbox: 0.0535, loss_mask: 0.0475, loss: 0.1309
2022-03-27 17:20:39,700 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 5:12:39, time: 0.184, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0035, loss_cls: 0.0194, acc: 99.4727, loss_bbox: 0.0469, loss_mask: 0.0435, loss: 0.1146
2022-03-27 17:20:47,185 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 22:00:34, time: 0.150, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0039, loss_cls: 0.0181, acc: 99.4570, loss_bbox: 0.0454, loss_mask: 0.0415, loss: 0.1101
2022-03-27 17:20:54,828 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 16:10:05, time: 0.153, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0036, loss_cls: 0.0171, acc: 99.4805, loss_bbox: 0.0425, loss_mask: 0.0371, loss: 0.1016
2022-03-27 17:21:03,086 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 11:30:11, time: 0.165, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0033, loss_cls: 0.0132, acc: 99.5938, loss_bbox: 0.0374, loss_mask: 0.0334, loss: 0.0884
2022-03-27 17:21:10,654 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 7:20:49, time: 0.151, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0026, loss_cls: 0.0109, acc: 99.6680, loss_bbox: 0.0351, loss_mask: 0.0310, loss: 0.0805
2022-03-27 17:21:18,684 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 3:54:52, time: 0.161, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0027, loss_cls: 0.0109, acc: 99.7012, loss_bbox: 0.0330, loss_mask: 0.0271, loss: 0.0745
2022-03-27 17:21:26,053 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 3 days, 0:46:02, time: 0.147, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0026, loss_cls: 0.0094, acc: 99.7500, loss_bbox: 0.0300, loss_mask: 0.0259, loss: 0.0687
2022-03-27 17:21:33,400 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 22:00:23, time: 0.147, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0024, loss_cls: 0.0082, acc: 99.7617, loss_bbox: 0.0281, loss_mask: 0.0243, loss: 0.0637
2022-03-27 17:21:41,511 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 19:44:47, time: 0.162, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0025, loss_cls: 0.0074, acc: 99.7969, loss_bbox: 0.0271, loss_mask: 0.0234, loss: 0.0610
2022-03-27 17:21:48,974 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 17:35:48, time: 0.149, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0022, loss_cls: 0.0078, acc: 99.7363, loss_bbox: 0.0256, loss_mask: 0.0225, loss: 0.0588
2022-03-27 17:21:56,293 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 15:38:39, time: 0.146, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0024, loss_cls: 0.0089, acc: 99.7168, loss_bbox: 0.0245, loss_mask: 0.0218, loss: 0.0582
2022-03-27 17:22:04,810 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 14:07:09, time: 0.170, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0022, loss_cls: 0.0069, acc: 99.7734, loss_bbox: 0.0228, loss_mask: 0.0203, loss: 0.0528
2022-03-27 17:22:12,508 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 12:35:14, time: 0.154, data_time: 0.002, memory: 3747, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0019, loss_cls: 0.0075, acc: 99.7910, loss_bbox: 0.0208, loss_mask: 0.0200, loss: 0.0507
2022-03-27 17:22:21,055 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 11:20:45, time: 0.171, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0087, acc: 99.7422, loss_bbox: 0.0222, loss_mask: 0.0191, loss: 0.0525
2022-03-27 17:22:28,873 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 10:05:16, time: 0.156, data_time: 0.001, memory: 3747, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0071, acc: 99.8027, loss_bbox: 0.0203, loss_mask: 0.0194, loss: 0.0491
2022-03-27 17:22:36,495 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 8:54:11, time: 0.152, data_time: 0.001, memory: 3761, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0023, loss_cls: 0.0085, acc: 99.7363, loss_bbox: 0.0208, loss_mask: 0.0198, loss: 0.0520
2022-03-27 17:22:45,102 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 7:57:57, time: 0.172, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0069, acc: 99.7969, loss_bbox: 0.0204, loss_mask: 0.0187, loss: 0.0486
2022-03-27 17:22:52,755 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 6:57:29, time: 0.153, data_time: 0.002, memory: 3790, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0065, acc: 99.8125, loss_bbox: 0.0202, loss_mask: 0.0187, loss: 0.0480
2022-03-27 17:23:01,365 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 6:09:44, time: 0.172, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0063, acc: 99.8242, loss_bbox: 0.0199, loss_mask: 0.0172, loss: 0.0456
2022-03-27 17:23:09,594 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 5:22:17, time: 0.165, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0063, acc: 99.8008, loss_bbox: 0.0176, loss_mask: 0.0165, loss: 0.0427
2022-03-27 17:23:17,185 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 4:32:54, time: 0.152, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0053, acc: 99.8242, loss_bbox: 0.0186, loss_mask: 0.0162, loss: 0.0424
2022-03-27 17:23:25,525 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 3:52:38, time: 0.167, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0040, acc: 99.8828, loss_bbox: 0.0169, loss_mask: 0.0154, loss: 0.0384
2022-03-27 17:23:33,591 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 3:12:54, time: 0.161, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0038, acc: 99.9043, loss_bbox: 0.0159, loss_mask: 0.0150, loss: 0.0368
2022-03-27 17:23:41,917 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 2:37:32, time: 0.167, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0043, acc: 99.8691, loss_bbox: 0.0175, loss_mask: 0.0145, loss: 0.0383
2022-03-27 17:23:49,971 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 2 days, 2:02:24, time: 0.161, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0041, acc: 99.8828, loss_bbox: 0.0160, loss_mask: 0.0140, loss: 0.0360
2022-03-27 17:23:57,538 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 2 days, 1:25:56, time: 0.151, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0032, acc: 99.9082, loss_bbox: 0.0180, loss_mask: 0.0142, loss: 0.0374
2022-03-27 17:24:05,904 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 2 days, 0:56:56, time: 0.167, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0040, acc: 99.9004, loss_bbox: 0.0160, loss_mask: 0.0143, loss: 0.0362
2022-03-27 17:24:13,608 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 2 days, 0:25:09, time: 0.154, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0043, acc: 99.8613, loss_bbox: 0.0164, loss_mask: 0.0155, loss: 0.0381
2022-03-27 17:24:22,287 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 2 days, 0:01:21, time: 0.174, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0018, loss_cls: 0.0034, acc: 99.9121, loss_bbox: 0.0154, loss_mask: 0.0143, loss: 0.0352
2022-03-27 17:24:29,918 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 23:32:15, time: 0.153, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0049, acc: 99.8398, loss_bbox: 0.0160, loss_mask: 0.0146, loss: 0.0375
2022-03-27 17:24:37,792 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 23:06:11, time: 0.158, data_time: 0.001, memory: 3790, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0034, acc: 99.8965, loss_bbox: 0.0153, loss_mask: 0.0143, loss: 0.0350
2022-03-27 17:24:46,782 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 22:47:54, time: 0.180, data_time: 0.001, memory: 3807, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0047, acc: 99.8691, loss_bbox: 0.0151, loss_mask: 0.0145, loss: 0.0363
2022-03-27 17:24:54,428 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 22:22:46, time: 0.153, data_time: 0.001, memory: 3810, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0040, acc: 99.8965, loss_bbox: 0.0151, loss_mask: 0.0135, loss: 0.0346
2022-03-27 17:25:02,529 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 22:01:28, time: 0.162, data_time: 0.001, memory: 3810, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0040, acc: 99.8691, loss_bbox: 0.0142, loss_mask: 0.0129, loss: 0.0328
2022-03-27 17:25:10,169 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 21:38:33, time: 0.153, data_time: 0.001, memory: 3810, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0043, acc: 99.8750, loss_bbox: 0.0133, loss_mask: 0.0125, loss: 0.0317
2022-03-27 17:25:18,806 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 21:21:21, time: 0.170, data_time: 0.001, memory: 3810, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0033, acc: 99.8828, loss_bbox: 0.0136, loss_mask: 0.0125, loss: 0.0311
2022-03-27 17:25:22,259 - mmdet - INFO - __benchmark_total_time(h):0.1433769381708569
2022-03-27 17:25:22,260 - mmdet - INFO - __benchmark_pure_training_time(h):0.14327384650707245
2022-03-27 17:25:22,261 - mmdet - INFO - __benchmark_avg_iter_time(s):0.16262011642341728
2022-03-27 17:25:22,261 - mmdet - INFO - __benchmark_mem_alloc(mb):3761
2022-03-27 17:25:22,261 - mmdet - INFO - __benchmark_mem_cached(mb):5648
[SH-IDC1-10-142-5-213][[4585,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 17:25:37,579 [32mINFO[0m: log service ip address is: 10.142.5.213:50204[0m
2022-03-27 17:25:37,580 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 17:26:22,642 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 17:26:22,644 - mmdet - INFO - Distributed training: False
2022-03-27 17:26:23,552 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 17:26:23,655 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 17:26:23,656 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 17:26:24,020 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=12.47s)
creating index...
index created!
loading annotations into memory...
Done (t=0.36s)
creating index...
index created!
2022-03-27 17:26:39,523 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 17:26:39,524 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 17:26:39,524 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 17:26:39,524 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 17:29:24,049 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 26 days, 18:53:09, time: 3.290, data_time: 0.089, memory: 3608, loss_rpn_cls: 0.3392, loss_rpn_bbox: 0.0146, loss_cls: 1.5152, acc: 88.3887, loss_bbox: 0.0886, loss_mask: 0.5910, loss: 2.5485
2022-03-27 17:29:32,223 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 14 days, 1:23:54, time: 0.164, data_time: 0.001, memory: 3649, loss_rpn_cls: 0.0306, loss_rpn_bbox: 0.0051, loss_cls: 0.4963, acc: 96.2285, loss_bbox: 0.2159, loss_mask: 0.2199, loss: 0.9678
2022-03-27 17:29:40,269 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 19:23:39, time: 0.161, data_time: 0.001, memory: 3656, loss_rpn_cls: 0.0072, loss_rpn_bbox: 0.0042, loss_cls: 0.1408, acc: 99.0449, loss_bbox: 0.0857, loss_mask: 0.0890, loss: 0.3268
2022-03-27 17:29:47,777 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 15:52:11, time: 0.150, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0033, loss_rpn_bbox: 0.0043, loss_cls: 0.1115, acc: 99.1230, loss_bbox: 0.0688, loss_mask: 0.0697, loss: 0.2576
2022-03-27 17:29:55,819 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 9:22:10, time: 0.161, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0022, loss_rpn_bbox: 0.0044, loss_cls: 0.1308, acc: 99.3320, loss_bbox: 0.0658, loss_mask: 0.0597, loss: 0.2630
2022-03-27 17:30:03,687 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 12:55:14, time: 0.157, data_time: 0.001, memory: 3697, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0047, loss_cls: 0.2137, acc: 99.3945, loss_bbox: 0.0581, loss_mask: 0.0521, loss: 0.3304
2022-03-27 17:30:11,492 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 22:16:57, time: 0.156, data_time: 0.001, memory: 3697, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0039, loss_cls: 0.0502, acc: 99.3418, loss_bbox: 0.0556, loss_mask: 0.0502, loss: 0.1618
2022-03-27 17:30:19,170 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 11:14:09, time: 0.153, data_time: 0.001, memory: 3698, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0037, loss_cls: 0.0222, acc: 99.3906, loss_bbox: 0.0526, loss_mask: 0.0459, loss: 0.1259
2022-03-27 17:30:26,590 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 2:32:14, time: 0.149, data_time: 0.001, memory: 3706, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0045, loss_cls: 0.0189, acc: 99.4863, loss_bbox: 0.0512, loss_mask: 0.0423, loss: 0.1187
2022-03-27 17:30:35,021 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 19:58:13, time: 0.169, data_time: 0.001, memory: 3706, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0032, loss_cls: 0.0150, acc: 99.5566, loss_bbox: 0.0418, loss_mask: 0.0387, loss: 0.1004
2022-03-27 17:30:42,600 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 14:17:30, time: 0.151, data_time: 0.001, memory: 3706, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0036, loss_cls: 0.0142, acc: 99.6035, loss_bbox: 0.0403, loss_mask: 0.0346, loss: 0.0941
2022-03-27 17:30:50,925 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 9:48:23, time: 0.167, data_time: 0.001, memory: 3709, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0030, loss_cls: 0.0113, acc: 99.6934, loss_bbox: 0.0381, loss_mask: 0.0322, loss: 0.0856
2022-03-27 17:30:58,355 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 5:44:24, time: 0.149, data_time: 0.001, memory: 3709, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0028, loss_cls: 0.0095, acc: 99.7266, loss_bbox: 0.0322, loss_mask: 0.0290, loss: 0.0745
2022-03-27 17:31:06,387 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 2:25:15, time: 0.161, data_time: 0.001, memory: 3709, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0027, loss_cls: 0.0087, acc: 99.7344, loss_bbox: 0.0309, loss_mask: 0.0287, loss: 0.0718
2022-03-27 17:31:14,827 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 23:39:11, time: 0.169, data_time: 0.001, memory: 3715, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0025, loss_cls: 0.0108, acc: 99.6914, loss_bbox: 0.0305, loss_mask: 0.0262, loss: 0.0710
2022-03-27 17:31:22,808 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 21:06:59, time: 0.160, data_time: 0.001, memory: 3715, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0025, loss_cls: 0.0083, acc: 99.7559, loss_bbox: 0.0266, loss_mask: 0.0242, loss: 0.0622
2022-03-27 17:31:30,922 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 18:54:34, time: 0.162, data_time: 0.001, memory: 3715, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0024, loss_cls: 0.0090, acc: 99.7148, loss_bbox: 0.0259, loss_mask: 0.0230, loss: 0.0612
2022-03-27 17:31:38,381 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 16:48:23, time: 0.149, data_time: 0.001, memory: 3715, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0021, loss_cls: 0.0066, acc: 99.7949, loss_bbox: 0.0262, loss_mask: 0.0228, loss: 0.0585
2022-03-27 17:31:46,109 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 14:58:39, time: 0.154, data_time: 0.001, memory: 3715, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0067, acc: 99.7969, loss_bbox: 0.0238, loss_mask: 0.0216, loss: 0.0547
2022-03-27 17:31:54,844 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 13:31:46, time: 0.175, data_time: 0.001, memory: 3723, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0064, acc: 99.7871, loss_bbox: 0.0228, loss_mask: 0.0212, loss: 0.0530
2022-03-27 17:32:02,654 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 12:02:48, time: 0.156, data_time: 0.001, memory: 3723, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0067, acc: 99.7949, loss_bbox: 0.0211, loss_mask: 0.0195, loss: 0.0497
2022-03-27 17:32:11,115 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 10:48:51, time: 0.169, data_time: 0.001, memory: 3723, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0022, loss_cls: 0.0049, acc: 99.8555, loss_bbox: 0.0213, loss_mask: 0.0188, loss: 0.0477
2022-03-27 17:32:18,785 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 9:33:14, time: 0.153, data_time: 0.001, memory: 3723, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0021, loss_cls: 0.0063, acc: 99.8145, loss_bbox: 0.0211, loss_mask: 0.0188, loss: 0.0488
2022-03-27 17:32:26,319 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 8:22:39, time: 0.151, data_time: 0.001, memory: 3744, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0063, acc: 99.8086, loss_bbox: 0.0216, loss_mask: 0.0179, loss: 0.0481
2022-03-27 17:32:34,872 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 7:27:10, time: 0.171, data_time: 0.001, memory: 3744, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0050, acc: 99.8301, loss_bbox: 0.0217, loss_mask: 0.0178, loss: 0.0470
2022-03-27 17:32:42,523 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 6:27:53, time: 0.153, data_time: 0.002, memory: 3744, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0051, acc: 99.8477, loss_bbox: 0.0211, loss_mask: 0.0169, loss: 0.0453
2022-03-27 17:32:50,640 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 5:37:01, time: 0.162, data_time: 0.001, memory: 3744, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0059, acc: 99.8145, loss_bbox: 0.0173, loss_mask: 0.0165, loss: 0.0417
2022-03-27 17:32:57,928 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 4:42:49, time: 0.146, data_time: 0.001, memory: 3744, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0051, acc: 99.8418, loss_bbox: 0.0189, loss_mask: 0.0161, loss: 0.0422
2022-03-27 17:33:05,803 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 3:57:02, time: 0.157, data_time: 0.001, memory: 3752, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0039, acc: 99.8926, loss_bbox: 0.0170, loss_mask: 0.0157, loss: 0.0386
2022-03-27 17:33:13,890 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 3:16:04, time: 0.162, data_time: 0.001, memory: 3752, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0057, acc: 99.8242, loss_bbox: 0.0189, loss_mask: 0.0163, loss: 0.0431
2022-03-27 17:33:21,681 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 2:35:23, time: 0.156, data_time: 0.001, memory: 3752, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0036, acc: 99.8887, loss_bbox: 0.0157, loss_mask: 0.0152, loss: 0.0368
2022-03-27 17:33:29,805 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 1:59:46, time: 0.163, data_time: 0.001, memory: 3752, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0041, acc: 99.8691, loss_bbox: 0.0169, loss_mask: 0.0159, loss: 0.0391
2022-03-27 17:33:37,033 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 2 days, 1:19:54, time: 0.145, data_time: 0.001, memory: 3752, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0052, acc: 99.8555, loss_bbox: 0.0158, loss_mask: 0.0155, loss: 0.0383
2022-03-27 17:33:45,077 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 2 days, 0:47:57, time: 0.161, data_time: 0.001, memory: 3752, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0057, acc: 99.8066, loss_bbox: 0.0173, loss_mask: 0.0149, loss: 0.0399
2022-03-27 17:33:53,176 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 2 days, 0:18:16, time: 0.162, data_time: 0.001, memory: 3791, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0056, acc: 99.8203, loss_bbox: 0.0168, loss_mask: 0.0146, loss: 0.0388
2022-03-27 17:34:01,051 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 23:48:41, time: 0.157, data_time: 0.001, memory: 3791, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0057, acc: 99.8379, loss_bbox: 0.0187, loss_mask: 0.0155, loss: 0.0422
2022-03-27 17:34:08,466 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 23:17:52, time: 0.148, data_time: 0.001, memory: 3791, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0049, acc: 99.8262, loss_bbox: 0.0167, loss_mask: 0.0147, loss: 0.0382
2022-03-27 17:34:16,367 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 22:51:38, time: 0.158, data_time: 0.001, memory: 3791, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0018, loss_cls: 0.0033, acc: 99.8906, loss_bbox: 0.0165, loss_mask: 0.0148, loss: 0.0367
2022-03-27 17:34:24,210 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 22:26:20, time: 0.157, data_time: 0.001, memory: 3791, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0056, acc: 99.8340, loss_bbox: 0.0157, loss_mask: 0.0144, loss: 0.0376
2022-03-27 17:34:32,196 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 22:03:12, time: 0.160, data_time: 0.001, memory: 3791, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0046, acc: 99.8496, loss_bbox: 0.0169, loss_mask: 0.0140, loss: 0.0373
2022-03-27 17:34:40,035 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 21:40:17, time: 0.157, data_time: 0.001, memory: 3793, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0044, acc: 99.8398, loss_bbox: 0.0141, loss_mask: 0.0131, loss: 0.0332
2022-03-27 17:34:47,500 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 21:16:27, time: 0.149, data_time: 0.001, memory: 3793, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0057, acc: 99.7773, loss_bbox: 0.0152, loss_mask: 0.0140, loss: 0.0367
2022-03-27 17:34:55,429 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 20:56:13, time: 0.159, data_time: 0.001, memory: 3793, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0048, acc: 99.8535, loss_bbox: 0.0140, loss_mask: 0.0135, loss: 0.0342
2022-03-27 17:35:03,687 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 20:38:35, time: 0.165, data_time: 0.001, memory: 3793, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0050, acc: 99.8359, loss_bbox: 0.0146, loss_mask: 0.0136, loss: 0.0351
2022-03-27 17:35:06,686 - mmdet - INFO - __benchmark_total_time(h):0.14098456985420652
2022-03-27 17:35:06,687 - mmdet - INFO - __benchmark_pure_training_time(h):0.14087824039989047
2022-03-27 17:35:06,688 - mmdet - INFO - __benchmark_avg_iter_time(s):0.1574084415778771
2022-03-27 17:35:06,688 - mmdet - INFO - __benchmark_mem_alloc(mb):3744
2022-03-27 17:35:06,688 - mmdet - INFO - __benchmark_mem_cached(mb):5648
[SH-IDC1-10-142-5-213][[12673,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 17:35:22,743 [32mINFO[0m: log service ip address is: 10.142.5.213:23579[0m
2022-03-27 17:35:22,744 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 17:36:06,478 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 17:36:06,479 - mmdet - INFO - Distributed training: False
2022-03-27 17:36:07,317 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 17:36:07,402 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 17:36:07,403 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 17:36:07,759 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.72s)
creating index...
index created!
loading annotations into memory...
Done (t=0.37s)
creating index...
index created!
2022-03-27 17:36:21,433 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 17:36:21,434 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 17:36:21,435 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 17:36:21,435 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 17:39:09,836 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 27 days, 10:03:31, time: 3.367, data_time: 0.090, memory: 3463, loss_rpn_cls: 0.3823, loss_rpn_bbox: 0.0152, loss_cls: 1.3690, acc: 88.0039, loss_bbox: 0.0492, loss_mask: 0.5882, loss: 2.4039
2022-03-27 17:39:17,530 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 14 days, 8:02:51, time: 0.154, data_time: 0.001, memory: 3594, loss_rpn_cls: 0.0367, loss_rpn_bbox: 0.0047, loss_cls: 0.4923, acc: 96.4473, loss_bbox: 0.1835, loss_mask: 0.2130, loss: 0.9302
2022-03-27 17:39:25,944 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 10 days, 0:18:14, time: 0.168, data_time: 0.001, memory: 3655, loss_rpn_cls: 0.0089, loss_rpn_bbox: 0.0042, loss_cls: 0.2330, acc: 98.8457, loss_bbox: 0.0910, loss_mask: 0.0954, loss: 0.4325
2022-03-27 17:39:33,520 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 19:37:03, time: 0.152, data_time: 0.001, memory: 3655, loss_rpn_cls: 0.0034, loss_rpn_bbox: 0.0047, loss_cls: 0.1460, acc: 99.1523, loss_bbox: 0.0670, loss_mask: 0.0690, loss: 0.2902
2022-03-27 17:39:42,306 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 12:56:58, time: 0.176, data_time: 0.001, memory: 3655, loss_rpn_cls: 0.0023, loss_rpn_bbox: 0.0059, loss_cls: 0.1434, acc: 99.1660, loss_bbox: 0.0628, loss_mask: 0.0589, loss: 0.2733
2022-03-27 17:39:50,046 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 15:49:14, time: 0.155, data_time: 0.001, memory: 3655, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0045, loss_cls: 0.0918, acc: 99.3047, loss_bbox: 0.0563, loss_mask: 0.0501, loss: 0.2046
2022-03-27 17:39:57,711 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 5 days, 0:41:23, time: 0.153, data_time: 0.001, memory: 3655, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0041, loss_cls: 0.0388, acc: 99.3926, loss_bbox: 0.0533, loss_mask: 0.0470, loss: 0.1451
2022-03-27 17:40:06,292 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 13:47:12, time: 0.172, data_time: 0.001, memory: 3655, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0042, loss_cls: 0.0234, acc: 99.4082, loss_bbox: 0.0543, loss_mask: 0.0484, loss: 0.1321
2022-03-27 17:40:14,020 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 4:55:59, time: 0.154, data_time: 0.001, memory: 3655, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0037, loss_cls: 0.0200, acc: 99.4258, loss_bbox: 0.0478, loss_mask: 0.0404, loss: 0.1133
2022-03-27 17:40:22,875 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 22:17:31, time: 0.177, data_time: 0.001, memory: 3655, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0030, loss_cls: 0.0123, acc: 99.6406, loss_bbox: 0.0421, loss_mask: 0.0366, loss: 0.0952
2022-03-27 17:40:30,579 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 16:26:57, time: 0.154, data_time: 0.001, memory: 3655, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0034, loss_cls: 0.0181, acc: 99.4375, loss_bbox: 0.0381, loss_mask: 0.0350, loss: 0.0957
2022-03-27 17:40:38,356 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 11:36:16, time: 0.156, data_time: 0.001, memory: 3682, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0034, loss_cls: 0.0164, acc: 99.4844, loss_bbox: 0.0398, loss_mask: 0.0334, loss: 0.0940
2022-03-27 17:40:46,753 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 7:41:26, time: 0.168, data_time: 0.001, memory: 3682, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0030, loss_cls: 0.0098, acc: 99.6973, loss_bbox: 0.0324, loss_mask: 0.0291, loss: 0.0755
2022-03-27 17:40:54,870 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 4:15:20, time: 0.162, data_time: 0.001, memory: 3682, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0025, loss_cls: 0.0129, acc: 99.5859, loss_bbox: 0.0323, loss_mask: 0.0272, loss: 0.0758
2022-03-27 17:41:03,304 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 3 days, 1:21:50, time: 0.169, data_time: 0.001, memory: 3682, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0024, loss_cls: 0.0124, acc: 99.6211, loss_bbox: 0.0293, loss_mask: 0.0259, loss: 0.0708
2022-03-27 17:41:11,406 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 22:44:58, time: 0.162, data_time: 0.001, memory: 3682, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0027, loss_cls: 0.0097, acc: 99.6875, loss_bbox: 0.0275, loss_mask: 0.0246, loss: 0.0652
2022-03-27 17:41:18,861 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 20:17:44, time: 0.149, data_time: 0.001, memory: 3682, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0025, loss_cls: 0.0079, acc: 99.7852, loss_bbox: 0.0290, loss_mask: 0.0240, loss: 0.0641
2022-03-27 17:41:27,194 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 18:18:15, time: 0.167, data_time: 0.001, memory: 3682, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0025, loss_cls: 0.0078, acc: 99.7715, loss_bbox: 0.0278, loss_mask: 0.0218, loss: 0.0606
2022-03-27 17:41:34,710 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 16:21:11, time: 0.150, data_time: 0.002, memory: 3714, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0023, loss_cls: 0.0072, acc: 99.7734, loss_bbox: 0.0258, loss_mask: 0.0208, loss: 0.0567
2022-03-27 17:41:43,195 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 14:47:14, time: 0.170, data_time: 0.001, memory: 3714, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0023, loss_cls: 0.0083, acc: 99.7305, loss_bbox: 0.0239, loss_mask: 0.0206, loss: 0.0557
2022-03-27 17:41:50,773 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 13:12:07, time: 0.152, data_time: 0.001, memory: 3714, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0049, acc: 99.8613, loss_bbox: 0.0215, loss_mask: 0.0186, loss: 0.0476
2022-03-27 17:41:58,317 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 11:45:16, time: 0.151, data_time: 0.001, memory: 3714, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0058, acc: 99.8301, loss_bbox: 0.0214, loss_mask: 0.0189, loss: 0.0483
2022-03-27 17:42:06,648 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 10:33:53, time: 0.167, data_time: 0.001, memory: 3714, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0073, acc: 99.7988, loss_bbox: 0.0213, loss_mask: 0.0187, loss: 0.0497
2022-03-27 17:42:14,350 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 9:22:24, time: 0.154, data_time: 0.002, memory: 3724, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0059, acc: 99.8066, loss_bbox: 0.0210, loss_mask: 0.0181, loss: 0.0474
2022-03-27 17:42:22,890 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 8:24:26, time: 0.171, data_time: 0.001, memory: 3724, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0020, loss_cls: 0.0052, acc: 99.8535, loss_bbox: 0.0212, loss_mask: 0.0176, loss: 0.0464
2022-03-27 17:42:30,520 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 7:22:43, time: 0.153, data_time: 0.001, memory: 3724, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0044, acc: 99.8633, loss_bbox: 0.0194, loss_mask: 0.0175, loss: 0.0436
2022-03-27 17:42:37,915 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 6:23:33, time: 0.148, data_time: 0.001, memory: 3724, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0021, loss_cls: 0.0060, acc: 99.8105, loss_bbox: 0.0217, loss_mask: 0.0173, loss: 0.0475
2022-03-27 17:42:45,589 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 5:30:54, time: 0.153, data_time: 0.001, memory: 3724, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0054, acc: 99.8457, loss_bbox: 0.0197, loss_mask: 0.0166, loss: 0.0441
2022-03-27 17:42:53,213 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 4:41:29, time: 0.152, data_time: 0.002, memory: 3744, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0052, acc: 99.8105, loss_bbox: 0.0190, loss_mask: 0.0159, loss: 0.0423
2022-03-27 17:43:01,518 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 4:00:41, time: 0.166, data_time: 0.001, memory: 3744, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0048, acc: 99.8340, loss_bbox: 0.0182, loss_mask: 0.0154, loss: 0.0405
2022-03-27 17:43:09,083 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 3:16:55, time: 0.151, data_time: 0.001, memory: 3744, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0045, acc: 99.8340, loss_bbox: 0.0178, loss_mask: 0.0150, loss: 0.0393
2022-03-27 17:43:16,790 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 2:36:53, time: 0.154, data_time: 0.001, memory: 3744, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0059, acc: 99.8281, loss_bbox: 0.0175, loss_mask: 0.0152, loss: 0.0408
2022-03-27 17:43:25,354 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 2 days, 2:05:23, time: 0.171, data_time: 0.001, memory: 3744, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0055, acc: 99.7949, loss_bbox: 0.0167, loss_mask: 0.0147, loss: 0.0389
2022-03-27 17:43:33,096 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 2 days, 1:30:02, time: 0.155, data_time: 0.001, memory: 3744, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0057, acc: 99.8496, loss_bbox: 0.0166, loss_mask: 0.0144, loss: 0.0386
2022-03-27 17:43:41,142 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 2 days, 0:58:45, time: 0.161, data_time: 0.001, memory: 3772, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0043, acc: 99.8633, loss_bbox: 0.0178, loss_mask: 0.0150, loss: 0.0392
2022-03-27 17:43:48,282 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 2 days, 0:23:20, time: 0.143, data_time: 0.001, memory: 3792, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0053, acc: 99.8281, loss_bbox: 0.0178, loss_mask: 0.0139, loss: 0.0389
2022-03-27 17:43:56,125 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 23:54:14, time: 0.157, data_time: 0.001, memory: 3792, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0058, acc: 99.7949, loss_bbox: 0.0166, loss_mask: 0.0139, loss: 0.0382
2022-03-27 17:44:04,114 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 23:27:34, time: 0.160, data_time: 0.001, memory: 3792, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0061, acc: 99.8066, loss_bbox: 0.0178, loss_mask: 0.0143, loss: 0.0401
2022-03-27 17:44:11,996 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 23:01:38, time: 0.158, data_time: 0.001, memory: 3792, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0059, acc: 99.8184, loss_bbox: 0.0178, loss_mask: 0.0147, loss: 0.0405
2022-03-27 17:44:19,670 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 22:35:46, time: 0.153, data_time: 0.001, memory: 3792, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0040, acc: 99.8652, loss_bbox: 0.0177, loss_mask: 0.0135, loss: 0.0369
2022-03-27 17:44:28,387 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 22:17:05, time: 0.174, data_time: 0.001, memory: 3797, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0045, acc: 99.8613, loss_bbox: 0.0172, loss_mask: 0.0137, loss: 0.0373
2022-03-27 17:44:36,195 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 21:54:13, time: 0.156, data_time: 0.001, memory: 3808, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0035, acc: 99.8984, loss_bbox: 0.0165, loss_mask: 0.0130, loss: 0.0348
2022-03-27 17:44:44,964 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 21:37:40, time: 0.175, data_time: 0.001, memory: 3808, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0048, acc: 99.8594, loss_bbox: 0.0161, loss_mask: 0.0132, loss: 0.0360
2022-03-27 17:44:52,533 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 21:15:28, time: 0.151, data_time: 0.001, memory: 3808, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0038, acc: 99.8965, loss_bbox: 0.0165, loss_mask: 0.0132, loss: 0.0354
2022-03-27 17:44:55,688 - mmdet - INFO - __benchmark_total_time(h):0.14295661634869045
2022-03-27 17:44:55,689 - mmdet - INFO - __benchmark_pure_training_time(h):0.14284810331132677
2022-03-27 17:44:55,690 - mmdet - INFO - __benchmark_avg_iter_time(s):0.1581975063243946
2022-03-27 17:44:55,691 - mmdet - INFO - __benchmark_mem_alloc(mb):3724
2022-03-27 17:44:55,691 - mmdet - INFO - __benchmark_mem_cached(mb):5648
[SH-IDC1-10-142-5-213][[53816,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 17:45:12,349 [32mINFO[0m: log service ip address is: 10.142.5.213:21103[0m
2022-03-27 17:45:12,350 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 17:45:57,554 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 17:45:57,555 - mmdet - INFO - Distributed training: False
2022-03-27 17:45:58,372 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 17:45:58,473 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 17:45:58,474 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 17:45:58,839 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.50s)
creating index...
index created!
loading annotations into memory...
Done (t=0.36s)
creating index...
index created!
2022-03-27 17:46:12,303 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 17:46:12,305 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 17:46:12,305 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 17:46:12,305 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 17:48:58,227 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 27 days, 0:21:44, time: 3.318, data_time: 0.090, memory: 3514, loss_rpn_cls: 0.3583, loss_rpn_bbox: 0.0127, loss_cls: 1.3647, acc: 86.3320, loss_bbox: 0.0974, loss_mask: 0.5756, loss: 2.4088
2022-03-27 17:49:05,995 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 14 days, 3:20:01, time: 0.155, data_time: 0.001, memory: 3639, loss_rpn_cls: 0.0305, loss_rpn_bbox: 0.0047, loss_cls: 0.2989, acc: 96.4961, loss_bbox: 0.2065, loss_mask: 0.2265, loss: 0.7672
2022-03-27 17:49:13,961 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 20:34:59, time: 0.159, data_time: 0.001, memory: 3667, loss_rpn_cls: 0.0071, loss_rpn_bbox: 0.0042, loss_cls: 0.1249, acc: 98.9434, loss_bbox: 0.1040, loss_mask: 0.0976, loss: 0.3378
2022-03-27 17:49:21,780 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 17:03:44, time: 0.156, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0033, loss_rpn_bbox: 0.0050, loss_cls: 0.0965, acc: 99.1953, loss_bbox: 0.0748, loss_mask: 0.0707, loss: 0.2503
2022-03-27 17:49:29,274 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 9:53:57, time: 0.150, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0023, loss_rpn_bbox: 0.0046, loss_cls: 0.1091, acc: 99.1621, loss_bbox: 0.0639, loss_mask: 0.0621, loss: 0.2420
2022-03-27 17:49:37,906 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 13:51:34, time: 0.173, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0044, loss_cls: 0.1004, acc: 99.2383, loss_bbox: 0.0583, loss_mask: 0.0523, loss: 0.2171
2022-03-27 17:49:45,518 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 22:58:42, time: 0.152, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0039, loss_cls: 0.1324, acc: 99.2695, loss_bbox: 0.0514, loss_mask: 0.0492, loss: 0.2386
2022-03-27 17:49:54,176 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 12:19:23, time: 0.173, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0040, loss_cls: 0.0631, acc: 99.5020, loss_bbox: 0.0503, loss_mask: 0.0452, loss: 0.1641
2022-03-27 17:50:01,794 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 3:35:21, time: 0.152, data_time: 0.002, memory: 3699, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0034, loss_cls: 0.0320, acc: 99.4492, loss_bbox: 0.0469, loss_mask: 0.0414, loss: 0.1252
2022-03-27 17:50:09,473 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 20:37:26, time: 0.154, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0035, loss_cls: 0.0212, acc: 99.4453, loss_bbox: 0.0425, loss_mask: 0.0385, loss: 0.1077
2022-03-27 17:50:17,336 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 14:59:13, time: 0.157, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0028, loss_cls: 0.0165, acc: 99.5430, loss_bbox: 0.0389, loss_mask: 0.0346, loss: 0.0940
2022-03-27 17:50:25,356 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 10:20:40, time: 0.161, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0031, loss_cls: 0.0131, acc: 99.6074, loss_bbox: 0.0339, loss_mask: 0.0313, loss: 0.0823
2022-03-27 17:50:33,164 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 6:20:59, time: 0.156, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0029, loss_cls: 0.0104, acc: 99.6836, loss_bbox: 0.0325, loss_mask: 0.0276, loss: 0.0744
2022-03-27 17:50:41,532 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 3:04:54, time: 0.167, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0026, loss_cls: 0.0092, acc: 99.7324, loss_bbox: 0.0287, loss_mask: 0.0268, loss: 0.0680
2022-03-27 17:50:49,434 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 3 days, 0:07:44, time: 0.158, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0023, loss_cls: 0.0089, acc: 99.7363, loss_bbox: 0.0275, loss_mask: 0.0252, loss: 0.0647
2022-03-27 17:50:57,593 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 21:36:19, time: 0.163, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0022, loss_cls: 0.0080, acc: 99.7344, loss_bbox: 0.0233, loss_mask: 0.0239, loss: 0.0580
2022-03-27 17:51:06,068 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 19:27:14, time: 0.170, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0022, loss_cls: 0.0080, acc: 99.7832, loss_bbox: 0.0229, loss_mask: 0.0228, loss: 0.0566
2022-03-27 17:51:14,257 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 17:28:39, time: 0.164, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0022, loss_cls: 0.0079, acc: 99.7695, loss_bbox: 0.0205, loss_mask: 0.0214, loss: 0.0528
2022-03-27 17:51:22,748 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 15:46:16, time: 0.170, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0023, loss_cls: 0.0064, acc: 99.7852, loss_bbox: 0.0220, loss_mask: 0.0216, loss: 0.0529
2022-03-27 17:51:30,889 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 14:09:29, time: 0.162, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0023, loss_cls: 0.0061, acc: 99.8223, loss_bbox: 0.0204, loss_mask: 0.0206, loss: 0.0499
2022-03-27 17:51:38,649 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 12:38:43, time: 0.156, data_time: 0.002, memory: 3699, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0020, loss_cls: 0.0076, acc: 99.7656, loss_bbox: 0.0208, loss_mask: 0.0207, loss: 0.0517
2022-03-27 17:51:47,145 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 11:23:28, time: 0.170, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0022, loss_cls: 0.0072, acc: 99.7812, loss_bbox: 0.0202, loss_mask: 0.0196, loss: 0.0499
2022-03-27 17:51:55,435 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 10:12:41, time: 0.166, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0016, loss_cls: 0.0075, acc: 99.7910, loss_bbox: 0.0192, loss_mask: 0.0199, loss: 0.0488
2022-03-27 17:52:03,800 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 9:08:31, time: 0.167, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0017, loss_cls: 0.0064, acc: 99.7930, loss_bbox: 0.0171, loss_mask: 0.0184, loss: 0.0443
2022-03-27 17:52:12,013 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 8:08:04, time: 0.164, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0049, acc: 99.8359, loss_bbox: 0.0162, loss_mask: 0.0171, loss: 0.0404
2022-03-27 17:52:19,738 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 7:07:51, time: 0.155, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0045, acc: 99.8516, loss_bbox: 0.0156, loss_mask: 0.0165, loss: 0.0388
2022-03-27 17:52:27,596 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 6:13:13, time: 0.157, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0055, acc: 99.8066, loss_bbox: 0.0155, loss_mask: 0.0170, loss: 0.0402
2022-03-27 17:52:36,466 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 5:30:59, time: 0.177, data_time: 0.001, memory: 3699, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0047, acc: 99.8789, loss_bbox: 0.0160, loss_mask: 0.0159, loss: 0.0388
2022-03-27 17:52:44,467 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 4:44:33, time: 0.160, data_time: 0.001, memory: 3703, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0047, acc: 99.8535, loss_bbox: 0.0167, loss_mask: 0.0161, loss: 0.0396
2022-03-27 17:52:52,513 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 4:01:38, time: 0.161, data_time: 0.001, memory: 3703, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0057, acc: 99.8184, loss_bbox: 0.0158, loss_mask: 0.0163, loss: 0.0398
2022-03-27 17:53:00,167 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 3:18:33, time: 0.153, data_time: 0.001, memory: 3703, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0044, acc: 99.8496, loss_bbox: 0.0167, loss_mask: 0.0155, loss: 0.0388
2022-03-27 17:53:08,429 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 2:42:30, time: 0.165, data_time: 0.001, memory: 3703, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0049, acc: 99.8594, loss_bbox: 0.0163, loss_mask: 0.0153, loss: 0.0385
2022-03-27 17:53:16,633 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 2 days, 2:08:16, time: 0.164, data_time: 0.001, memory: 3703, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0042, acc: 99.8809, loss_bbox: 0.0165, loss_mask: 0.0150, loss: 0.0377
2022-03-27 17:53:24,505 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 2 days, 1:33:47, time: 0.158, data_time: 0.001, memory: 3720, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0045, acc: 99.8535, loss_bbox: 0.0158, loss_mask: 0.0147, loss: 0.0372
2022-03-27 17:53:33,245 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 2 days, 1:06:59, time: 0.175, data_time: 0.001, memory: 3742, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0042, acc: 99.8828, loss_bbox: 0.0153, loss_mask: 0.0140, loss: 0.0354
2022-03-27 17:53:41,115 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 2 days, 0:36:04, time: 0.157, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0050, acc: 99.8496, loss_bbox: 0.0141, loss_mask: 0.0135, loss: 0.0343
2022-03-27 17:53:48,875 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 2 days, 0:06:07, time: 0.155, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0068, acc: 99.8242, loss_bbox: 0.0146, loss_mask: 0.0140, loss: 0.0375
2022-03-27 17:53:57,528 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 23:43:13, time: 0.173, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0044, acc: 99.8652, loss_bbox: 0.0139, loss_mask: 0.0136, loss: 0.0339
2022-03-27 17:54:05,459 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 23:17:09, time: 0.159, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0034, acc: 99.8984, loss_bbox: 0.0141, loss_mask: 0.0135, loss: 0.0328
2022-03-27 17:54:14,364 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 22:58:06, time: 0.178, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0053, acc: 99.8359, loss_bbox: 0.0147, loss_mask: 0.0132, loss: 0.0351
2022-03-27 17:54:22,412 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 22:35:04, time: 0.161, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0042, acc: 99.8652, loss_bbox: 0.0138, loss_mask: 0.0129, loss: 0.0326
2022-03-27 17:54:30,051 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 22:10:52, time: 0.153, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0041, acc: 99.8809, loss_bbox: 0.0146, loss_mask: 0.0130, loss: 0.0336
2022-03-27 17:54:38,928 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 21:54:30, time: 0.178, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0028, acc: 99.9160, loss_bbox: 0.0143, loss_mask: 0.0120, loss: 0.0307
2022-03-27 17:54:46,736 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 21:33:11, time: 0.156, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0012, loss_cls: 0.0046, acc: 99.8535, loss_bbox: 0.0128, loss_mask: 0.0116, loss: 0.0304
2022-03-27 17:54:50,067 - mmdet - INFO - __benchmark_total_time(h):0.14392825139893425
2022-03-27 17:54:50,067 - mmdet - INFO - __benchmark_pure_training_time(h):0.14382258150312635
2022-03-27 17:54:50,069 - mmdet - INFO - __benchmark_avg_iter_time(s):0.16295292851450918
2022-03-27 17:54:50,069 - mmdet - INFO - __benchmark_mem_alloc(mb):3699
2022-03-27 17:54:50,069 - mmdet - INFO - __benchmark_mem_cached(mb):5616
[SH-IDC1-10-142-5-213][[63356,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 17:55:06,693 [32mINFO[0m: log service ip address is: 10.142.5.213:48919[0m
2022-03-27 17:55:06,694 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 17:55:49,649 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 17:55:49,651 - mmdet - INFO - Distributed training: False
2022-03-27 17:55:50,552 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 17:55:50,631 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 17:55:50,631 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 17:55:50,980 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=11.69s)
creating index...
index created!
loading annotations into memory...
Done (t=0.50s)
creating index...
index created!
2022-03-27 17:56:06,047 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 17:56:06,049 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 17:56:06,049 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 17:56:06,050 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 17:58:47,264 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 26 days, 5:57:29, time: 3.223, data_time: 0.089, memory: 3559, loss_rpn_cls: 0.3775, loss_rpn_bbox: 0.0140, loss_cls: 1.0274, acc: 89.9375, loss_bbox: 0.1039, loss_mask: 0.6669, loss: 2.1897
2022-03-27 17:58:55,402 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 18:51:43, time: 0.163, data_time: 0.001, memory: 3630, loss_rpn_cls: 0.0333, loss_rpn_bbox: 0.0062, loss_cls: 0.5341, acc: 95.4590, loss_bbox: 0.2224, loss_mask: 0.2731, loss: 1.0690
2022-03-27 17:59:03,235 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 14:45:45, time: 0.157, data_time: 0.001, memory: 3630, loss_rpn_cls: 0.0101, loss_rpn_bbox: 0.0039, loss_cls: 0.3467, acc: 98.8945, loss_bbox: 0.0911, loss_mask: 0.1073, loss: 0.5592
2022-03-27 17:59:10,866 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 12:30:59, time: 0.153, data_time: 0.001, memory: 3630, loss_rpn_cls: 0.0032, loss_rpn_bbox: 0.0049, loss_cls: 0.1515, acc: 99.2266, loss_bbox: 0.0611, loss_mask: 0.0711, loss: 0.2918
2022-03-27 17:59:19,215 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 6:55:38, time: 0.167, data_time: 0.001, memory: 3630, loss_rpn_cls: 0.0024, loss_rpn_bbox: 0.0057, loss_cls: 0.0898, acc: 99.2539, loss_bbox: 0.0616, loss_mask: 0.0631, loss: 0.2226
2022-03-27 17:59:27,433 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 11:06:45, time: 0.164, data_time: 0.001, memory: 3637, loss_rpn_cls: 0.0023, loss_rpn_bbox: 0.0043, loss_cls: 0.0604, acc: 99.4844, loss_bbox: 0.0537, loss_mask: 0.0556, loss: 0.1762
2022-03-27 17:59:35,805 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 21:02:51, time: 0.167, data_time: 0.001, memory: 3637, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0037, loss_cls: 0.0569, acc: 99.4375, loss_bbox: 0.0463, loss_mask: 0.0516, loss: 0.1605
2022-03-27 17:59:43,333 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 10:05:04, time: 0.151, data_time: 0.001, memory: 3647, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0039, loss_cls: 0.0495, acc: 99.4355, loss_bbox: 0.0451, loss_mask: 0.0442, loss: 0.1443
2022-03-27 17:59:51,013 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 1:37:32, time: 0.154, data_time: 0.001, memory: 3651, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0036, loss_cls: 0.0272, acc: 99.4863, loss_bbox: 0.0437, loss_mask: 0.0460, loss: 0.1223
2022-03-27 17:59:59,802 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 19:17:19, time: 0.176, data_time: 0.001, memory: 3655, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0032, loss_cls: 0.0185, acc: 99.5723, loss_bbox: 0.0434, loss_mask: 0.0386, loss: 0.1052
2022-03-27 18:00:09,042 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 14:15:46, time: 0.185, data_time: 0.001, memory: 3667, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0031, loss_cls: 0.0145, acc: 99.5938, loss_bbox: 0.0399, loss_mask: 0.0352, loss: 0.0939
2022-03-27 18:00:16,619 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 9:32:12, time: 0.152, data_time: 0.001, memory: 3667, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0032, loss_cls: 0.0121, acc: 99.6523, loss_bbox: 0.0328, loss_mask: 0.0315, loss: 0.0807
2022-03-27 18:00:25,203 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 5:50:10, time: 0.172, data_time: 0.001, memory: 3667, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0025, loss_cls: 0.0094, acc: 99.7559, loss_bbox: 0.0284, loss_mask: 0.0286, loss: 0.0700
2022-03-27 18:00:32,752 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 2:22:42, time: 0.151, data_time: 0.001, memory: 3667, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0028, loss_cls: 0.0094, acc: 99.7910, loss_bbox: 0.0288, loss_mask: 0.0285, loss: 0.0704
2022-03-27 18:00:40,206 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 23:21:18, time: 0.149, data_time: 0.001, memory: 3681, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0027, loss_cls: 0.0073, acc: 99.8145, loss_bbox: 0.0271, loss_mask: 0.0256, loss: 0.0637
2022-03-27 18:00:49,229 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 21:05:29, time: 0.180, data_time: 0.001, memory: 3681, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0023, loss_cls: 0.0081, acc: 99.7754, loss_bbox: 0.0266, loss_mask: 0.0243, loss: 0.0621
2022-03-27 18:00:56,764 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 18:45:16, time: 0.151, data_time: 0.001, memory: 3681, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0023, loss_cls: 0.0115, acc: 99.6855, loss_bbox: 0.0264, loss_mask: 0.0234, loss: 0.0644
2022-03-27 18:01:05,105 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 16:50:56, time: 0.167, data_time: 0.001, memory: 3681, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0024, loss_cls: 0.0094, acc: 99.7207, loss_bbox: 0.0268, loss_mask: 0.0236, loss: 0.0629
2022-03-27 18:01:12,548 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 14:57:40, time: 0.149, data_time: 0.001, memory: 3693, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0019, loss_cls: 0.0085, acc: 99.7578, loss_bbox: 0.0218, loss_mask: 0.0209, loss: 0.0537
2022-03-27 18:01:20,098 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 13:16:57, time: 0.151, data_time: 0.001, memory: 3709, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0070, acc: 99.7969, loss_bbox: 0.0233, loss_mask: 0.0203, loss: 0.0531
2022-03-27 18:01:28,822 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 11:58:49, time: 0.174, data_time: 0.001, memory: 3709, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0020, loss_cls: 0.0061, acc: 99.8203, loss_bbox: 0.0207, loss_mask: 0.0198, loss: 0.0493
2022-03-27 18:01:36,450 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 10:36:15, time: 0.153, data_time: 0.001, memory: 3709, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0019, loss_cls: 0.0077, acc: 99.7949, loss_bbox: 0.0203, loss_mask: 0.0189, loss: 0.0495
2022-03-27 18:01:44,369 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 9:23:42, time: 0.158, data_time: 0.001, memory: 3709, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0064, acc: 99.8027, loss_bbox: 0.0185, loss_mask: 0.0179, loss: 0.0451
2022-03-27 18:01:51,851 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 8:13:00, time: 0.150, data_time: 0.001, memory: 3741, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0022, loss_cls: 0.0062, acc: 99.8086, loss_bbox: 0.0213, loss_mask: 0.0181, loss: 0.0487
2022-03-27 18:01:59,349 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 7:08:06, time: 0.150, data_time: 0.001, memory: 3743, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0017, loss_cls: 0.0067, acc: 99.7949, loss_bbox: 0.0191, loss_mask: 0.0174, loss: 0.0454
2022-03-27 18:02:08,069 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 6:19:04, time: 0.174, data_time: 0.001, memory: 3743, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0065, acc: 99.8340, loss_bbox: 0.0176, loss_mask: 0.0172, loss: 0.0434
2022-03-27 18:02:15,561 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 5:23:08, time: 0.150, data_time: 0.001, memory: 3743, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0050, acc: 99.8555, loss_bbox: 0.0186, loss_mask: 0.0178, loss: 0.0439
2022-03-27 18:02:23,906 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 4:38:13, time: 0.167, data_time: 0.001, memory: 3743, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0029, acc: 99.9355, loss_bbox: 0.0190, loss_mask: 0.0158, loss: 0.0400
2022-03-27 18:02:31,440 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 3:49:58, time: 0.151, data_time: 0.001, memory: 3748, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0040, acc: 99.9023, loss_bbox: 0.0190, loss_mask: 0.0164, loss: 0.0416
2022-03-27 18:02:39,086 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 3:05:43, time: 0.153, data_time: 0.001, memory: 3748, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0037, acc: 99.9102, loss_bbox: 0.0181, loss_mask: 0.0151, loss: 0.0389
2022-03-27 18:02:47,182 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 2:27:42, time: 0.162, data_time: 0.001, memory: 3748, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0035, acc: 99.8984, loss_bbox: 0.0181, loss_mask: 0.0149, loss: 0.0386
2022-03-27 18:02:54,800 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 1:48:37, time: 0.152, data_time: 0.001, memory: 3748, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0037, acc: 99.8984, loss_bbox: 0.0173, loss_mask: 0.0145, loss: 0.0376
2022-03-27 18:03:03,412 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 2 days, 1:18:52, time: 0.172, data_time: 0.001, memory: 3748, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0036, acc: 99.8906, loss_bbox: 0.0171, loss_mask: 0.0139, loss: 0.0367
2022-03-27 18:03:10,879 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 2 days, 0:43:04, time: 0.149, data_time: 0.001, memory: 3748, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0049, acc: 99.8418, loss_bbox: 0.0161, loss_mask: 0.0143, loss: 0.0373
2022-03-27 18:03:18,424 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 2 days, 0:09:44, time: 0.151, data_time: 0.001, memory: 3748, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0016, loss_cls: 0.0030, acc: 99.9160, loss_bbox: 0.0161, loss_mask: 0.0146, loss: 0.0358
2022-03-27 18:03:26,966 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 1 day, 23:44:46, time: 0.171, data_time: 0.001, memory: 3758, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0032, acc: 99.9297, loss_bbox: 0.0161, loss_mask: 0.0134, loss: 0.0344
2022-03-27 18:03:34,404 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 23:14:10, time: 0.149, data_time: 0.001, memory: 3758, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0030, acc: 99.9336, loss_bbox: 0.0171, loss_mask: 0.0134, loss: 0.0352
2022-03-27 18:03:42,750 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 22:50:05, time: 0.165, data_time: 0.001, memory: 3758, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0045, acc: 99.8594, loss_bbox: 0.0160, loss_mask: 0.0125, loss: 0.0346
2022-03-27 18:03:50,458 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 22:24:45, time: 0.156, data_time: 0.003, memory: 3758, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0012, loss_cls: 0.0024, acc: 99.9375, loss_bbox: 0.0147, loss_mask: 0.0123, loss: 0.0310
2022-03-27 18:03:57,827 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 21:57:59, time: 0.147, data_time: 0.001, memory: 3758, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0028, acc: 99.9238, loss_bbox: 0.0144, loss_mask: 0.0129, loss: 0.0318
2022-03-27 18:04:06,059 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 21:37:29, time: 0.165, data_time: 0.001, memory: 3795, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0028, acc: 99.9219, loss_bbox: 0.0141, loss_mask: 0.0122, loss: 0.0309
2022-03-27 18:04:14,113 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 21:16:57, time: 0.161, data_time: 0.001, memory: 3795, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0037, acc: 99.9043, loss_bbox: 0.0138, loss_mask: 0.0126, loss: 0.0317
2022-03-27 18:04:21,328 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 20:52:49, time: 0.144, data_time: 0.001, memory: 3795, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0037, acc: 99.8906, loss_bbox: 0.0139, loss_mask: 0.0120, loss: 0.0312
2022-03-27 18:04:29,669 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 20:35:44, time: 0.167, data_time: 0.001, memory: 3795, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0026, acc: 99.9434, loss_bbox: 0.0139, loss_mask: 0.0111, loss: 0.0291
2022-03-27 18:04:33,240 - mmdet - INFO - __benchmark_total_time(h):0.14103007131152684
2022-03-27 18:04:33,244 - mmdet - INFO - __benchmark_pure_training_time(h):0.140885229839219
2022-03-27 18:04:33,245 - mmdet - INFO - __benchmark_avg_iter_time(s):0.15785923323312126
2022-03-27 18:04:33,245 - mmdet - INFO - __benchmark_mem_alloc(mb):3741
2022-03-27 18:04:33,245 - mmdet - INFO - __benchmark_mem_cached(mb):5616
[SH-IDC1-10-142-5-213][[39725,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 18:04:48,973 [32mINFO[0m: log service ip address is: 10.142.5.213:46073[0m
2022-03-27 18:04:48,974 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 18:05:36,322 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 18:05:36,324 - mmdet - INFO - Distributed training: False
2022-03-27 18:05:37,215 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 18:05:37,321 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 18:05:37,321 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 18:05:37,759 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.32s)
creating index...
index created!
loading annotations into memory...
Done (t=0.35s)
creating index...
index created!
2022-03-27 18:05:50,909 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 18:05:50,910 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 18:05:50,910 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 18:05:50,910 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 18:08:36,861 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 27 days, 0:21:58, time: 3.318, data_time: 0.090, memory: 3490, loss_rpn_cls: 0.4146, loss_rpn_bbox: 0.0134, loss_cls: 1.4475, acc: 87.8574, loss_bbox: 0.0542, loss_mask: 0.6079, loss: 2.5376
2022-03-27 18:08:45,487 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 14 days, 5:00:34, time: 0.172, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0365, loss_rpn_bbox: 0.0064, loss_cls: 0.7765, acc: 95.8691, loss_bbox: 0.2326, loss_mask: 0.2406, loss: 1.2925
2022-03-27 18:08:53,828 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 22:11:30, time: 0.167, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0105, loss_rpn_bbox: 0.0036, loss_cls: 0.5069, acc: 99.1230, loss_bbox: 0.0898, loss_mask: 0.1019, loss: 0.7127
2022-03-27 18:09:01,422 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 18:03:07, time: 0.152, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0037, loss_rpn_bbox: 0.0047, loss_cls: 0.1760, acc: 99.1738, loss_bbox: 0.0672, loss_mask: 0.0762, loss: 0.3279
2022-03-27 18:09:09,590 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 11:12:56, time: 0.163, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0025, loss_rpn_bbox: 0.0042, loss_cls: 0.0349, acc: 99.3203, loss_bbox: 0.0571, loss_mask: 0.0632, loss: 0.1619
2022-03-27 18:09:17,233 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 14:18:39, time: 0.153, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0021, loss_rpn_bbox: 0.0047, loss_cls: 0.0234, acc: 99.3809, loss_bbox: 0.0503, loss_mask: 0.0541, loss: 0.1346
2022-03-27 18:09:25,837 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 23:55:09, time: 0.172, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0040, loss_cls: 0.0203, acc: 99.4023, loss_bbox: 0.0474, loss_mask: 0.0484, loss: 0.1219
2022-03-27 18:09:33,328 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 12:34:34, time: 0.150, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0039, loss_cls: 0.0164, acc: 99.5371, loss_bbox: 0.0425, loss_mask: 0.0425, loss: 0.1068
2022-03-27 18:09:40,847 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 3:46:25, time: 0.151, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0039, loss_cls: 0.0165, acc: 99.5234, loss_bbox: 0.0442, loss_mask: 0.0411, loss: 0.1071
2022-03-27 18:09:49,489 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 21:09:54, time: 0.173, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0035, loss_cls: 0.0145, acc: 99.5645, loss_bbox: 0.0374, loss_mask: 0.0387, loss: 0.0957
2022-03-27 18:09:57,184 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 15:25:07, time: 0.154, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0032, loss_cls: 0.0136, acc: 99.6250, loss_bbox: 0.0403, loss_mask: 0.0340, loss: 0.0924
2022-03-27 18:10:05,405 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 10:48:15, time: 0.164, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0031, loss_cls: 0.0112, acc: 99.6719, loss_bbox: 0.0353, loss_mask: 0.0325, loss: 0.0833
2022-03-27 18:10:13,033 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 6:43:14, time: 0.153, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0027, loss_cls: 0.0096, acc: 99.7188, loss_bbox: 0.0302, loss_mask: 0.0297, loss: 0.0731
2022-03-27 18:10:20,402 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 3:08:55, time: 0.147, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0029, loss_cls: 0.0090, acc: 99.7344, loss_bbox: 0.0295, loss_mask: 0.0274, loss: 0.0698
2022-03-27 18:10:28,933 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 3 days, 0:21:16, time: 0.171, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0022, loss_cls: 0.0068, acc: 99.7988, loss_bbox: 0.0230, loss_mask: 0.0245, loss: 0.0572
2022-03-27 18:10:36,370 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 21:38:25, time: 0.149, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0025, loss_cls: 0.0120, acc: 99.6152, loss_bbox: 0.0267, loss_mask: 0.0243, loss: 0.0663
2022-03-27 18:10:44,720 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 19:27:31, time: 0.167, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0023, loss_cls: 0.0113, acc: 99.7109, loss_bbox: 0.0281, loss_mask: 0.0237, loss: 0.0662
2022-03-27 18:10:52,078 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 17:18:07, time: 0.147, data_time: 0.001, memory: 3685, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0024, loss_cls: 0.0091, acc: 99.7090, loss_bbox: 0.0244, loss_mask: 0.0221, loss: 0.0586
2022-03-27 18:10:59,439 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 15:22:17, time: 0.147, data_time: 0.001, memory: 3723, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0023, loss_cls: 0.0132, acc: 99.6074, loss_bbox: 0.0258, loss_mask: 0.0223, loss: 0.0642
2022-03-27 18:11:07,972 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 13:51:55, time: 0.171, data_time: 0.001, memory: 3723, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0019, loss_cls: 0.0113, acc: 99.6133, loss_bbox: 0.0230, loss_mask: 0.0214, loss: 0.0581
2022-03-27 18:11:15,489 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 12:18:41, time: 0.150, data_time: 0.001, memory: 3723, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0022, loss_cls: 0.0111, acc: 99.6816, loss_bbox: 0.0247, loss_mask: 0.0207, loss: 0.0594
2022-03-27 18:11:23,959 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 11:04:10, time: 0.169, data_time: 0.001, memory: 3723, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0096, acc: 99.6895, loss_bbox: 0.0227, loss_mask: 0.0198, loss: 0.0546
2022-03-27 18:11:31,261 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 9:44:10, time: 0.146, data_time: 0.001, memory: 3723, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0067, acc: 99.7930, loss_bbox: 0.0220, loss_mask: 0.0196, loss: 0.0508
2022-03-27 18:11:38,806 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 8:33:07, time: 0.151, data_time: 0.001, memory: 3742, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0092, acc: 99.7070, loss_bbox: 0.0217, loss_mask: 0.0188, loss: 0.0522
2022-03-27 18:11:47,483 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 7:38:28, time: 0.174, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0088, acc: 99.7246, loss_bbox: 0.0221, loss_mask: 0.0182, loss: 0.0517
2022-03-27 18:11:55,097 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 6:38:21, time: 0.152, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0096, acc: 99.6699, loss_bbox: 0.0199, loss_mask: 0.0178, loss: 0.0500
2022-03-27 18:12:03,864 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 5:52:42, time: 0.175, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0076, acc: 99.7715, loss_bbox: 0.0210, loss_mask: 0.0174, loss: 0.0482
2022-03-27 18:12:11,106 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 4:57:36, time: 0.145, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0090, acc: 99.6738, loss_bbox: 0.0185, loss_mask: 0.0173, loss: 0.0470
2022-03-27 18:12:18,793 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 4:09:50, time: 0.154, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0067, acc: 99.7598, loss_bbox: 0.0177, loss_mask: 0.0159, loss: 0.0424
2022-03-27 18:12:27,222 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 3:31:04, time: 0.169, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0087, acc: 99.6992, loss_bbox: 0.0197, loss_mask: 0.0171, loss: 0.0478
2022-03-27 18:12:34,887 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 2:48:57, time: 0.153, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0052, acc: 99.8438, loss_bbox: 0.0177, loss_mask: 0.0159, loss: 0.0408
2022-03-27 18:12:42,377 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 2:08:16, time: 0.150, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0068, acc: 99.7461, loss_bbox: 0.0172, loss_mask: 0.0160, loss: 0.0419
2022-03-27 18:12:50,958 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 2 days, 1:37:44, time: 0.172, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0063, acc: 99.7891, loss_bbox: 0.0170, loss_mask: 0.0151, loss: 0.0404
2022-03-27 18:12:58,747 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 2 days, 1:03:31, time: 0.156, data_time: 0.001, memory: 3749, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0049, acc: 99.8105, loss_bbox: 0.0181, loss_mask: 0.0155, loss: 0.0407
2022-03-27 18:13:07,197 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 2 days, 0:35:43, time: 0.169, data_time: 0.001, memory: 3789, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0054, acc: 99.8066, loss_bbox: 0.0181, loss_mask: 0.0148, loss: 0.0405
2022-03-27 18:13:14,903 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 2 days, 0:04:34, time: 0.154, data_time: 0.001, memory: 3789, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0049, acc: 99.8457, loss_bbox: 0.0183, loss_mask: 0.0143, loss: 0.0396
2022-03-27 18:13:22,459 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 23:34:12, time: 0.151, data_time: 0.001, memory: 3789, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0048, acc: 99.8281, loss_bbox: 0.0166, loss_mask: 0.0137, loss: 0.0371
2022-03-27 18:13:31,040 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 23:11:43, time: 0.172, data_time: 0.001, memory: 3789, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0068, acc: 99.7656, loss_bbox: 0.0166, loss_mask: 0.0142, loss: 0.0395
2022-03-27 18:13:38,750 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 22:45:06, time: 0.154, data_time: 0.001, memory: 3789, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0060, acc: 99.8047, loss_bbox: 0.0176, loss_mask: 0.0134, loss: 0.0388
2022-03-27 18:13:46,925 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 22:22:36, time: 0.164, data_time: 0.001, memory: 3789, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0056, acc: 99.7695, loss_bbox: 0.0144, loss_mask: 0.0131, loss: 0.0347
2022-03-27 18:13:54,895 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 21:59:59, time: 0.159, data_time: 0.001, memory: 3797, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0056, acc: 99.8145, loss_bbox: 0.0155, loss_mask: 0.0128, loss: 0.0357
2022-03-27 18:14:02,355 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 21:35:38, time: 0.149, data_time: 0.001, memory: 3797, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0068, acc: 99.7695, loss_bbox: 0.0148, loss_mask: 0.0130, loss: 0.0364
2022-03-27 18:14:10,488 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 21:16:01, time: 0.163, data_time: 0.001, memory: 3797, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0063, acc: 99.7832, loss_bbox: 0.0146, loss_mask: 0.0129, loss: 0.0354
2022-03-27 18:14:18,450 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 20:56:25, time: 0.159, data_time: 0.001, memory: 3797, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0073, acc: 99.7617, loss_bbox: 0.0155, loss_mask: 0.0132, loss: 0.0378
2022-03-27 18:14:21,627 - mmdet - INFO - __benchmark_total_time(h):0.1419691515631146
2022-03-27 18:14:21,628 - mmdet - INFO - __benchmark_pure_training_time(h):0.14186589631769392
2022-03-27 18:14:21,629 - mmdet - INFO - __benchmark_avg_iter_time(s):0.15967675879761412
2022-03-27 18:14:21,629 - mmdet - INFO - __benchmark_mem_alloc(mb):3742
2022-03-27 18:14:21,630 - mmdet - INFO - __benchmark_mem_cached(mb):5648
[SH-IDC1-10-142-5-213][[49129,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 18:14:38,849 [32mINFO[0m: log service ip address is: 10.142.5.213:17727[0m
2022-03-27 18:14:38,850 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 18:15:25,900 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 18:15:25,902 - mmdet - INFO - Distributed training: False
2022-03-27 18:15:26,793 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 18:15:26,882 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 18:15:26,882 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 18:15:27,243 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.51s)
creating index...
index created!
loading annotations into memory...
Done (t=0.35s)
creating index...
index created!
2022-03-27 18:15:40,726 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 18:15:40,727 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 18:15:40,727 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 18:15:40,727 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 18:18:21,663 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 26 days, 4:51:54, time: 3.218, data_time: 0.089, memory: 3466, loss_rpn_cls: 0.3901, loss_rpn_bbox: 0.0139, loss_cls: 1.4197, acc: 88.5312, loss_bbox: 0.0672, loss_mask: 0.5930, loss: 2.4840
2022-03-27 18:18:29,750 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 18:12:49, time: 0.162, data_time: 0.001, memory: 3648, loss_rpn_cls: 0.0351, loss_rpn_bbox: 0.0063, loss_cls: 0.5812, acc: 95.4609, loss_bbox: 0.2321, loss_mask: 0.2764, loss: 1.1312
2022-03-27 18:18:38,345 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 15:19:22, time: 0.172, data_time: 0.001, memory: 3695, loss_rpn_cls: 0.0112, loss_rpn_bbox: 0.0045, loss_cls: 0.1608, acc: 98.7930, loss_bbox: 0.1155, loss_mask: 0.1038, loss: 0.3957
2022-03-27 18:18:46,694 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 13:38:21, time: 0.167, data_time: 0.001, memory: 3695, loss_rpn_cls: 0.0040, loss_rpn_bbox: 0.0047, loss_cls: 0.1250, acc: 99.0684, loss_bbox: 0.0743, loss_mask: 0.0717, loss: 0.2796
2022-03-27 18:18:55,270 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 7:59:57, time: 0.171, data_time: 0.001, memory: 3695, loss_rpn_cls: 0.0027, loss_rpn_bbox: 0.0046, loss_cls: 0.1483, acc: 99.2090, loss_bbox: 0.0689, loss_mask: 0.0629, loss: 0.2875
2022-03-27 18:19:03,284 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 11:52:45, time: 0.160, data_time: 0.001, memory: 3695, loss_rpn_cls: 0.0023, loss_rpn_bbox: 0.0045, loss_cls: 0.1345, acc: 99.2598, loss_bbox: 0.0576, loss_mask: 0.0535, loss: 0.2523
2022-03-27 18:19:11,204 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 21:27:08, time: 0.158, data_time: 0.001, memory: 3695, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0040, loss_cls: 0.0392, acc: 99.3242, loss_bbox: 0.0542, loss_mask: 0.0521, loss: 0.1514
2022-03-27 18:19:19,940 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 11:01:29, time: 0.175, data_time: 0.001, memory: 3697, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0037, loss_cls: 0.0239, acc: 99.3340, loss_bbox: 0.0493, loss_mask: 0.0444, loss: 0.1230
2022-03-27 18:19:27,752 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 2:31:10, time: 0.156, data_time: 0.001, memory: 3706, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0033, loss_cls: 0.0174, acc: 99.5000, loss_bbox: 0.0439, loss_mask: 0.0403, loss: 0.1062
2022-03-27 18:19:36,734 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 20:10:06, time: 0.180, data_time: 0.001, memory: 3706, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0039, loss_cls: 0.0168, acc: 99.4766, loss_bbox: 0.0440, loss_mask: 0.0398, loss: 0.1060
2022-03-27 18:19:44,710 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 14:37:00, time: 0.160, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0036, loss_cls: 0.0179, acc: 99.4863, loss_bbox: 0.0452, loss_mask: 0.0374, loss: 0.1054
2022-03-27 18:19:52,475 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 9:55:14, time: 0.155, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0032, loss_cls: 0.0150, acc: 99.5410, loss_bbox: 0.0377, loss_mask: 0.0334, loss: 0.0905
2022-03-27 18:20:01,518 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 6:19:41, time: 0.181, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0026, loss_cls: 0.0094, acc: 99.7129, loss_bbox: 0.0321, loss_mask: 0.0301, loss: 0.0754
2022-03-27 18:20:09,392 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 2:55:31, time: 0.158, data_time: 0.002, memory: 3730, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0029, loss_cls: 0.0079, acc: 99.7793, loss_bbox: 0.0295, loss_mask: 0.0277, loss: 0.0689
2022-03-27 18:20:18,111 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 3 days, 0:11:38, time: 0.174, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0025, loss_cls: 0.0092, acc: 99.7129, loss_bbox: 0.0275, loss_mask: 0.0257, loss: 0.0657
2022-03-27 18:20:25,808 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 21:33:23, time: 0.154, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0023, loss_cls: 0.0082, acc: 99.7578, loss_bbox: 0.0294, loss_mask: 0.0245, loss: 0.0654
2022-03-27 18:20:34,636 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 19:29:10, time: 0.176, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0024, loss_cls: 0.0090, acc: 99.7285, loss_bbox: 0.0264, loss_mask: 0.0238, loss: 0.0622
2022-03-27 18:20:42,386 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 17:24:51, time: 0.155, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0024, loss_cls: 0.0082, acc: 99.7539, loss_bbox: 0.0245, loss_mask: 0.0227, loss: 0.0583
2022-03-27 18:20:50,086 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 15:32:54, time: 0.154, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0022, loss_cls: 0.0069, acc: 99.7988, loss_bbox: 0.0242, loss_mask: 0.0216, loss: 0.0556
2022-03-27 18:20:58,614 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 14:01:50, time: 0.171, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0022, loss_cls: 0.0070, acc: 99.8008, loss_bbox: 0.0227, loss_mask: 0.0216, loss: 0.0540
2022-03-27 18:21:06,193 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 12:28:53, time: 0.152, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0057, acc: 99.8125, loss_bbox: 0.0217, loss_mask: 0.0196, loss: 0.0494
2022-03-27 18:21:15,186 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 11:19:24, time: 0.180, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0022, loss_cls: 0.0096, acc: 99.7109, loss_bbox: 0.0215, loss_mask: 0.0197, loss: 0.0535
2022-03-27 18:21:22,906 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 10:03:04, time: 0.155, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0018, loss_cls: 0.0073, acc: 99.7969, loss_bbox: 0.0206, loss_mask: 0.0192, loss: 0.0495
2022-03-27 18:21:30,607 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 8:52:47, time: 0.154, data_time: 0.001, memory: 3739, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0019, loss_cls: 0.0083, acc: 99.7871, loss_bbox: 0.0210, loss_mask: 0.0202, loss: 0.0520
2022-03-27 18:21:39,547 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 7:59:42, time: 0.179, data_time: 0.001, memory: 3739, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0018, loss_cls: 0.0053, acc: 99.8633, loss_bbox: 0.0193, loss_mask: 0.0193, loss: 0.0463
2022-03-27 18:21:47,286 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 6:59:59, time: 0.155, data_time: 0.001, memory: 3739, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0047, acc: 99.8652, loss_bbox: 0.0195, loss_mask: 0.0185, loss: 0.0452
2022-03-27 18:21:56,294 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 6:15:35, time: 0.180, data_time: 0.001, memory: 3739, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0039, acc: 99.8867, loss_bbox: 0.0170, loss_mask: 0.0166, loss: 0.0396
2022-03-27 18:22:03,972 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 5:23:19, time: 0.154, data_time: 0.001, memory: 3739, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0050, acc: 99.8594, loss_bbox: 0.0190, loss_mask: 0.0167, loss: 0.0429
2022-03-27 18:22:12,011 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 4:37:31, time: 0.161, data_time: 0.001, memory: 3753, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0049, acc: 99.8652, loss_bbox: 0.0188, loss_mask: 0.0159, loss: 0.0417
2022-03-27 18:22:20,697 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 3:59:46, time: 0.174, data_time: 0.001, memory: 3753, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0058, acc: 99.8301, loss_bbox: 0.0177, loss_mask: 0.0164, loss: 0.0422
2022-03-27 18:22:28,611 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 3:18:41, time: 0.158, data_time: 0.001, memory: 3753, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0016, loss_cls: 0.0056, acc: 99.8145, loss_bbox: 0.0163, loss_mask: 0.0159, loss: 0.0399
2022-03-27 18:22:37,236 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 2:45:18, time: 0.172, data_time: 0.001, memory: 3753, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0049, acc: 99.8613, loss_bbox: 0.0178, loss_mask: 0.0156, loss: 0.0403
2022-03-27 18:22:45,059 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 2 days, 2:08:16, time: 0.156, data_time: 0.001, memory: 3753, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0056, acc: 99.8145, loss_bbox: 0.0170, loss_mask: 0.0153, loss: 0.0399
2022-03-27 18:22:52,675 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 2 days, 1:32:01, time: 0.152, data_time: 0.001, memory: 3753, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0060, acc: 99.8164, loss_bbox: 0.0167, loss_mask: 0.0154, loss: 0.0402
2022-03-27 18:23:00,993 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 2 days, 1:02:28, time: 0.166, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0040, acc: 99.9004, loss_bbox: 0.0159, loss_mask: 0.0152, loss: 0.0370
2022-03-27 18:23:08,714 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 2 days, 0:30:43, time: 0.154, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0039, acc: 99.8848, loss_bbox: 0.0149, loss_mask: 0.0144, loss: 0.0351
2022-03-27 18:23:17,468 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 2 days, 0:07:09, time: 0.175, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0032, acc: 99.9004, loss_bbox: 0.0151, loss_mask: 0.0141, loss: 0.0341
2022-03-27 18:23:25,133 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 23:38:12, time: 0.153, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0029, acc: 99.8945, loss_bbox: 0.0150, loss_mask: 0.0135, loss: 0.0333
2022-03-27 18:23:32,840 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 23:10:55, time: 0.154, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0032, acc: 99.9141, loss_bbox: 0.0159, loss_mask: 0.0136, loss: 0.0345
2022-03-27 18:23:41,550 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 22:50:51, time: 0.174, data_time: 0.001, memory: 3794, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0034, acc: 99.9102, loss_bbox: 0.0151, loss_mask: 0.0133, loss: 0.0335
2022-03-27 18:23:49,371 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 22:26:43, time: 0.156, data_time: 0.001, memory: 3794, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0034, acc: 99.8926, loss_bbox: 0.0152, loss_mask: 0.0145, loss: 0.0352
2022-03-27 18:23:58,133 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 22:08:56, time: 0.175, data_time: 0.001, memory: 3794, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0033, acc: 99.8887, loss_bbox: 0.0142, loss_mask: 0.0132, loss: 0.0325
2022-03-27 18:24:05,488 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 21:44:22, time: 0.147, data_time: 0.001, memory: 3794, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0034, acc: 99.8867, loss_bbox: 0.0157, loss_mask: 0.0144, loss: 0.0354
2022-03-27 18:24:12,968 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 21:21:33, time: 0.150, data_time: 0.001, memory: 3794, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0018, acc: 99.9590, loss_bbox: 0.0152, loss_mask: 0.0141, loss: 0.0330
2022-03-27 18:24:17,295 - mmdet - INFO - __benchmark_total_time(h):0.14359363456567129
2022-03-27 18:24:17,299 - mmdet - INFO - __benchmark_pure_training_time(h):0.14349035693539514
2022-03-27 18:24:17,301 - mmdet - INFO - __benchmark_avg_iter_time(s):0.16238520385978464
2022-03-27 18:24:17,301 - mmdet - INFO - __benchmark_mem_alloc(mb):3739
2022-03-27 18:24:17,301 - mmdet - INFO - __benchmark_mem_cached(mb):5648
[SH-IDC1-10-142-5-213][[25597,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 18:24:33,144 [32mINFO[0m: log service ip address is: 10.142.5.213:26277[0m
2022-03-27 18:24:33,145 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 18:25:18,871 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 18:25:18,873 - mmdet - INFO - Distributed training: False
2022-03-27 18:25:19,700 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 18:25:19,820 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 18:25:19,822 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 18:25:20,287 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=10.52s)
creating index...
index created!
loading annotations into memory...
Done (t=0.34s)
creating index...
index created!
2022-03-27 18:25:33,548 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 18:25:33,550 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 18:25:33,550 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 18:25:33,550 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 18:28:14,553 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 26 days, 5:08:11, time: 3.219, data_time: 0.091, memory: 3562, loss_rpn_cls: 0.3926, loss_rpn_bbox: 0.0126, loss_cls: 1.9654, acc: 87.0879, loss_bbox: 0.0875, loss_mask: 0.6423, loss: 3.1005
2022-03-27 18:28:22,489 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 18:03:27, time: 0.159, data_time: 0.001, memory: 3667, loss_rpn_cls: 0.0374, loss_rpn_bbox: 0.0050, loss_cls: 0.5275, acc: 95.7305, loss_bbox: 0.2278, loss_mask: 0.2827, loss: 1.0803
2022-03-27 18:28:31,591 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 15:52:23, time: 0.182, data_time: 0.001, memory: 3695, loss_rpn_cls: 0.0095, loss_rpn_bbox: 0.0033, loss_cls: 0.1600, acc: 98.7559, loss_bbox: 0.1046, loss_mask: 0.1103, loss: 0.3878
2022-03-27 18:28:39,540 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 13:39:21, time: 0.159, data_time: 0.001, memory: 3695, loss_rpn_cls: 0.0027, loss_rpn_bbox: 0.0042, loss_cls: 0.0852, acc: 99.2051, loss_bbox: 0.0670, loss_mask: 0.0728, loss: 0.2319
2022-03-27 18:28:48,468 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 8:17:29, time: 0.179, data_time: 0.001, memory: 3695, loss_rpn_cls: 0.0025, loss_rpn_bbox: 0.0052, loss_cls: 0.0869, acc: 99.1836, loss_bbox: 0.0577, loss_mask: 0.0654, loss: 0.2177
2022-03-27 18:28:56,404 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 12:04:09, time: 0.159, data_time: 0.001, memory: 3695, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0040, loss_cls: 0.0901, acc: 99.3574, loss_bbox: 0.0549, loss_mask: 0.0555, loss: 0.2065
2022-03-27 18:29:04,929 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 21:57:15, time: 0.171, data_time: 0.001, memory: 3695, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0038, loss_cls: 0.0783, acc: 99.4668, loss_bbox: 0.0486, loss_mask: 0.0500, loss: 0.1822
2022-03-27 18:29:12,795 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 11:02:38, time: 0.157, data_time: 0.001, memory: 3695, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0035, loss_cls: 0.0286, acc: 99.4316, loss_bbox: 0.0502, loss_mask: 0.0467, loss: 0.1309
2022-03-27 18:29:20,696 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 2:34:15, time: 0.158, data_time: 0.001, memory: 3710, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0036, loss_cls: 0.0216, acc: 99.4414, loss_bbox: 0.0497, loss_mask: 0.0428, loss: 0.1192
2022-03-27 18:29:29,240 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 20:02:41, time: 0.171, data_time: 0.001, memory: 3710, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0038, loss_cls: 0.0136, acc: 99.6230, loss_bbox: 0.0421, loss_mask: 0.0380, loss: 0.0991
2022-03-27 18:29:37,118 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 14:28:05, time: 0.158, data_time: 0.001, memory: 3710, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0032, loss_cls: 0.0159, acc: 99.5332, loss_bbox: 0.0382, loss_mask: 0.0340, loss: 0.0926
2022-03-27 18:29:45,446 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 9:58:04, time: 0.167, data_time: 0.001, memory: 3710, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0027, loss_cls: 0.0121, acc: 99.6328, loss_bbox: 0.0353, loss_mask: 0.0310, loss: 0.0823
2022-03-27 18:29:53,295 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 6:00:55, time: 0.157, data_time: 0.001, memory: 3710, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0030, loss_cls: 0.0140, acc: 99.5879, loss_bbox: 0.0317, loss_mask: 0.0303, loss: 0.0797
2022-03-27 18:30:01,825 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 2:48:57, time: 0.171, data_time: 0.001, memory: 3710, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0024, loss_cls: 0.0140, acc: 99.5625, loss_bbox: 0.0326, loss_mask: 0.0283, loss: 0.0784
2022-03-27 18:30:09,932 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 23:56:05, time: 0.162, data_time: 0.001, memory: 3710, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0026, loss_cls: 0.0122, acc: 99.5977, loss_bbox: 0.0296, loss_mask: 0.0275, loss: 0.0727
2022-03-27 18:30:18,377 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 21:29:40, time: 0.169, data_time: 0.001, memory: 3710, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0025, loss_cls: 0.0104, acc: 99.6777, loss_bbox: 0.0277, loss_mask: 0.0258, loss: 0.0673
2022-03-27 18:30:26,752 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 19:19:28, time: 0.167, data_time: 0.001, memory: 3710, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0021, loss_cls: 0.0095, acc: 99.6758, loss_bbox: 0.0250, loss_mask: 0.0235, loss: 0.0610
2022-03-27 18:30:34,983 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 17:21:54, time: 0.165, data_time: 0.001, memory: 3710, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0025, loss_cls: 0.0104, acc: 99.6387, loss_bbox: 0.0254, loss_mask: 0.0234, loss: 0.0624
2022-03-27 18:30:42,694 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 15:30:18, time: 0.154, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0020, loss_cls: 0.0094, acc: 99.6934, loss_bbox: 0.0241, loss_mask: 0.0225, loss: 0.0587
2022-03-27 18:30:50,796 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 13:54:21, time: 0.162, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0065, acc: 99.7949, loss_bbox: 0.0240, loss_mask: 0.0224, loss: 0.0553
2022-03-27 18:30:58,718 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 12:25:34, time: 0.158, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0022, loss_cls: 0.0077, acc: 99.7422, loss_bbox: 0.0229, loss_mask: 0.0213, loss: 0.0547
2022-03-27 18:31:07,399 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 11:12:57, time: 0.174, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0019, loss_cls: 0.0079, acc: 99.7480, loss_bbox: 0.0212, loss_mask: 0.0202, loss: 0.0518
2022-03-27 18:31:15,512 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 10:00:45, time: 0.162, data_time: 0.001, memory: 3730, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0020, loss_cls: 0.0089, acc: 99.7227, loss_bbox: 0.0225, loss_mask: 0.0194, loss: 0.0534
2022-03-27 18:31:23,226 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 8:50:48, time: 0.154, data_time: 0.001, memory: 3769, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0017, loss_cls: 0.0060, acc: 99.8496, loss_bbox: 0.0199, loss_mask: 0.0179, loss: 0.0463
2022-03-27 18:31:31,989 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 7:56:10, time: 0.175, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0051, acc: 99.8496, loss_bbox: 0.0205, loss_mask: 0.0169, loss: 0.0447
2022-03-27 18:31:39,895 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 6:57:59, time: 0.158, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0044, acc: 99.8633, loss_bbox: 0.0179, loss_mask: 0.0158, loss: 0.0402
2022-03-27 18:31:48,838 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 6:13:13, time: 0.179, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0062, acc: 99.8105, loss_bbox: 0.0188, loss_mask: 0.0166, loss: 0.0437
2022-03-27 18:31:56,767 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 5:23:01, time: 0.158, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0068, acc: 99.7949, loss_bbox: 0.0195, loss_mask: 0.0167, loss: 0.0452
2022-03-27 18:32:05,456 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 4:42:33, time: 0.174, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0016, loss_cls: 0.0064, acc: 99.8027, loss_bbox: 0.0188, loss_mask: 0.0155, loss: 0.0429
2022-03-27 18:32:13,327 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 3:58:18, time: 0.157, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0068, acc: 99.7812, loss_bbox: 0.0173, loss_mask: 0.0148, loss: 0.0407
2022-03-27 18:32:21,414 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 3:18:29, time: 0.162, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0066, acc: 99.7793, loss_bbox: 0.0178, loss_mask: 0.0163, loss: 0.0432
2022-03-27 18:32:30,170 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 2:46:09, time: 0.175, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0015, loss_cls: 0.0058, acc: 99.7871, loss_bbox: 0.0170, loss_mask: 0.0165, loss: 0.0413
2022-03-27 18:32:38,237 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 2 days, 2:10:48, time: 0.161, data_time: 0.001, memory: 3777, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0014, loss_cls: 0.0055, acc: 99.8027, loss_bbox: 0.0170, loss_mask: 0.0148, loss: 0.0390
2022-03-27 18:32:46,982 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 2 days, 1:42:12, time: 0.175, data_time: 0.001, memory: 3812, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0050, acc: 99.8438, loss_bbox: 0.0175, loss_mask: 0.0150, loss: 0.0395
2022-03-27 18:32:55,062 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 2 days, 1:10:48, time: 0.162, data_time: 0.001, memory: 3812, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0070, acc: 99.7520, loss_bbox: 0.0178, loss_mask: 0.0149, loss: 0.0420
2022-03-27 18:33:02,713 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 2 days, 0:38:23, time: 0.153, data_time: 0.001, memory: 3812, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0013, loss_cls: 0.0057, acc: 99.8242, loss_bbox: 0.0161, loss_mask: 0.0143, loss: 0.0378
2022-03-27 18:33:11,618 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 2 days, 0:15:36, time: 0.178, data_time: 0.001, memory: 3812, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0067, acc: 99.7988, loss_bbox: 0.0159, loss_mask: 0.0141, loss: 0.0386
2022-03-27 18:33:19,450 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 23:47:23, time: 0.157, data_time: 0.001, memory: 3812, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0014, loss_cls: 0.0055, acc: 99.8203, loss_bbox: 0.0164, loss_mask: 0.0141, loss: 0.0378
2022-03-27 18:33:28,112 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 23:25:36, time: 0.173, data_time: 0.001, memory: 3812, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0066, acc: 99.7637, loss_bbox: 0.0164, loss_mask: 0.0142, loss: 0.0391
2022-03-27 18:33:36,010 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 23:00:27, time: 0.158, data_time: 0.001, memory: 3814, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0055, acc: 99.8203, loss_bbox: 0.0153, loss_mask: 0.0146, loss: 0.0373
2022-03-27 18:33:43,674 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 22:35:10, time: 0.153, data_time: 0.001, memory: 3814, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0039, acc: 99.8730, loss_bbox: 0.0150, loss_mask: 0.0127, loss: 0.0335
2022-03-27 18:33:52,347 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 22:16:42, time: 0.173, data_time: 0.001, memory: 3814, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0046, acc: 99.8438, loss_bbox: 0.0143, loss_mask: 0.0130, loss: 0.0335
2022-03-27 18:34:00,231 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 21:54:48, time: 0.158, data_time: 0.001, memory: 3814, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0062, acc: 99.7793, loss_bbox: 0.0137, loss_mask: 0.0122, loss: 0.0339
2022-03-27 18:34:08,655 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 21:36:47, time: 0.169, data_time: 0.001, memory: 3814, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0012, loss_cls: 0.0056, acc: 99.7910, loss_bbox: 0.0144, loss_mask: 0.0120, loss: 0.0334
2022-03-27 18:34:11,967 - mmdet - INFO - __benchmark_total_time(h):0.1441064589553409
2022-03-27 18:34:11,968 - mmdet - INFO - __benchmark_pure_training_time(h):0.14400470859474607
2022-03-27 18:34:11,969 - mmdet - INFO - __benchmark_avg_iter_time(s):0.1654826511036266
2022-03-27 18:34:11,969 - mmdet - INFO - __benchmark_mem_alloc(mb):3769
2022-03-27 18:34:11,970 - mmdet - INFO - __benchmark_mem_cached(mb):5648
[SH-IDC1-10-142-5-213][[1906,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 18:34:28,173 [32mINFO[0m: log service ip address is: 10.142.5.213:38856[0m
2022-03-27 18:34:28,174 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 18:35:13,058 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 18:35:13,059 - mmdet - INFO - Distributed training: False
2022-03-27 18:35:13,932 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 18:35:14,018 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 18:35:14,019 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 18:35:14,365 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=11.10s)
creating index...
index created!
loading annotations into memory...
Done (t=0.49s)
creating index...
index created!
2022-03-27 18:35:28,767 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 18:35:28,768 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 18:35:28,768 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 18:35:28,768 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 18:38:10,721 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 26 days, 8:50:53, time: 3.238, data_time: 0.088, memory: 3574, loss_rpn_cls: 0.3687, loss_rpn_bbox: 0.0157, loss_cls: 1.2116, acc: 91.1719, loss_bbox: 0.1052, loss_mask: 0.6489, loss: 2.3501
2022-03-27 18:38:18,927 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 13 days, 20:25:36, time: 0.164, data_time: 0.001, memory: 3686, loss_rpn_cls: 0.0327, loss_rpn_bbox: 0.0065, loss_cls: 0.6327, acc: 96.0234, loss_bbox: 0.2297, loss_mask: 0.2566, loss: 1.1581
2022-03-27 18:38:26,741 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 15:47:02, time: 0.156, data_time: 0.001, memory: 3693, loss_rpn_cls: 0.0084, loss_rpn_bbox: 0.0043, loss_cls: 0.1653, acc: 98.6836, loss_bbox: 0.1101, loss_mask: 0.1034, loss: 0.3916
2022-03-27 18:38:34,567 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 13:28:37, time: 0.157, data_time: 0.001, memory: 3693, loss_rpn_cls: 0.0035, loss_rpn_bbox: 0.0052, loss_cls: 0.1068, acc: 99.0762, loss_bbox: 0.0674, loss_mask: 0.0733, loss: 0.2561
2022-03-27 18:38:43,607 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 8:12:45, time: 0.180, data_time: 0.001, memory: 3693, loss_rpn_cls: 0.0022, loss_rpn_bbox: 0.0052, loss_cls: 0.0974, acc: 99.2734, loss_bbox: 0.0600, loss_mask: 0.0613, loss: 0.2262
2022-03-27 18:38:51,510 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 11:59:50, time: 0.159, data_time: 0.002, memory: 3693, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0044, loss_cls: 0.1488, acc: 99.4023, loss_bbox: 0.0590, loss_mask: 0.0554, loss: 0.2695
2022-03-27 18:39:00,555 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 4 days, 22:10:59, time: 0.181, data_time: 0.001, memory: 3693, loss_rpn_cls: 0.0020, loss_rpn_bbox: 0.0043, loss_cls: 0.0718, acc: 99.3066, loss_bbox: 0.0546, loss_mask: 0.0488, loss: 0.1815
2022-03-27 18:39:08,273 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 11:10:03, time: 0.154, data_time: 0.001, memory: 3693, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0035, loss_cls: 0.0369, acc: 99.5293, loss_bbox: 0.0486, loss_mask: 0.0444, loss: 0.1349
2022-03-27 18:39:16,680 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 2:54:26, time: 0.168, data_time: 0.001, memory: 3728, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0037, loss_cls: 0.0219, acc: 99.4375, loss_bbox: 0.0518, loss_mask: 0.0429, loss: 0.1219
2022-03-27 18:39:24,300 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 19:59:12, time: 0.152, data_time: 0.001, memory: 3728, loss_rpn_cls: 0.0018, loss_rpn_bbox: 0.0038, loss_cls: 0.0243, acc: 99.3262, loss_bbox: 0.0494, loss_mask: 0.0420, loss: 0.1213
2022-03-27 18:39:32,090 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 14:22:50, time: 0.156, data_time: 0.000, memory: 3736, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0034, loss_cls: 0.0181, acc: 99.5039, loss_bbox: 0.0379, loss_mask: 0.0373, loss: 0.0980
2022-03-27 18:39:40,430 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 9:53:32, time: 0.167, data_time: 0.001, memory: 3736, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0028, loss_cls: 0.0133, acc: 99.6035, loss_bbox: 0.0370, loss_mask: 0.0328, loss: 0.0868
2022-03-27 18:39:48,599 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 6:02:26, time: 0.163, data_time: 0.001, memory: 3736, loss_rpn_cls: 0.0012, loss_rpn_bbox: 0.0030, loss_cls: 0.0119, acc: 99.6465, loss_bbox: 0.0316, loss_mask: 0.0303, loss: 0.0780
2022-03-27 18:39:56,962 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 2:47:37, time: 0.167, data_time: 0.001, memory: 3736, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0028, loss_cls: 0.0093, acc: 99.7168, loss_bbox: 0.0306, loss_mask: 0.0289, loss: 0.0724
2022-03-27 18:40:04,791 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 2 days, 23:50:28, time: 0.157, data_time: 0.001, memory: 3742, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0026, loss_cls: 0.0103, acc: 99.7168, loss_bbox: 0.0287, loss_mask: 0.0269, loss: 0.0692
2022-03-27 18:40:12,530 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 21:14:02, time: 0.155, data_time: 0.001, memory: 3742, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0024, loss_cls: 0.0083, acc: 99.7656, loss_bbox: 0.0263, loss_mask: 0.0247, loss: 0.0625
2022-03-27 18:40:21,245 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 19:09:29, time: 0.174, data_time: 0.001, memory: 3742, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0023, loss_cls: 0.0099, acc: 99.6836, loss_bbox: 0.0260, loss_mask: 0.0232, loss: 0.0623
2022-03-27 18:40:28,855 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 17:04:18, time: 0.152, data_time: 0.001, memory: 3742, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0023, loss_cls: 0.0090, acc: 99.7012, loss_bbox: 0.0259, loss_mask: 0.0227, loss: 0.0605
2022-03-27 18:40:37,839 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 15:29:23, time: 0.180, data_time: 0.001, memory: 3748, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0021, loss_cls: 0.0079, acc: 99.7363, loss_bbox: 0.0250, loss_mask: 0.0221, loss: 0.0578
2022-03-27 18:40:45,436 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 13:47:36, time: 0.152, data_time: 0.001, memory: 3748, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0022, loss_cls: 0.0093, acc: 99.6953, loss_bbox: 0.0248, loss_mask: 0.0209, loss: 0.0577
2022-03-27 18:40:53,100 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 12:16:16, time: 0.153, data_time: 0.001, memory: 3748, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0020, loss_cls: 0.0071, acc: 99.7402, loss_bbox: 0.0243, loss_mask: 0.0202, loss: 0.0543
2022-03-27 18:41:01,231 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 10:58:12, time: 0.163, data_time: 0.001, memory: 3748, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0021, loss_cls: 0.0064, acc: 99.7832, loss_bbox: 0.0238, loss_mask: 0.0200, loss: 0.0528
2022-03-27 18:41:09,453 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 9:47:44, time: 0.164, data_time: 0.001, memory: 3748, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0048, acc: 99.8398, loss_bbox: 0.0214, loss_mask: 0.0189, loss: 0.0474
2022-03-27 18:41:17,685 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 8:43:23, time: 0.165, data_time: 0.001, memory: 3771, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0051, acc: 99.8164, loss_bbox: 0.0205, loss_mask: 0.0181, loss: 0.0460
2022-03-27 18:41:25,418 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 7:39:26, time: 0.155, data_time: 0.001, memory: 3787, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0019, loss_cls: 0.0052, acc: 99.8301, loss_bbox: 0.0204, loss_mask: 0.0177, loss: 0.0456
2022-03-27 18:41:33,047 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 6:39:27, time: 0.153, data_time: 0.001, memory: 3787, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0019, loss_cls: 0.0066, acc: 99.7676, loss_bbox: 0.0211, loss_mask: 0.0173, loss: 0.0474
2022-03-27 18:41:41,132 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 5:47:49, time: 0.162, data_time: 0.001, memory: 3787, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0018, loss_cls: 0.0066, acc: 99.8027, loss_bbox: 0.0192, loss_mask: 0.0174, loss: 0.0456
2022-03-27 18:41:49,169 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 4:59:30, time: 0.161, data_time: 0.002, memory: 3787, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0057, acc: 99.8125, loss_bbox: 0.0193, loss_mask: 0.0175, loss: 0.0447
2022-03-27 18:41:57,425 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 4:16:17, time: 0.165, data_time: 0.001, memory: 3807, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0058, acc: 99.8301, loss_bbox: 0.0201, loss_mask: 0.0174, loss: 0.0454
2022-03-27 18:42:05,397 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 3:33:32, time: 0.159, data_time: 0.001, memory: 3807, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0054, acc: 99.8320, loss_bbox: 0.0191, loss_mask: 0.0155, loss: 0.0421
2022-03-27 18:42:13,083 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 2:51:44, time: 0.154, data_time: 0.001, memory: 3807, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0059, acc: 99.7832, loss_bbox: 0.0181, loss_mask: 0.0165, loss: 0.0426
2022-03-27 18:42:21,735 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 2:19:26, time: 0.173, data_time: 0.001, memory: 3807, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0048, acc: 99.8418, loss_bbox: 0.0163, loss_mask: 0.0152, loss: 0.0382
2022-03-27 18:42:29,458 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 2 days, 1:42:27, time: 0.154, data_time: 0.001, memory: 3807, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0065, acc: 99.7832, loss_bbox: 0.0172, loss_mask: 0.0164, loss: 0.0422
2022-03-27 18:42:38,254 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 2 days, 1:15:04, time: 0.176, data_time: 0.001, memory: 3807, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0014, loss_cls: 0.0042, acc: 99.8652, loss_bbox: 0.0172, loss_mask: 0.0151, loss: 0.0383
2022-03-27 18:42:45,988 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 2 days, 0:42:07, time: 0.155, data_time: 0.001, memory: 3807, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0063, acc: 99.7910, loss_bbox: 0.0173, loss_mask: 0.0151, loss: 0.0407
2022-03-27 18:42:53,547 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 2 days, 0:09:52, time: 0.151, data_time: 0.001, memory: 3807, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0050, acc: 99.8320, loss_bbox: 0.0185, loss_mask: 0.0148, loss: 0.0404
2022-03-27 18:43:01,583 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 23:42:22, time: 0.161, data_time: 0.001, memory: 3807, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0046, acc: 99.8379, loss_bbox: 0.0178, loss_mask: 0.0153, loss: 0.0396
2022-03-27 18:43:09,198 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 23:13:41, time: 0.152, data_time: 0.001, memory: 3807, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0045, acc: 99.8340, loss_bbox: 0.0154, loss_mask: 0.0143, loss: 0.0360
2022-03-27 18:43:18,032 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 22:53:49, time: 0.177, data_time: 0.001, memory: 3821, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0054, acc: 99.8164, loss_bbox: 0.0162, loss_mask: 0.0141, loss: 0.0377
2022-03-27 18:43:25,741 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 22:28:21, time: 0.154, data_time: 0.001, memory: 3821, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0054, acc: 99.8340, loss_bbox: 0.0168, loss_mask: 0.0138, loss: 0.0379
2022-03-27 18:43:33,476 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 22:04:17, time: 0.155, data_time: 0.001, memory: 3852, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0016, loss_cls: 0.0046, acc: 99.8652, loss_bbox: 0.0168, loss_mask: 0.0143, loss: 0.0376
2022-03-27 18:43:41,809 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 21:44:39, time: 0.167, data_time: 0.001, memory: 3852, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0058, acc: 99.8223, loss_bbox: 0.0165, loss_mask: 0.0142, loss: 0.0383
2022-03-27 18:43:49,547 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 21:22:41, time: 0.155, data_time: 0.001, memory: 3852, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0045, acc: 99.8809, loss_bbox: 0.0142, loss_mask: 0.0132, loss: 0.0335
2022-03-27 18:43:57,817 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 21:04:35, time: 0.166, data_time: 0.001, memory: 3852, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0013, loss_cls: 0.0033, acc: 99.9121, loss_bbox: 0.0147, loss_mask: 0.0129, loss: 0.0325
2022-03-27 18:44:01,057 - mmdet - INFO - __benchmark_total_time(h):0.14244413554668425
2022-03-27 18:44:01,057 - mmdet - INFO - __benchmark_pure_training_time(h):0.14230235854784648
2022-03-27 18:44:01,058 - mmdet - INFO - __benchmark_avg_iter_time(s):0.16016294406010553
2022-03-27 18:44:01,058 - mmdet - INFO - __benchmark_mem_alloc(mb):3771
2022-03-27 18:44:01,059 - mmdet - INFO - __benchmark_mem_cached(mb):5616
[SH-IDC1-10-142-5-213][[11257,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 18:44:16,640 [32mINFO[0m: log service ip address is: 10.142.5.213:24298[0m
2022-03-27 18:44:16,641 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-dirty-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 18:45:03,601 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 18:45:03,603 - mmdet - INFO - Distributed training: False
2022-03-27 18:45:04,486 - mmdet - INFO - Config:
model = dict(
    type='MaskRCNN',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        num_outs=5),
    rpn_head=dict(
        type='RPNHead',
        in_channels=256,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            scales=[8],
            ratios=[0.5, 1.0, 2.0],
            strides=[4, 8, 16, 32, 64]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='CrossEntropyLoss', use_sigmoid=True, loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    roi_head=dict(
        type='StandardRoIHead',
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCBBoxHead',
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=80,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=False,
            loss_cls=dict(
                type='CrossEntropyLoss', use_sigmoid=False, loss_weight=1.0),
            loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
        mask_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=14, sampling_ratio=0),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        mask_head=dict(
            type='FCNMaskHead',
            num_convs=4,
            in_channels=256,
            conv_out_channels=256,
            num_classes=80,
            loss_mask=dict(
                type='CrossEntropyLoss', use_mask=True, loss_weight=1.0))))
train_cfg = dict(
    rpn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.7,
            neg_iou_thr=0.3,
            min_pos_iou=0.3,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=256,
            pos_fraction=0.5,
            neg_pos_ub=-1,
            add_gt_as_proposals=False),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    rpn_proposal=dict(
        nms_across_levels=False,
        nms_pre=2000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.5,
            min_pos_iou=0.5,
            match_low_quality=True,
            ignore_iof_thr=-1),
        sampler=dict(
            type='RandomSampler',
            num=512,
            pos_fraction=0.25,
            neg_pos_ub=-1,
            add_gt_as_proposals=True),
        mask_size=28,
        pos_weight=-1,
        debug=False))
test_cfg = dict(
    rpn=dict(
        nms_across_levels=False,
        nms_pre=1000,
        nms_post=1000,
        max_num=1000,
        nms_thr=0.7,
        min_bbox_size=0),
    rcnn=dict(
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100,
        mask_thr_binary=0.5))
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=2,
    train=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='Resize', img_scale=(1333, 800), keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=['img', 'gt_bboxes', 'gt_labels', 'gt_masks'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(metric=['bbox', 'segm'])
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=None)
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
total_epochs = 12
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/mask_rcnn_r50_fpn_1x_coco'
gpu_ids = range(0, 1)

2022-03-27 18:45:04,613 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 18:45:04,615 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/resnet50-19c8e357.pth
2022-03-27 18:45:05,100 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

loading annotations into memory...
Done (t=11.09s)
creating index...
index created!
loading annotations into memory...
Done (t=0.34s)
creating index...
index created!
2022-03-27 18:45:19,306 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco
2022-03-27 18:45:19,306 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 18:45:19,306 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2022-03-27 18:45:19,307 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/parrots.test/work_dirs/mask_rcnn_r50_fpn_1x_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots-noview/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `AnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots-noview/python/parrots/pytree.py:153: UserWarning: Class `RPNHead` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 18:48:06,820 - mmdet - INFO - Epoch [1][50/58633]	lr: 1.978e-03, eta: 27 days, 6:34:40, time: 3.349, data_time: 0.088, memory: 3463, loss_rpn_cls: 0.3744, loss_rpn_bbox: 0.0156, loss_cls: 1.2768, acc: 87.6406, loss_bbox: 0.0731, loss_mask: 0.5702, loss: 2.3100
2022-03-27 18:48:14,747 - mmdet - INFO - Epoch [1][100/58633]	lr: 3.976e-03, eta: 14 days, 6:45:38, time: 0.159, data_time: 0.001, memory: 3632, loss_rpn_cls: 0.0341, loss_rpn_bbox: 0.0045, loss_cls: 0.2883, acc: 96.5293, loss_bbox: 0.1931, loss_mask: 0.2170, loss: 0.7370
2022-03-27 18:48:23,160 - mmdet - INFO - Epoch [1][150/58633]	lr: 5.974e-03, eta: 9 days, 23:26:35, time: 0.168, data_time: 0.001, memory: 3698, loss_rpn_cls: 0.0095, loss_rpn_bbox: 0.0042, loss_cls: 0.1080, acc: 99.0859, loss_bbox: 0.0917, loss_mask: 0.0952, loss: 0.3086
2022-03-27 18:48:30,840 - mmdet - INFO - Epoch [1][200/58633]	lr: 7.972e-03, eta: 7 days, 19:04:25, time: 0.154, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0036, loss_rpn_bbox: 0.0049, loss_cls: 0.1115, acc: 99.1211, loss_bbox: 0.0682, loss_mask: 0.0729, loss: 0.2611
2022-03-27 18:48:39,462 - mmdet - INFO - Epoch [1][250/58633]	lr: 9.970e-03, eta: 6 days, 12:23:09, time: 0.172, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0027, loss_rpn_bbox: 0.0053, loss_cls: 0.1042, acc: 99.3789, loss_bbox: 0.0611, loss_mask: 0.0609, loss: 0.2341
2022-03-27 18:48:47,138 - mmdet - INFO - Epoch [1][300/58633]	lr: 1.197e-02, eta: 5 days, 15:18:39, time: 0.154, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0047, loss_cls: 0.1110, acc: 99.3535, loss_bbox: 0.0571, loss_mask: 0.0523, loss: 0.2270
2022-03-27 18:48:54,728 - mmdet - INFO - Epoch [1][350/58633]	lr: 1.397e-02, eta: 5 days, 0:12:34, time: 0.152, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0047, loss_cls: 0.1147, acc: 99.4375, loss_bbox: 0.0532, loss_mask: 0.0486, loss: 0.2231
2022-03-27 18:49:02,912 - mmdet - INFO - Epoch [1][400/58633]	lr: 1.596e-02, eta: 4 days, 13:10:21, time: 0.164, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0042, loss_cls: 0.0946, acc: 99.4570, loss_bbox: 0.0473, loss_mask: 0.0444, loss: 0.1920
2022-03-27 18:49:11,300 - mmdet - INFO - Epoch [1][450/58633]	lr: 1.796e-02, eta: 4 days, 4:40:24, time: 0.168, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0039, loss_cls: 0.0334, acc: 99.5586, loss_bbox: 0.0443, loss_mask: 0.0409, loss: 0.1242
2022-03-27 18:49:19,496 - mmdet - INFO - Epoch [1][500/58633]	lr: 1.996e-02, eta: 3 days, 21:48:12, time: 0.164, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0036, loss_cls: 0.0188, acc: 99.5723, loss_bbox: 0.0437, loss_mask: 0.0389, loss: 0.1063
2022-03-27 18:49:27,732 - mmdet - INFO - Epoch [1][550/58633]	lr: 2.000e-02, eta: 3 days, 16:11:29, time: 0.165, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0013, loss_rpn_bbox: 0.0033, loss_cls: 0.0178, acc: 99.5332, loss_bbox: 0.0388, loss_mask: 0.0352, loss: 0.0964
2022-03-27 18:49:35,237 - mmdet - INFO - Epoch [1][600/58633]	lr: 2.000e-02, eta: 3 days, 11:16:51, time: 0.150, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0015, loss_rpn_bbox: 0.0027, loss_cls: 0.0102, acc: 99.7520, loss_bbox: 0.0329, loss_mask: 0.0315, loss: 0.0788
2022-03-27 18:49:43,391 - mmdet - INFO - Epoch [1][650/58633]	lr: 2.000e-02, eta: 3 days, 7:19:07, time: 0.163, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0031, loss_cls: 0.0101, acc: 99.7441, loss_bbox: 0.0322, loss_mask: 0.0304, loss: 0.0767
2022-03-27 18:49:51,834 - mmdet - INFO - Epoch [1][700/58633]	lr: 2.000e-02, eta: 3 days, 4:00:06, time: 0.169, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0010, loss_rpn_bbox: 0.0034, loss_cls: 0.0096, acc: 99.7656, loss_bbox: 0.0308, loss_mask: 0.0273, loss: 0.0721
2022-03-27 18:50:00,030 - mmdet - INFO - Epoch [1][750/58633]	lr: 2.000e-02, eta: 3 days, 1:03:50, time: 0.164, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0027, loss_cls: 0.0086, acc: 99.7656, loss_bbox: 0.0257, loss_mask: 0.0258, loss: 0.0636
2022-03-27 18:50:07,852 - mmdet - INFO - Epoch [1][800/58633]	lr: 2.000e-02, eta: 2 days, 22:24:01, time: 0.156, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0011, loss_rpn_bbox: 0.0027, loss_cls: 0.0081, acc: 99.7695, loss_bbox: 0.0290, loss_mask: 0.0252, loss: 0.0661
2022-03-27 18:50:15,369 - mmdet - INFO - Epoch [1][850/58633]	lr: 2.000e-02, eta: 2 days, 19:58:55, time: 0.150, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0023, loss_cls: 0.0059, acc: 99.8438, loss_bbox: 0.0250, loss_mask: 0.0229, loss: 0.0567
2022-03-27 18:50:24,149 - mmdet - INFO - Epoch [1][900/58633]	lr: 2.000e-02, eta: 2 days, 18:06:16, time: 0.176, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0023, loss_cls: 0.0064, acc: 99.8379, loss_bbox: 0.0250, loss_mask: 0.0220, loss: 0.0567
2022-03-27 18:50:31,832 - mmdet - INFO - Epoch [1][950/58633]	lr: 2.000e-02, eta: 2 days, 16:11:52, time: 0.154, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0024, loss_cls: 0.0044, acc: 99.8887, loss_bbox: 0.0218, loss_mask: 0.0218, loss: 0.0511
2022-03-27 18:50:40,000 - mmdet - INFO - Epoch [1][1000/58633]	lr: 2.000e-02, eta: 2 days, 14:34:46, time: 0.164, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0007, loss_rpn_bbox: 0.0025, loss_cls: 0.0039, acc: 99.9023, loss_bbox: 0.0224, loss_mask: 0.0201, loss: 0.0496
2022-03-27 18:50:47,584 - mmdet - INFO - Epoch [1][1050/58633]	lr: 2.000e-02, eta: 2 days, 13:00:10, time: 0.151, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0047, acc: 99.8711, loss_bbox: 0.0205, loss_mask: 0.0193, loss: 0.0471
2022-03-27 18:50:55,061 - mmdet - INFO - Epoch [1][1100/58633]	lr: 2.000e-02, eta: 2 days, 11:33:13, time: 0.150, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0021, loss_cls: 0.0057, acc: 99.8418, loss_bbox: 0.0212, loss_mask: 0.0194, loss: 0.0492
2022-03-27 18:51:03,559 - mmdet - INFO - Epoch [1][1150/58633]	lr: 2.000e-02, eta: 2 days, 10:24:07, time: 0.170, data_time: 0.001, memory: 3721, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0021, loss_cls: 0.0068, acc: 99.8086, loss_bbox: 0.0214, loss_mask: 0.0185, loss: 0.0494
2022-03-27 18:51:11,185 - mmdet - INFO - Epoch [1][1200/58633]	lr: 2.000e-02, eta: 2 days, 9:12:14, time: 0.152, data_time: 0.001, memory: 3726, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0022, loss_cls: 0.0028, acc: 99.9258, loss_bbox: 0.0200, loss_mask: 0.0182, loss: 0.0437
2022-03-27 18:51:19,825 - mmdet - INFO - Epoch [1][1250/58633]	lr: 2.000e-02, eta: 2 days, 8:15:39, time: 0.173, data_time: 0.001, memory: 3726, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0020, loss_cls: 0.0036, acc: 99.9121, loss_bbox: 0.0195, loss_mask: 0.0170, loss: 0.0427
2022-03-27 18:51:27,463 - mmdet - INFO - Epoch [1][1300/58633]	lr: 2.000e-02, eta: 2 days, 7:14:19, time: 0.153, data_time: 0.001, memory: 3726, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0021, loss_cls: 0.0056, acc: 99.8340, loss_bbox: 0.0186, loss_mask: 0.0175, loss: 0.0441
2022-03-27 18:51:34,873 - mmdet - INFO - Epoch [1][1350/58633]	lr: 2.000e-02, eta: 2 days, 6:15:36, time: 0.148, data_time: 0.001, memory: 3742, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0044, acc: 99.8672, loss_bbox: 0.0181, loss_mask: 0.0166, loss: 0.0417
2022-03-27 18:51:42,762 - mmdet - INFO - Epoch [1][1400/58633]	lr: 2.000e-02, eta: 2 days, 5:25:04, time: 0.158, data_time: 0.001, memory: 3742, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0020, loss_cls: 0.0051, acc: 99.8691, loss_bbox: 0.0184, loss_mask: 0.0165, loss: 0.0425
2022-03-27 18:51:50,468 - mmdet - INFO - Epoch [1][1450/58633]	lr: 2.000e-02, eta: 2 days, 4:36:28, time: 0.154, data_time: 0.001, memory: 3765, loss_rpn_cls: 0.0006, loss_rpn_bbox: 0.0019, loss_cls: 0.0047, acc: 99.8555, loss_bbox: 0.0190, loss_mask: 0.0164, loss: 0.0426
2022-03-27 18:51:58,959 - mmdet - INFO - Epoch [1][1500/58633]	lr: 2.000e-02, eta: 2 days, 3:57:18, time: 0.170, data_time: 0.001, memory: 3765, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0055, acc: 99.8418, loss_bbox: 0.0174, loss_mask: 0.0151, loss: 0.0400
2022-03-27 18:52:06,502 - mmdet - INFO - Epoch [1][1550/58633]	lr: 2.000e-02, eta: 2 days, 3:13:26, time: 0.151, data_time: 0.001, memory: 3765, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0018, loss_cls: 0.0034, acc: 99.9043, loss_bbox: 0.0167, loss_mask: 0.0156, loss: 0.0379
2022-03-27 18:52:14,042 - mmdet - INFO - Epoch [1][1600/58633]	lr: 2.000e-02, eta: 2 days, 2:32:21, time: 0.151, data_time: 0.001, memory: 3765, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0051, acc: 99.8340, loss_bbox: 0.0171, loss_mask: 0.0151, loss: 0.0393
2022-03-27 18:52:22,764 - mmdet - INFO - Epoch [1][1650/58633]	lr: 2.000e-02, eta: 2 days, 2:02:05, time: 0.174, data_time: 0.001, memory: 3765, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0051, acc: 99.8418, loss_bbox: 0.0166, loss_mask: 0.0156, loss: 0.0395
2022-03-27 18:52:30,092 - mmdet - INFO - Epoch [1][1700/58633]	lr: 2.000e-02, eta: 2 days, 1:23:58, time: 0.146, data_time: 0.001, memory: 3765, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0016, loss_cls: 0.0051, acc: 99.8555, loss_bbox: 0.0171, loss_mask: 0.0153, loss: 0.0395
2022-03-27 18:52:38,301 - mmdet - INFO - Epoch [1][1750/58633]	lr: 2.000e-02, eta: 2 days, 0:53:59, time: 0.164, data_time: 0.001, memory: 3772, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0045, acc: 99.8809, loss_bbox: 0.0168, loss_mask: 0.0144, loss: 0.0379
2022-03-27 18:52:45,886 - mmdet - INFO - Epoch [1][1800/58633]	lr: 2.000e-02, eta: 2 days, 0:21:34, time: 0.152, data_time: 0.001, memory: 3772, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0055, acc: 99.8262, loss_bbox: 0.0147, loss_mask: 0.0136, loss: 0.0356
2022-03-27 18:52:53,322 - mmdet - INFO - Epoch [1][1850/58633]	lr: 2.000e-02, eta: 1 day, 23:49:56, time: 0.149, data_time: 0.001, memory: 3772, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0017, loss_cls: 0.0038, acc: 99.8789, loss_bbox: 0.0168, loss_mask: 0.0145, loss: 0.0372
2022-03-27 18:53:01,354 - mmdet - INFO - Epoch [1][1900/58633]	lr: 2.000e-02, eta: 1 day, 23:23:39, time: 0.161, data_time: 0.001, memory: 3772, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0015, loss_cls: 0.0034, acc: 99.8945, loss_bbox: 0.0161, loss_mask: 0.0141, loss: 0.0356
2022-03-27 18:53:08,957 - mmdet - INFO - Epoch [1][1950/58633]	lr: 2.000e-02, eta: 1 day, 22:56:08, time: 0.152, data_time: 0.001, memory: 3772, loss_rpn_cls: 0.0005, loss_rpn_bbox: 0.0017, loss_cls: 0.0029, acc: 99.9277, loss_bbox: 0.0155, loss_mask: 0.0140, loss: 0.0346
2022-03-27 18:53:17,631 - mmdet - INFO - Epoch [1][2000/58633]	lr: 2.000e-02, eta: 1 day, 22:36:14, time: 0.173, data_time: 0.001, memory: 3772, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0014, loss_cls: 0.0049, acc: 99.8672, loss_bbox: 0.0154, loss_mask: 0.0134, loss: 0.0354
2022-03-27 18:53:25,159 - mmdet - INFO - Epoch [1][2050/58633]	lr: 2.000e-02, eta: 1 day, 22:10:49, time: 0.151, data_time: 0.001, memory: 3795, loss_rpn_cls: 0.0004, loss_rpn_bbox: 0.0015, loss_cls: 0.0030, acc: 99.9004, loss_bbox: 0.0146, loss_mask: 0.0127, loss: 0.0322
2022-03-27 18:53:32,767 - mmdet - INFO - Epoch [1][2100/58633]	lr: 2.000e-02, eta: 1 day, 21:46:58, time: 0.152, data_time: 0.001, memory: 3795, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0017, loss_cls: 0.0048, acc: 99.8242, loss_bbox: 0.0149, loss_mask: 0.0140, loss: 0.0358
2022-03-27 18:53:41,538 - mmdet - INFO - Epoch [1][2150/58633]	lr: 2.000e-02, eta: 1 day, 21:30:36, time: 0.175, data_time: 0.001, memory: 3795, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0014, loss_cls: 0.0045, acc: 99.8574, loss_bbox: 0.0146, loss_mask: 0.0129, loss: 0.0336
2022-03-27 18:53:49,035 - mmdet - INFO - Epoch [1][2200/58633]	lr: 2.000e-02, eta: 1 day, 21:08:10, time: 0.150, data_time: 0.001, memory: 3795, loss_rpn_cls: 0.0003, loss_rpn_bbox: 0.0015, loss_cls: 0.0047, acc: 99.8398, loss_bbox: 0.0141, loss_mask: 0.0130, loss: 0.0336
2022-03-27 18:53:52,137 - mmdet - INFO - __benchmark_total_time(h):0.1425545937485165
2022-03-27 18:53:52,137 - mmdet - INFO - __benchmark_pure_training_time(h):0.14245270755555894
2022-03-27 18:53:52,138 - mmdet - INFO - __benchmark_avg_iter_time(s):0.15788322824102777
2022-03-27 18:53:52,139 - mmdet - INFO - __benchmark_mem_alloc(mb):3726
2022-03-27 18:53:52,139 - mmdet - INFO - __benchmark_mem_cached(mb):5616
/mnt/lustre/jianglijuan/view-res
