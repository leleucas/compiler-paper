[SH-IDC1-10-142-5-213][[42732,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 20:27:20,386 [32mINFO[0m: log service ip address is: 10.142.5.213:17965[0m
2022-03-27 20:27:20,387 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 20:28:07,269 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 20:28:07,271 - mmdet - INFO - Distributed training: False
2022-03-27 20:28:08,517 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 20:28:08,568 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 20:28:08,568 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 20:28:08,885 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.45s)
creating index...
index created!
loading annotations into memory...
Done (t=0.51s)
creating index...
index created!
2022-03-27 20:28:23,983 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 20:28:23,984 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 20:28:23,984 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 20:28:23,984 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 20:30:19,404 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 46 days, 23:25:38, time: 2.307, data_time: 0.095, memory: 1826, loss_cls: 19.5128, loss_bbox: 3.1110, loss: 22.6237
2022-03-27 20:30:23,743 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 24 days, 8:55:11, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 7.5248, loss_bbox: 1.0115, loss: 8.5363
2022-03-27 20:30:28,951 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 22:52:57, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.6517, loss_bbox: 0.1928, loss: 0.8445
2022-03-27 20:30:33,319 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 13 days, 3:50:12, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.1512, loss_bbox: 0.0597, loss: 0.2108
2022-03-27 20:30:37,567 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 20:56:49, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0832, loss_bbox: 0.0441, loss: 0.1273
2022-03-27 20:30:41,773 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 8:18:52, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0486, loss_bbox: 0.0393, loss: 0.0879
2022-03-27 20:30:46,724 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 7:09:57, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0322, loss_bbox: 0.0366, loss: 0.0688
2022-03-27 20:30:51,138 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 11:39:32, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0260, loss_bbox: 0.0327, loss: 0.0587
2022-03-27 20:30:55,576 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 20:30:39, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0210, loss_bbox: 0.0334, loss: 0.0543
2022-03-27 20:30:59,650 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 8:01:51, time: 0.081, data_time: 0.001, memory: 1826, loss_cls: 0.0158, loss_bbox: 0.0271, loss: 0.0430
2022-03-27 20:31:04,020 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 22:05:34, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0196, loss_bbox: 0.0416, loss: 0.0612
2022-03-27 20:31:09,293 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 14:32:17, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0116, loss_bbox: 0.0204, loss: 0.0320
2022-03-27 20:31:13,519 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 7:21:39, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0087, loss_bbox: 0.0088, loss: 0.0175
2022-03-27 20:31:17,970 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 1:21:36, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0071, loss_bbox: 0.0075, loss: 0.0145
2022-03-27 20:31:22,223 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 20:02:29, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0059, loss_bbox: 0.0053, loss: 0.0111
2022-03-27 20:31:27,211 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 15:49:48, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0062, loss_bbox: 0.0099, loss: 0.0161
2022-03-27 20:31:31,395 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 11:39:14, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0051, loss_bbox: 0.0069, loss: 0.0120
2022-03-27 20:31:35,361 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 7:49:14, time: 0.079, data_time: 0.001, memory: 1826, loss_cls: 0.0047, loss_bbox: 0.0066, loss: 0.0113
2022-03-27 20:31:39,774 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 4:37:03, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0041, loss_bbox: 0.0041, loss: 0.0082
2022-03-27 20:31:44,180 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 1:44:22, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0032, loss_bbox: 0.0025, loss: 0.0057
2022-03-27 20:31:49,326 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 3 days, 23:28:14, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0013, loss: 0.0041
2022-03-27 20:31:54,184 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 21:17:29, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0006, loss: 0.0032
2022-03-27 20:31:59,009 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 19:16:36, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0023, loss: 0.0049
2022-03-27 20:32:03,768 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 17:24:37, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0017, loss: 0.0041
2022-03-27 20:32:09,081 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 15:54:24, time: 0.106, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0014, loss: 0.0037
2022-03-27 20:32:13,388 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 14:08:31, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0015, loss: 0.0037
2022-03-27 20:32:17,916 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 12:34:57, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0013, loss: 0.0033
2022-03-27 20:32:22,353 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 11:06:36, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0007, loss: 0.0027
2022-03-27 20:32:27,775 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 10:03:58, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0018, loss: 0.0038
2022-03-27 20:32:32,326 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 8:48:37, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0013, loss: 0.0032
2022-03-27 20:32:36,812 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 7:36:46, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0010, loss: 0.0027
2022-03-27 20:32:41,278 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 6:29:12, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0012, loss: 0.0029
2022-03-27 20:32:45,847 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 5:27:29, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0008, loss: 0.0025
2022-03-27 20:32:50,963 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 4:38:44, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0006, loss: 0.0022
2022-03-27 20:32:55,025 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 3:35:13, time: 0.081, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0010, loss: 0.0025
2022-03-27 20:32:59,441 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 2:40:57, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0014, loss: 0.0029
2022-03-27 20:33:03,714 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 1:47:23, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0010, loss: 0.0025
2022-03-27 20:33:08,976 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 1:11:48, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0011, loss: 0.0025
2022-03-27 20:33:13,243 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 0:23:13, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0007, loss: 0.0021
2022-03-27 20:33:17,456 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 2 days, 23:36:07, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0009, loss: 0.0022
2022-03-27 20:33:21,803 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 2 days, 22:53:20, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0006, loss: 0.0019
2022-03-27 20:33:26,130 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 2 days, 22:09:57, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0006, loss: 0.0019
2022-03-27 20:33:30,725 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 21:36:48, time: 0.095, data_time: 0.005, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0007, loss: 0.0019
2022-03-27 20:33:34,717 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 20:54:53, time: 0.080, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0009, loss: 0.0021
2022-03-27 20:33:36,516 - mmdet - INFO - __benchmark_total_time(h):0.0869610838757621
2022-03-27 20:33:36,516 - mmdet - INFO - __benchmark_pure_training_time(h):0.0868142239915
2022-03-27 20:33:36,517 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09094949869009164
2022-03-27 20:33:36,517 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 20:33:36,518 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[47758,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 20:33:52,285 [32mINFO[0m: log service ip address is: 10.142.5.213:39834[0m
2022-03-27 20:33:52,285 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 20:34:36,884 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 20:34:36,886 - mmdet - INFO - Distributed training: False
2022-03-27 20:34:38,159 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 20:34:38,241 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 20:34:38,243 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 20:34:38,538 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.65s)
creating index...
index created!
loading annotations into memory...
Done (t=0.36s)
creating index...
index created!
2022-03-27 20:34:52,986 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 20:34:52,987 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 20:34:52,988 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 20:34:52,988 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 20:36:46,676 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 46 days, 6:31:46, time: 2.273, data_time: 0.092, memory: 1826, loss_cls: 19.4477, loss_bbox: 2.8959, loss: 22.3436
2022-03-27 20:36:51,029 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 24 days, 0:31:09, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 5.3735, loss_bbox: 0.8163, loss: 6.1898
2022-03-27 20:36:55,300 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 14:14:32, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.6040, loss_bbox: 0.1561, loss: 0.7601
2022-03-27 20:37:00,388 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 23:05:19, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.1788, loss_bbox: 0.0741, loss: 0.2530
2022-03-27 20:37:04,515 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 16:56:24, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0938, loss_bbox: 0.0558, loss: 0.1496
2022-03-27 20:37:09,257 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 5:49:22, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0580, loss_bbox: 0.0471, loss: 0.1051
2022-03-27 20:37:13,903 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 4:37:18, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0386, loss_bbox: 0.0374, loss: 0.0760
2022-03-27 20:37:19,394 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 10:44:42, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0274, loss_bbox: 0.0265, loss: 0.0539
2022-03-27 20:37:23,483 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 19:18:59, time: 0.082, data_time: 0.001, memory: 1826, loss_cls: 0.0280, loss_bbox: 0.0492, loss: 0.0771
2022-03-27 20:37:28,128 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 7:30:48, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0206, loss_bbox: 0.0387, loss: 0.0593
2022-03-27 20:37:32,676 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 21:46:46, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0142, loss_bbox: 0.0144, loss: 0.0286
2022-03-27 20:37:38,171 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 14:26:13, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0117, loss_bbox: 0.0193, loss: 0.0311
2022-03-27 20:37:42,405 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 7:16:14, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0083, loss_bbox: 0.0100, loss: 0.0183
2022-03-27 20:37:46,743 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 1:11:59, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0076, loss_bbox: 0.0074, loss: 0.0150
2022-03-27 20:37:51,126 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 19:58:27, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0062, loss_bbox: 0.0053, loss: 0.0115
2022-03-27 20:37:55,474 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 15:22:36, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0054, loss_bbox: 0.0040, loss: 0.0094
2022-03-27 20:38:00,642 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 11:47:31, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0048, loss_bbox: 0.0045, loss: 0.0093
2022-03-27 20:38:04,921 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 8:07:20, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0045, loss_bbox: 0.0048, loss: 0.0093
2022-03-27 20:38:09,394 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 4:56:05, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0042, loss_bbox: 0.0027, loss: 0.0069
2022-03-27 20:38:14,098 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 2:11:08, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0039, loss_bbox: 0.0023, loss: 0.0062
2022-03-27 20:38:19,567 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 0:03:03, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0034, loss_bbox: 0.0033, loss: 0.0068
2022-03-27 20:38:24,208 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 21:44:34, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0033, loss_bbox: 0.0031, loss: 0.0064
2022-03-27 20:38:28,834 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 19:37:32, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0030, loss_bbox: 0.0023, loss: 0.0053
2022-03-27 20:38:33,367 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 17:39:06, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0025, loss: 0.0054
2022-03-27 20:38:38,834 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 16:11:57, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0022, loss: 0.0048
2022-03-27 20:38:43,400 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 14:31:10, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0018, loss: 0.0043
2022-03-27 20:38:47,580 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 12:49:20, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0005, loss: 0.0029
2022-03-27 20:38:51,996 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 11:19:56, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0024, loss: 0.0047
2022-03-27 20:38:56,412 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 9:56:36, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0019, loss: 0.0041
2022-03-27 20:39:01,892 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 8:59:29, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0023, loss: 0.0044
2022-03-27 20:39:06,451 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 7:48:48, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0003, loss: 0.0023
2022-03-27 20:39:10,846 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 6:39:25, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0028, loss: 0.0049
2022-03-27 20:39:15,507 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 5:39:06, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0014, loss: 0.0032
2022-03-27 20:39:20,946 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 4:55:33, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0010, loss: 0.0028
2022-03-27 20:39:25,554 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 4:00:45, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0006, loss: 0.0024
2022-03-27 20:39:30,295 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 3:10:59, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0018, loss: 0.0035
2022-03-27 20:39:34,837 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 2:20:54, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0010, loss: 0.0026
2022-03-27 20:39:40,573 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 1:51:45, time: 0.115, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0013, loss: 0.0029
2022-03-27 20:39:45,240 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 1:08:10, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0004, loss: 0.0020
2022-03-27 20:39:49,844 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 0:25:39, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0011, loss: 0.0025
2022-03-27 20:39:54,508 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 2 days, 23:46:13, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0014, loss: 0.0029
2022-03-27 20:40:00,032 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 2 days, 23:20:33, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0012, loss: 0.0026
2022-03-27 20:40:04,767 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 22:45:24, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0011, loss: 0.0025
2022-03-27 20:40:09,436 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 22:10:52, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0004, loss: 0.0018
2022-03-27 20:40:11,373 - mmdet - INFO - __benchmark_total_time(h):0.08854605482684241
2022-03-27 20:40:11,374 - mmdet - INFO - __benchmark_pure_training_time(h):0.08844043102529314
2022-03-27 20:40:11,375 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09606959126688741
2022-03-27 20:40:11,375 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 20:40:11,375 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[21728,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 20:40:27,813 [32mINFO[0m: log service ip address is: 10.142.5.213:40460[0m
2022-03-27 20:40:27,814 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 20:41:12,517 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 20:41:12,519 - mmdet - INFO - Distributed training: False
2022-03-27 20:41:13,786 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 20:41:13,868 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 20:41:13,870 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 20:41:14,179 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=11.66s)
creating index...
index created!
loading annotations into memory...
Done (t=0.37s)
creating index...
index created!
2022-03-27 20:41:29,950 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 20:41:29,951 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 20:41:29,952 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 20:41:29,952 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 20:43:19,121 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 44 days, 10:21:56, time: 2.182, data_time: 0.093, memory: 1826, loss_cls: 19.1317, loss_bbox: 2.8599, loss: 21.9916
2022-03-27 20:43:23,564 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 23 days, 2:53:00, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 6.9308, loss_bbox: 0.6055, loss: 7.5363
2022-03-27 20:43:28,851 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 3:07:35, time: 0.106, data_time: 0.001, memory: 1826, loss_cls: 0.6506, loss_bbox: 0.1784, loss: 0.8289
2022-03-27 20:43:33,238 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 13:03:25, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.1938, loss_bbox: 0.1222, loss: 0.3160
2022-03-27 20:43:37,511 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 9:10:48, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.1033, loss_bbox: 0.0497, loss: 0.1530
2022-03-27 20:43:41,967 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 8 days, 22:54:17, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0548, loss_bbox: 0.0428, loss: 0.0976
2022-03-27 20:43:46,039 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 7 days, 21:53:03, time: 0.081, data_time: 0.001, memory: 1826, loss_cls: 0.0297, loss_bbox: 0.0253, loss: 0.0550
2022-03-27 20:43:51,275 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 4:32:17, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0233, loss_bbox: 0.0261, loss: 0.0494
2022-03-27 20:43:55,731 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 14:11:55, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0177, loss_bbox: 0.0298, loss: 0.0474
2022-03-27 20:44:00,081 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 2:37:11, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0174, loss_bbox: 0.0272, loss: 0.0446
2022-03-27 20:44:04,126 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 16:52:55, time: 0.081, data_time: 0.001, memory: 1826, loss_cls: 0.0106, loss_bbox: 0.0091, loss: 0.0197
2022-03-27 20:44:09,068 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 9:29:44, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0078, loss_bbox: 0.0077, loss: 0.0156
2022-03-27 20:44:13,320 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 2:43:30, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0066, loss_bbox: 0.0015, loss: 0.0081
2022-03-27 20:44:17,448 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 4 days, 20:49:59, time: 0.082, data_time: 0.001, memory: 1826, loss_cls: 0.0064, loss_bbox: 0.0082, loss: 0.0146
2022-03-27 20:44:21,664 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 15:47:26, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0047, loss_bbox: 0.0026, loss: 0.0073
2022-03-27 20:44:26,037 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 11:28:14, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0042, loss_bbox: 0.0029, loss: 0.0071
2022-03-27 20:44:31,377 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 8:12:50, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0037, loss_bbox: 0.0021, loss: 0.0058
2022-03-27 20:44:35,394 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 4:35:58, time: 0.080, data_time: 0.001, memory: 1826, loss_cls: 0.0035, loss_bbox: 0.0013, loss: 0.0048
2022-03-27 20:44:39,651 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 1:29:11, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0034, loss_bbox: 0.0036, loss: 0.0070
2022-03-27 20:44:44,041 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 3 days, 22:45:25, time: 0.088, data_time: 0.002, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0018, loss: 0.0047
2022-03-27 20:44:49,351 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 3 days, 20:42:44, time: 0.106, data_time: 0.001, memory: 1826, loss_cls: 0.0028, loss_bbox: 0.0011, loss: 0.0039
2022-03-27 20:44:53,907 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 18:31:02, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0014, loss: 0.0039
2022-03-27 20:44:58,402 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 16:29:15, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0013, loss: 0.0037
2022-03-27 20:45:02,544 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 14:29:08, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0009, loss: 0.0032
2022-03-27 20:45:06,602 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 12:36:27, time: 0.081, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0004, loss: 0.0025
2022-03-27 20:45:11,388 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 11:08:48, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0009, loss: 0.0030
2022-03-27 20:45:15,906 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 9:42:06, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0014, loss: 0.0034
2022-03-27 20:45:20,437 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 8:21:34, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0006, loss: 0.0025
2022-03-27 20:45:24,456 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 6:56:22, time: 0.080, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0006, loss: 0.0024
2022-03-27 20:45:29,640 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 5:59:34, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0010, loss: 0.0027
2022-03-27 20:45:33,691 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 4:45:04, time: 0.081, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0007, loss: 0.0023
2022-03-27 20:45:38,125 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 3:42:10, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0011, loss: 0.0027
2022-03-27 20:45:42,252 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 2:37:42, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0008, loss: 0.0024
2022-03-27 20:45:46,344 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 1:36:24, time: 0.082, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0007, loss: 0.0022
2022-03-27 20:45:51,245 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 0:52:00, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0011, loss: 0.0026
2022-03-27 20:45:55,777 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 0:04:18, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0006, loss: 0.0020
2022-03-27 20:46:00,287 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 2 days, 23:18:37, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0012, loss: 0.0025
2022-03-27 20:46:04,610 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 2 days, 22:32:36, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0004, loss: 0.0018
2022-03-27 20:46:09,732 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 2 days, 22:00:51, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0007, loss: 0.0021
2022-03-27 20:46:14,009 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 2 days, 21:18:20, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0008, loss: 0.0021
2022-03-27 20:46:18,630 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 2 days, 20:42:44, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0010, loss: 0.0023
2022-03-27 20:46:22,958 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 2 days, 20:04:51, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0007, loss: 0.0019
2022-03-27 20:46:27,637 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 19:27:46, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0007, loss: 0.0019
2022-03-27 20:46:32,379 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 19:04:20, time: 0.103, data_time: 0.010, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0006, loss: 0.0018
2022-03-27 20:46:34,129 - mmdet - INFO - __benchmark_total_time(h):0.08460305644406213
2022-03-27 20:46:34,130 - mmdet - INFO - __benchmark_pure_training_time(h):0.0844936536418067
2022-03-27 20:46:34,130 - mmdet - INFO - __benchmark_avg_iter_time(s):0.08983672010553229
2022-03-27 20:46:34,130 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 20:46:34,130 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[28402,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 20:46:49,832 [32mINFO[0m: log service ip address is: 10.142.5.213:13237[0m
2022-03-27 20:46:49,832 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 20:47:35,928 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 20:47:35,930 - mmdet - INFO - Distributed training: False
2022-03-27 20:47:37,208 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 20:47:37,261 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 20:47:37,262 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 20:47:37,634 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=12.91s)
creating index...
index created!
loading annotations into memory...
Done (t=0.46s)
creating index...
index created!
2022-03-27 20:47:55,000 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 20:47:55,001 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 20:47:55,001 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 20:47:55,001 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 20:49:46,870 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 45 days, 12:42:51, time: 2.236, data_time: 0.094, memory: 1826, loss_cls: 19.4642, loss_bbox: 2.9294, loss: 22.3936
2022-03-27 20:49:51,548 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 23 days, 17:13:16, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 6.4513, loss_bbox: 0.8212, loss: 7.2724
2022-03-27 20:49:56,062 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 10:10:19, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.5436, loss_bbox: 0.1916, loss: 0.7352
2022-03-27 20:50:01,733 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 21:27:44, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.1437, loss_bbox: 0.0565, loss: 0.2002
2022-03-27 20:50:06,537 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 16:57:38, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0901, loss_bbox: 0.0615, loss: 0.1516
2022-03-27 20:50:11,058 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 5:29:27, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0601, loss_bbox: 0.0487, loss: 0.1088
2022-03-27 20:50:15,456 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 3:58:52, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0407, loss_bbox: 0.0356, loss: 0.0762
2022-03-27 20:50:21,000 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 10:14:33, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0280, loss_bbox: 0.0321, loss: 0.0601
2022-03-27 20:50:25,545 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 19:22:15, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0214, loss_bbox: 0.0294, loss: 0.0508
2022-03-27 20:50:30,010 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 7:23:27, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0197, loss_bbox: 0.0380, loss: 0.0577
2022-03-27 20:50:34,443 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 21:33:38, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0197, loss_bbox: 0.0341, loss: 0.0538
2022-03-27 20:50:39,813 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 14:07:34, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0110, loss_bbox: 0.0142, loss: 0.0252
2022-03-27 20:50:44,529 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 7:21:23, time: 0.095, data_time: 0.002, memory: 1826, loss_cls: 0.0098, loss_bbox: 0.0143, loss: 0.0241
2022-03-27 20:50:49,203 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 1:31:05, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0073, loss_bbox: 0.0089, loss: 0.0162
2022-03-27 20:50:53,779 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 20:23:27, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0070, loss_bbox: 0.0090, loss: 0.0159
2022-03-27 20:50:59,336 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 16:30:07, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0061, loss_bbox: 0.0085, loss: 0.0146
2022-03-27 20:51:03,937 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 12:31:40, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0052, loss_bbox: 0.0065, loss: 0.0118
2022-03-27 20:51:08,547 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 8:59:51, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0043, loss_bbox: 0.0048, loss: 0.0091
2022-03-27 20:51:13,024 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 5:46:09, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0038, loss_bbox: 0.0044, loss: 0.0082
2022-03-27 20:51:17,475 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 2:51:06, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0035, loss_bbox: 0.0005, loss: 0.0040
2022-03-27 20:51:22,986 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 0:42:10, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0033, loss_bbox: 0.0039, loss: 0.0072
2022-03-27 20:51:27,610 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 22:21:40, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0035, loss: 0.0064
2022-03-27 20:51:32,084 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 20:09:11, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0028, loss_bbox: 0.0003, loss: 0.0032
2022-03-27 20:51:36,648 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 18:10:07, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0029, loss: 0.0055
2022-03-27 20:51:42,134 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 16:42:00, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0019, loss: 0.0043
2022-03-27 20:51:46,787 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 15:02:07, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0008, loss: 0.0031
2022-03-27 20:51:51,317 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 13:26:50, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0013, loss: 0.0034
2022-03-27 20:51:55,726 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 11:55:51, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0013, loss: 0.0033
2022-03-27 20:52:01,257 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 10:53:42, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0015, loss: 0.0035
2022-03-27 20:52:05,903 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 9:38:35, time: 0.093, data_time: 0.002, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0013, loss: 0.0032
2022-03-27 20:52:10,661 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 8:30:20, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0010, loss: 0.0028
2022-03-27 20:52:15,326 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 7:24:41, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0021, loss: 0.0039
2022-03-27 20:52:20,632 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 6:34:11, time: 0.106, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0006, loss: 0.0024
2022-03-27 20:52:25,142 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 5:33:14, time: 0.090, data_time: 0.002, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0018, loss: 0.0035
2022-03-27 20:52:29,673 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 4:35:58, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0012, loss: 0.0028
2022-03-27 20:52:34,076 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 3:39:49, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0011, loss: 0.0026
2022-03-27 20:52:39,591 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 3:04:12, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0008, loss: 0.0023
2022-03-27 20:52:44,098 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 2:15:06, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0005, loss: 0.0020
2022-03-27 20:52:48,535 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 1:27:22, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0012, loss: 0.0026
2022-03-27 20:52:53,117 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 0:44:09, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0013, loss: 0.0026
2022-03-27 20:52:57,755 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 0:03:53, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0011, loss: 0.0024
2022-03-27 20:53:03,193 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 2 days, 23:36:30, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0006, loss: 0.0019
2022-03-27 20:53:07,670 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 22:57:31, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0008, loss: 0.0020
2022-03-27 20:53:12,120 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 22:19:52, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0009, loss: 0.0021
2022-03-27 20:53:14,010 - mmdet - INFO - __benchmark_total_time(h):0.08874764740467071
2022-03-27 20:53:14,010 - mmdet - INFO - __benchmark_pure_training_time(h):0.08861351470152537
2022-03-27 20:53:14,013 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09550886173229237
2022-03-27 20:53:14,013 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 20:53:14,013 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[563,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 20:53:29,941 [32mINFO[0m: log service ip address is: 10.142.5.213:39784[0m
2022-03-27 20:53:29,941 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 20:54:14,266 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 20:54:14,268 - mmdet - INFO - Distributed training: False
2022-03-27 20:54:15,546 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 20:54:15,628 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 20:54:15,630 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 20:54:15,931 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=11.72s)
creating index...
index created!
loading annotations into memory...
Done (t=0.38s)
creating index...
index created!
2022-03-27 20:54:31,547 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 20:54:31,549 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 20:54:31,549 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 20:54:31,549 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 20:56:19,150 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 43 days, 19:00:52, time: 2.151, data_time: 0.094, memory: 1826, loss_cls: 19.6236, loss_bbox: 3.0267, loss: 22.6503
2022-03-27 20:56:23,445 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 22 days, 18:30:20, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 8.0857, loss_bbox: 0.9594, loss: 9.0451
2022-03-27 20:56:27,538 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 15 days, 17:39:04, time: 0.082, data_time: 0.001, memory: 1826, loss_cls: 0.7703, loss_bbox: 0.1669, loss: 0.9373
2022-03-27 20:56:32,736 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 7:55:12, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.1623, loss_bbox: 0.0764, loss: 0.2387
2022-03-27 20:56:37,087 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 5:14:11, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0783, loss_bbox: 0.0515, loss: 0.1298
2022-03-27 20:56:41,500 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 8 days, 19:31:59, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0494, loss_bbox: 0.0399, loss: 0.0893
2022-03-27 20:56:46,014 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 7 days, 19:37:09, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0390, loss_bbox: 0.0501, loss: 0.0891
2022-03-27 20:56:51,447 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 2:47:33, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0324, loss_bbox: 0.0431, loss: 0.0754
2022-03-27 20:56:55,743 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 12:28:42, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0204, loss_bbox: 0.0267, loss: 0.0471
2022-03-27 20:57:00,137 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 1:07:05, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0154, loss_bbox: 0.0180, loss: 0.0334
2022-03-27 20:57:04,606 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 15:53:28, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0122, loss_bbox: 0.0163, loss: 0.0285
2022-03-27 20:57:09,788 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 8:46:43, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0092, loss_bbox: 0.0067, loss: 0.0160
2022-03-27 20:57:14,430 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 2:21:34, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0090, loss_bbox: 0.0138, loss: 0.0228
2022-03-27 20:57:18,920 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 4 days, 20:44:47, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0067, loss_bbox: 0.0054, loss: 0.0120
2022-03-27 20:57:23,341 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 15:50:28, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0058, loss_bbox: 0.0063, loss: 0.0120
2022-03-27 20:57:27,542 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 11:24:45, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0052, loss_bbox: 0.0046, loss: 0.0098
2022-03-27 20:57:32,616 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 8:00:16, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0044, loss_bbox: 0.0029, loss: 0.0073
2022-03-27 20:57:36,859 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 4:31:41, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0043, loss_bbox: 0.0041, loss: 0.0083
2022-03-27 20:57:41,111 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 1:25:07, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0041, loss_bbox: 0.0041, loss: 0.0083
2022-03-27 20:57:45,553 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 3 days, 22:42:53, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0040, loss_bbox: 0.0052, loss: 0.0092
2022-03-27 20:57:51,031 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 3 days, 20:44:57, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0033, loss_bbox: 0.0028, loss: 0.0061
2022-03-27 20:57:55,326 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 18:26:19, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0030, loss_bbox: 0.0022, loss: 0.0052
2022-03-27 20:57:59,550 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 16:17:44, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0030, loss_bbox: 0.0028, loss: 0.0057
2022-03-27 20:58:03,843 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 14:21:43, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0030, loss: 0.0059
2022-03-27 20:58:08,037 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 12:32:37, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0029, loss: 0.0056
2022-03-27 20:58:13,159 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 11:12:43, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0041, loss: 0.0068
2022-03-27 20:58:17,453 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 9:40:54, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0019, loss: 0.0043
2022-03-27 20:58:21,851 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 8:17:38, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0008, loss: 0.0031
2022-03-27 20:58:26,245 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 7:00:19, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0032, loss: 0.0056
2022-03-27 20:58:31,820 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 6:10:55, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0022, loss: 0.0043
2022-03-27 20:58:36,341 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 5:04:58, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0009, loss: 0.0029
2022-03-27 20:58:40,934 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 4:04:20, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0017, loss: 0.0036
2022-03-27 20:58:45,279 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 3:03:05, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0011, loss: 0.0029
2022-03-27 20:58:50,315 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 2:17:10, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0013, loss: 0.0030
2022-03-27 20:58:54,558 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 1:20:47, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0010, loss: 0.0027
2022-03-27 20:58:59,030 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 0:31:08, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0011, loss: 0.0027
2022-03-27 20:59:03,705 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 2 days, 23:47:29, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0012, loss: 0.0028
2022-03-27 20:59:08,334 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 2 days, 23:05:21, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0015, loss: 0.0030
2022-03-27 20:59:13,691 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 2 days, 22:36:11, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0009, loss: 0.0024
2022-03-27 20:59:18,211 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 2 days, 21:56:26, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0008, loss: 0.0023
2022-03-27 20:59:22,792 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 2 days, 21:19:22, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0012, loss: 0.0026
2022-03-27 20:59:27,291 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 2 days, 20:42:59, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0010, loss: 0.0024
2022-03-27 20:59:32,860 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 20:22:50, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0007, loss: 0.0021
2022-03-27 20:59:37,486 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 19:51:02, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0012, loss: 0.0025
2022-03-27 20:59:39,418 - mmdet - INFO - __benchmark_total_time(h):0.08563236832618713
2022-03-27 20:59:39,419 - mmdet - INFO - __benchmark_pure_training_time(h):0.08551909526189168
2022-03-27 20:59:39,421 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09366745096105676
2022-03-27 20:59:39,421 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 20:59:39,421 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[6158,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 20:59:55,905 [32mINFO[0m: log service ip address is: 10.142.5.213:10054[0m
2022-03-27 20:59:55,905 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 21:00:43,228 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 21:00:43,229 - mmdet - INFO - Distributed training: False
2022-03-27 21:00:44,381 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 21:00:44,433 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:00:44,433 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:00:44,628 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.79s)
creating index...
index created!
loading annotations into memory...
Done (t=0.39s)
creating index...
index created!
2022-03-27 21:00:59,378 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 21:00:59,379 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 21:00:59,379 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 21:00:59,379 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 21:02:52,006 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 45 days, 20:08:40, time: 2.252, data_time: 0.096, memory: 1826, loss_cls: 18.3216, loss_bbox: 2.3544, loss: 20.6760
2022-03-27 21:02:56,390 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 23 days, 19:29:29, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 6.1852, loss_bbox: 0.6434, loss: 6.8286
2022-03-27 21:03:01,782 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 14:31:44, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.2208, loss_bbox: 0.1089, loss: 0.3297
2022-03-27 21:03:06,150 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 21:34:14, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0766, loss_bbox: 0.0429, loss: 0.1195
2022-03-27 21:03:10,421 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 15:59:31, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0320, loss_bbox: 0.0260, loss: 0.0580
2022-03-27 21:03:14,765 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 4:23:51, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0233, loss_bbox: 0.0235, loss: 0.0468
2022-03-27 21:03:19,585 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 3:03:13, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0194, loss_bbox: 0.0219, loss: 0.0413
2022-03-27 21:03:24,061 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 8:38:23, time: 0.098, data_time: 0.009, memory: 1826, loss_cls: 0.0248, loss_bbox: 0.0573, loss: 0.0821
2022-03-27 21:03:28,097 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 17:23:20, time: 0.081, data_time: 0.001, memory: 1826, loss_cls: 0.0134, loss_bbox: 0.0306, loss: 0.0440
2022-03-27 21:03:32,668 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 5:42:38, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0127, loss_bbox: 0.0129, loss: 0.0256
2022-03-27 21:03:37,125 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 20:03:19, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0060, loss_bbox: 0.0072, loss: 0.0132
2022-03-27 21:03:42,304 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 12:35:50, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0047, loss_bbox: 0.0030, loss: 0.0077
2022-03-27 21:03:46,870 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 5:49:37, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0038, loss_bbox: 0.0022, loss: 0.0060
2022-03-27 21:03:51,335 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 4 days, 23:56:37, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0031, loss_bbox: 0.0021, loss: 0.0053
2022-03-27 21:03:55,819 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 18:52:09, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0016, loss: 0.0042
2022-03-27 21:04:01,237 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 14:59:40, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0003, loss: 0.0026
2022-03-27 21:04:05,634 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 10:59:19, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0011, loss: 0.0032
2022-03-27 21:04:10,218 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 7:31:37, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0008, loss: 0.0027
2022-03-27 21:04:14,626 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 4:20:35, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0008, loss: 0.0025
2022-03-27 21:04:20,066 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 1:58:51, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0013, loss: 0.0029
2022-03-27 21:04:24,475 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 3 days, 23:21:43, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0002, loss: 0.0017
2022-03-27 21:04:29,101 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 21:04:39, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0009, loss: 0.0023
2022-03-27 21:04:33,599 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 18:56:23, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0013, loss: 0.0028
2022-03-27 21:04:38,157 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 17:00:04, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0006, loss: 0.0019
2022-03-27 21:04:43,306 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 15:26:59, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0013, loss: 0.0025
2022-03-27 21:04:47,759 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 13:45:26, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0003, loss: 0.0015
2022-03-27 21:04:52,343 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 12:13:58, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0011, loss: 0.0022
2022-03-27 21:04:56,916 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 10:49:11, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0003, loss: 0.0014
2022-03-27 21:05:02,225 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 9:44:56, time: 0.106, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0006, loss: 0.0016
2022-03-27 21:05:06,600 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 8:26:44, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0010, loss_bbox: 0.0005, loss: 0.0015
2022-03-27 21:05:10,940 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 7:12:49, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0010, loss_bbox: 0.0009, loss: 0.0019
2022-03-27 21:05:15,373 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 6:05:24, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0010, loss_bbox: 0.0005, loss: 0.0015
2022-03-27 21:05:20,554 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 5:15:15, time: 0.104, data_time: 0.001, memory: 1826, loss_cls: 0.0009, loss_bbox: 0.0007, loss: 0.0017
2022-03-27 21:05:25,057 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 4:16:22, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0009, loss_bbox: 0.0005, loss: 0.0014
2022-03-27 21:05:29,583 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 3:21:10, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0009, loss_bbox: 0.0008, loss: 0.0018
2022-03-27 21:05:34,109 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 2:29:08, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0009, loss_bbox: 0.0005, loss: 0.0013
2022-03-27 21:05:38,557 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 1:38:39, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0008, loss_bbox: 0.0006, loss: 0.0015
2022-03-27 21:05:43,786 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 1:02:51, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0008, loss_bbox: 0.0005, loss: 0.0013
2022-03-27 21:05:48,235 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 0:17:08, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0008, loss_bbox: 0.0007, loss: 0.0015
2022-03-27 21:05:52,633 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 2 days, 23:32:53, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0008, loss_bbox: 0.0004, loss: 0.0012
2022-03-27 21:05:56,938 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 2 days, 22:49:40, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0008, loss_bbox: 0.0004, loss: 0.0012
2022-03-27 21:06:02,252 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 2 days, 22:22:29, time: 0.106, data_time: 0.001, memory: 1826, loss_cls: 0.0007, loss_bbox: 0.0006, loss: 0.0013
2022-03-27 21:06:06,750 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 21:45:24, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0007, loss_bbox: 0.0007, loss: 0.0014
2022-03-27 21:06:11,271 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 21:10:14, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0007, loss_bbox: 0.0003, loss: 0.0010
2022-03-27 21:06:13,021 - mmdet - INFO - __benchmark_total_time(h):0.08723834759659237
2022-03-27 21:06:13,021 - mmdet - INFO - __benchmark_pure_training_time(h):0.08712258266078102
2022-03-27 21:06:13,022 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09315331808694235
2022-03-27 21:06:13,022 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 21:06:13,022 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[14685,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 21:06:29,730 [32mINFO[0m: log service ip address is: 10.142.5.213:46615[0m
2022-03-27 21:06:29,731 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 21:07:13,642 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 21:07:13,644 - mmdet - INFO - Distributed training: False
2022-03-27 21:07:14,897 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 21:07:14,950 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:07:14,951 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:07:15,141 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.68s)
creating index...
index created!
loading annotations into memory...
Done (t=0.48s)
creating index...
index created!
2022-03-27 21:07:29,667 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 21:07:29,669 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 21:07:29,669 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 21:07:29,669 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 21:09:16,851 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 43 days, 14:55:45, time: 2.143, data_time: 0.095, memory: 1826, loss_cls: 19.1854, loss_bbox: 2.7153, loss: 21.9007
2022-03-27 21:09:21,307 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 22 days, 17:14:26, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 6.5078, loss_bbox: 0.8121, loss: 7.3200
2022-03-27 21:09:25,801 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 15 days, 18:07:19, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.4167, loss_bbox: 0.1783, loss: 0.5950
2022-03-27 21:09:30,960 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 8:10:27, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.1087, loss_bbox: 0.0842, loss: 0.1928
2022-03-27 21:09:35,544 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 5:53:59, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0542, loss_bbox: 0.0452, loss: 0.0994
2022-03-27 21:09:39,872 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 8 days, 19:57:26, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0360, loss_bbox: 0.0439, loss: 0.0799
2022-03-27 21:09:44,196 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 7 days, 19:42:26, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0285, loss_bbox: 0.0435, loss: 0.0720
2022-03-27 21:09:48,730 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 1:46:36, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0191, loss_bbox: 0.0254, loss: 0.0445
2022-03-27 21:09:54,254 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 12:54:02, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0140, loss_bbox: 0.0211, loss: 0.0350
2022-03-27 21:09:58,694 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 1:32:55, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0118, loss_bbox: 0.0226, loss: 0.0344
2022-03-27 21:10:03,183 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 16:17:51, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0110, loss_bbox: 0.0197, loss: 0.0307
2022-03-27 21:10:07,574 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 8:30:41, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0089, loss_bbox: 0.0162, loss: 0.0251
2022-03-27 21:10:12,674 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 2:27:05, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0075, loss_bbox: 0.0141, loss: 0.0216
2022-03-27 21:10:17,277 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 4 days, 20:54:59, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0050, loss_bbox: 0.0098, loss: 0.0149
2022-03-27 21:10:21,992 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 16:11:06, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0053, loss_bbox: 0.0091, loss: 0.0144
2022-03-27 21:10:26,575 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 11:58:18, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0041, loss_bbox: 0.0061, loss: 0.0102
2022-03-27 21:10:31,693 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 8:33:22, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0040, loss_bbox: 0.0067, loss: 0.0107
2022-03-27 21:10:36,112 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 5:08:38, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0035, loss_bbox: 0.0029, loss: 0.0065
2022-03-27 21:10:41,047 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 2:21:12, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0035, loss_bbox: 0.0067, loss: 0.0102
2022-03-27 21:10:45,759 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 3 days, 23:44:13, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0037, loss: 0.0063
2022-03-27 21:10:50,794 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 3 days, 21:30:53, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0022, loss: 0.0044
2022-03-27 21:10:55,331 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 19:16:32, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0022, loss: 0.0043
2022-03-27 21:10:59,807 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 17:12:20, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0012, loss: 0.0032
2022-03-27 21:11:04,106 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 15:14:07, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0020, loss: 0.0039
2022-03-27 21:11:08,811 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 13:34:55, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0025, loss: 0.0043
2022-03-27 21:11:14,087 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 12:16:03, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0015, loss: 0.0032
2022-03-27 21:11:18,506 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 10:44:36, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0014, loss: 0.0029
2022-03-27 21:11:23,163 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 9:24:29, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0006, loss: 0.0022
2022-03-27 21:11:27,712 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 8:07:59, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0014, loss: 0.0028
2022-03-27 21:11:32,747 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 7:05:48, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0013, loss: 0.0026
2022-03-27 21:11:37,295 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 5:58:34, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0014, loss: 0.0027
2022-03-27 21:11:42,061 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 4:59:21, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0009, loss: 0.0022
2022-03-27 21:11:46,557 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 3:59:09, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0012, loss_bbox: 0.0008, loss: 0.0020
2022-03-27 21:11:51,373 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 3:07:53, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0009, loss: 0.0020
2022-03-27 21:11:55,960 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 2:15:46, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0009, loss: 0.0020
2022-03-27 21:12:00,185 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 1:20:35, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0011, loss: 0.0022
2022-03-27 21:12:04,644 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 0:32:08, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0010, loss_bbox: 0.0007, loss: 0.0018
2022-03-27 21:12:09,090 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 2 days, 23:46:00, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0011, loss_bbox: 0.0015, loss: 0.0026
2022-03-27 21:12:14,158 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 2 days, 23:11:31, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0010, loss_bbox: 0.0011, loss: 0.0021
2022-03-27 21:12:18,542 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 2 days, 22:28:55, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0010, loss_bbox: 0.0007, loss: 0.0017
2022-03-27 21:12:23,247 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 2 days, 21:52:44, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0010, loss_bbox: 0.0012, loss: 0.0022
2022-03-27 21:12:27,800 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 2 days, 21:16:19, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0010, loss_bbox: 0.0007, loss: 0.0017
2022-03-27 21:12:32,624 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 20:45:13, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0009, loss_bbox: 0.0009, loss: 0.0018
2022-03-27 21:12:36,771 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 20:06:34, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0009, loss_bbox: 0.0008, loss: 0.0017
2022-03-27 21:12:38,448 - mmdet - INFO - __benchmark_total_time(h):0.08591019292672475
2022-03-27 21:12:38,449 - mmdet - INFO - __benchmark_pure_training_time(h):0.08577192995283339
2022-03-27 21:12:38,449 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09266399027227046
2022-03-27 21:12:38,449 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 21:12:38,450 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[51226,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 21:12:55,168 [32mINFO[0m: log service ip address is: 10.142.5.213:55907[0m
2022-03-27 21:12:55,169 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 21:13:41,620 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 21:13:41,622 - mmdet - INFO - Distributed training: False
2022-03-27 21:13:42,770 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 21:13:42,822 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:13:42,822 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:13:43,090 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.28s)
creating index...
index created!
loading annotations into memory...
Done (t=0.54s)
creating index...
index created!
2022-03-27 21:13:57,083 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 21:13:57,083 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 21:13:57,084 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 21:13:57,084 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 21:15:44,648 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 43 days, 18:39:45, time: 2.150, data_time: 0.095, memory: 1826, loss_cls: 19.0989, loss_bbox: 2.9570, loss: 22.0559
2022-03-27 21:15:48,932 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 22 days, 18:15:46, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 5.8499, loss_bbox: 1.1274, loss: 6.9773
2022-03-27 21:15:54,465 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 15 days, 22:10:18, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.7615, loss_bbox: 0.2700, loss: 1.0315
2022-03-27 21:15:58,722 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 9:01:35, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.1933, loss_bbox: 0.1271, loss: 0.3203
2022-03-27 21:16:02,928 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 5:49:52, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0854, loss_bbox: 0.0561, loss: 0.1415
2022-03-27 21:16:07,153 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 8 days, 19:44:22, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0626, loss_bbox: 0.0620, loss: 0.1246
2022-03-27 21:16:12,459 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 7 days, 20:53:20, time: 0.106, data_time: 0.001, memory: 1826, loss_cls: 0.0394, loss_bbox: 0.0408, loss: 0.0803
2022-03-27 21:16:16,724 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 2:28:59, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0272, loss_bbox: 0.0285, loss: 0.0556
2022-03-27 21:16:21,008 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 12:10:58, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0215, loss_bbox: 0.0246, loss: 0.0461
2022-03-27 21:16:25,250 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 0:42:07, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0198, loss_bbox: 0.0274, loss: 0.0473
2022-03-27 21:16:29,390 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 15:13:32, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0141, loss_bbox: 0.0174, loss: 0.0315
2022-03-27 21:16:34,761 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 8:19:26, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0111, loss_bbox: 0.0135, loss: 0.0247
2022-03-27 21:16:39,157 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 1:45:13, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0090, loss_bbox: 0.0064, loss: 0.0154
2022-03-27 21:16:43,426 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 4 days, 20:01:42, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0079, loss_bbox: 0.0094, loss: 0.0173
2022-03-27 21:16:47,653 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 15:02:48, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0068, loss_bbox: 0.0051, loss: 0.0118
2022-03-27 21:16:52,798 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 11:14:34, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0061, loss_bbox: 0.0057, loss: 0.0118
2022-03-27 21:16:57,095 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 7:24:07, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0073, loss_bbox: 0.0131, loss: 0.0204
2022-03-27 21:17:01,415 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 3:59:38, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0054, loss_bbox: 0.0058, loss: 0.0112
2022-03-27 21:17:05,768 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 0:58:11, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0049, loss_bbox: 0.0052, loss: 0.0100
2022-03-27 21:17:10,130 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 3 days, 22:14:56, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0043, loss_bbox: 0.0031, loss: 0.0074
2022-03-27 21:17:15,462 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 3 days, 20:14:15, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0040, loss_bbox: 0.0042, loss: 0.0082
2022-03-27 21:17:19,739 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 17:56:30, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0037, loss_bbox: 0.0028, loss: 0.0065
2022-03-27 21:17:24,103 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 15:52:43, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0034, loss_bbox: 0.0028, loss: 0.0063
2022-03-27 21:17:28,259 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 13:54:26, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0032, loss_bbox: 0.0021, loss: 0.0052
2022-03-27 21:17:33,281 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 12:25:51, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0031, loss_bbox: 0.0026, loss: 0.0056
2022-03-27 21:17:37,598 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 10:48:08, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0023, loss: 0.0052
2022-03-27 21:17:42,278 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 9:25:27, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0021, loss: 0.0049
2022-03-27 21:17:46,883 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 8:07:15, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0015, loss: 0.0042
2022-03-27 21:17:52,446 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 7:13:45, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0025, loss_bbox: 0.0010, loss: 0.0035
2022-03-27 21:17:57,070 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 6:05:27, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0025, loss_bbox: 0.0024, loss: 0.0048
2022-03-27 21:18:01,689 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 5:01:23, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0025, loss: 0.0048
2022-03-27 21:18:06,561 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 4:06:05, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0014, loss: 0.0036
2022-03-27 21:18:11,959 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 3:23:25, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0014, loss: 0.0036
2022-03-27 21:18:16,458 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 2:27:45, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0017, loss: 0.0038
2022-03-27 21:18:20,938 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 1:34:52, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0016, loss: 0.0036
2022-03-27 21:18:25,687 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 0:49:27, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0009, loss: 0.0030
2022-03-27 21:18:30,831 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 0:05:28, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0019, loss: 0.0038
2022-03-27 21:18:35,712 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 2 days, 23:33:45, time: 0.107, data_time: 0.010, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0016, loss: 0.0035
2022-03-27 21:18:40,179 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 2 days, 22:50:37, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0010, loss: 0.0028
2022-03-27 21:18:44,695 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 2 days, 22:10:18, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0010, loss: 0.0027
2022-03-27 21:18:49,224 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 2 days, 21:32:13, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0009, loss: 0.0025
2022-03-27 21:18:54,740 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 2 days, 21:09:42, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0013, loss: 0.0029
2022-03-27 21:18:59,349 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 20:35:51, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0015, loss: 0.0031
2022-03-27 21:19:04,029 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 20:04:24, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0013, loss: 0.0029
2022-03-27 21:19:05,951 - mmdet - INFO - __benchmark_total_time(h):0.08595162749290466
2022-03-27 21:19:05,951 - mmdet - INFO - __benchmark_pure_training_time(h):0.0857963396443261
2022-03-27 21:19:05,952 - mmdet - INFO - __benchmark_avg_iter_time(s):0.0957881030026492
2022-03-27 21:19:05,952 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 21:19:05,952 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[58686,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 21:19:22,616 [32mINFO[0m: log service ip address is: 10.142.5.213:46482[0m
2022-03-27 21:19:22,616 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 21:20:09,579 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 21:20:09,581 - mmdet - INFO - Distributed training: False
2022-03-27 21:20:10,722 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 21:20:10,800 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:20:10,802 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:20:11,076 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=11.50s)
creating index...
index created!
loading annotations into memory...
Done (t=0.36s)
creating index...
index created!
2022-03-27 21:20:26,563 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 21:20:26,564 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 21:20:26,565 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 21:20:26,565 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 21:22:16,770 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 44 days, 20:26:58, time: 2.203, data_time: 0.093, memory: 1826, loss_cls: 19.5805, loss_bbox: 2.8633, loss: 22.4438
2022-03-27 21:22:21,475 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 23 days, 9:11:32, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 6.5914, loss_bbox: 0.8779, loss: 7.4693
2022-03-27 21:22:25,963 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 4:44:52, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.5958, loss_bbox: 0.1512, loss: 0.7470
2022-03-27 21:22:30,475 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 14:34:12, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.1758, loss_bbox: 0.0790, loss: 0.2548
2022-03-27 21:22:36,135 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 13:06:39, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0972, loss_bbox: 0.0555, loss: 0.1527
2022-03-27 21:22:40,792 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 2:30:06, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0678, loss_bbox: 0.0685, loss: 0.1363
2022-03-27 21:22:45,475 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 1:49:01, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0442, loss_bbox: 0.0495, loss: 0.0937
2022-03-27 21:22:50,029 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 7:09:01, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0299, loss_bbox: 0.0383, loss: 0.0682
2022-03-27 21:22:55,480 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 17:35:47, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0295, loss_bbox: 0.0343, loss: 0.0639
2022-03-27 21:23:00,191 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 6:02:27, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0168, loss_bbox: 0.0169, loss: 0.0337
2022-03-27 21:23:04,716 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 20:24:44, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0170, loss_bbox: 0.0282, loss: 0.0452
2022-03-27 21:23:09,307 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 12:26:48, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0112, loss_bbox: 0.0110, loss: 0.0222
2022-03-27 21:23:14,478 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 6:07:58, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0091, loss_bbox: 0.0100, loss: 0.0192
2022-03-27 21:23:18,644 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 0:01:53, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0080, loss_bbox: 0.0036, loss: 0.0116
2022-03-27 21:23:22,720 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 18:40:56, time: 0.082, data_time: 0.001, memory: 1826, loss_cls: 0.0073, loss_bbox: 0.0079, loss: 0.0152
2022-03-27 21:23:26,893 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 14:03:23, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0061, loss_bbox: 0.0054, loss: 0.0115
2022-03-27 21:23:31,940 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 10:28:36, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0052, loss_bbox: 0.0048, loss: 0.0100
2022-03-27 21:23:36,327 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 6:56:31, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0046, loss_bbox: 0.0033, loss: 0.0079
2022-03-27 21:23:40,785 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 3:48:46, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0042, loss_bbox: 0.0030, loss: 0.0073
2022-03-27 21:23:45,247 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 0:59:54, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0040, loss_bbox: 0.0008, loss: 0.0047
2022-03-27 21:23:49,880 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 3 days, 22:31:52, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0038, loss_bbox: 0.0038, loss: 0.0076
2022-03-27 21:23:55,302 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 20:38:06, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0033, loss_bbox: 0.0017, loss: 0.0051
2022-03-27 21:24:00,007 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 18:36:27, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0031, loss_bbox: 0.0013, loss: 0.0044
2022-03-27 21:24:04,720 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 16:44:46, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0011, loss: 0.0040
2022-03-27 21:24:09,317 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 14:59:25, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0028, loss_bbox: 0.0017, loss: 0.0045
2022-03-27 21:24:14,953 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 13:45:21, time: 0.113, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0013, loss: 0.0040
2022-03-27 21:24:19,486 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 12:13:08, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0005, loss: 0.0031
2022-03-27 21:24:24,274 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 10:52:37, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0032, loss: 0.0059
2022-03-27 21:24:28,888 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 9:34:18, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0012, loss: 0.0036
2022-03-27 21:24:34,318 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 8:36:59, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0009, loss: 0.0032
2022-03-27 21:24:39,061 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 7:30:33, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0007, loss: 0.0029
2022-03-27 21:24:43,754 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 6:27:13, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0011, loss: 0.0032
2022-03-27 21:24:48,329 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 5:25:38, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0010, loss: 0.0030
2022-03-27 21:24:53,899 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 4:44:44, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0011, loss: 0.0030
2022-03-27 21:24:58,405 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 3:48:33, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0010, loss: 0.0029
2022-03-27 21:25:03,080 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 2:58:08, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0010, loss: 0.0028
2022-03-27 21:25:07,523 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 2:06:45, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0011, loss: 0.0028
2022-03-27 21:25:12,695 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 1:29:14, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0010, loss: 0.0027
2022-03-27 21:25:17,416 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 0:47:03, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0012, loss: 0.0029
2022-03-27 21:25:22,070 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 0:05:53, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0011, loss: 0.0028
2022-03-27 21:25:26,534 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 2 days, 23:23:59, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0010, loss: 0.0027
2022-03-27 21:25:31,035 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 2 days, 22:43:22, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0012, loss: 0.0028
2022-03-27 21:25:36,450 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 22:19:35, time: 0.110, data_time: 0.004, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0009, loss: 0.0025
2022-03-27 21:25:40,774 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 21:41:06, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0009, loss: 0.0024
2022-03-27 21:25:42,834 - mmdet - INFO - __benchmark_total_time(h):0.08795894470479754
2022-03-27 21:25:42,834 - mmdet - INFO - __benchmark_pure_training_time(h):0.08785242438316346
2022-03-27 21:25:42,835 - mmdet - INFO - __benchmark_avg_iter_time(s):0.0960529022045307
2022-03-27 21:25:42,835 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 21:25:42,835 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[65400,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 21:25:58,743 [32mINFO[0m: log service ip address is: 10.142.5.213:11329[0m
2022-03-27 21:25:58,744 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 21:26:47,463 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 21:26:47,465 - mmdet - INFO - Distributed training: False
2022-03-27 21:26:48,760 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 21:26:48,844 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:26:48,846 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:26:49,161 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.52s)
creating index...
index created!
loading annotations into memory...
Done (t=0.37s)
creating index...
index created!
2022-03-27 21:27:03,520 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 21:27:03,521 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 21:27:03,522 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 21:27:03,522 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 21:28:52,432 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 44 days, 7:50:13, time: 2.177, data_time: 0.094, memory: 1826, loss_cls: 19.2169, loss_bbox: 3.3312, loss: 22.5481
2022-03-27 21:28:56,941 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 23 days, 1:56:12, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 6.9024, loss_bbox: 0.8948, loss: 7.7971
2022-03-27 21:29:02,344 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 2:03:31, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.5767, loss_bbox: 0.1756, loss: 0.7523
2022-03-27 21:29:06,939 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 13:22:30, time: 0.097, data_time: 0.006, memory: 1826, loss_cls: 0.1707, loss_bbox: 0.0543, loss: 0.2250
2022-03-27 21:29:11,484 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 9:57:55, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0946, loss_bbox: 0.0556, loss: 0.1502
2022-03-27 21:29:16,271 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 0:05:49, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0582, loss_bbox: 0.0444, loss: 0.1026
2022-03-27 21:29:21,014 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 7 days, 23:50:29, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0393, loss_bbox: 0.0331, loss: 0.0724
2022-03-27 21:29:26,288 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 6:17:29, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0236, loss_bbox: 0.0188, loss: 0.0423
2022-03-27 21:29:30,680 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 15:41:33, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0208, loss_bbox: 0.0264, loss: 0.0472
2022-03-27 21:29:35,288 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 4:13:02, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0162, loss_bbox: 0.0235, loss: 0.0397
2022-03-27 21:29:39,725 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 18:40:57, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0158, loss_bbox: 0.0210, loss: 0.0369
2022-03-27 21:29:44,668 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 11:08:47, time: 0.099, data_time: 0.001, memory: 1826, loss_cls: 0.0099, loss_bbox: 0.0087, loss: 0.0186
2022-03-27 21:29:48,742 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 4:06:55, time: 0.081, data_time: 0.001, memory: 1826, loss_cls: 0.0084, loss_bbox: 0.0112, loss: 0.0197
2022-03-27 21:29:53,059 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 4 days, 22:15:23, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0068, loss_bbox: 0.0066, loss: 0.0134
2022-03-27 21:29:57,245 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 17:05:53, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0061, loss_bbox: 0.0025, loss: 0.0086
2022-03-27 21:30:01,505 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 12:32:48, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0055, loss_bbox: 0.0055, loss: 0.0110
2022-03-27 21:30:06,821 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 9:17:21, time: 0.109, data_time: 0.007, memory: 1826, loss_cls: 0.0051, loss_bbox: 0.0062, loss: 0.0113
2022-03-27 21:30:11,244 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 5:50:14, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0044, loss_bbox: 0.0049, loss: 0.0092
2022-03-27 21:30:15,451 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 2:37:58, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0039, loss_bbox: 0.0025, loss: 0.0064
2022-03-27 21:30:19,726 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 3 days, 23:47:19, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0036, loss_bbox: 0.0011, loss: 0.0047
2022-03-27 21:30:25,118 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 3 days, 21:43:57, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0037, loss_bbox: 0.0048, loss: 0.0085
2022-03-27 21:30:29,558 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 19:26:26, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0032, loss_bbox: 0.0027, loss: 0.0059
2022-03-27 21:30:34,039 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 17:21:47, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0023, loss: 0.0053
2022-03-27 21:30:38,547 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 15:28:22, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0021, loss: 0.0048
2022-03-27 21:30:44,130 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 14:09:09, time: 0.112, data_time: 0.001, memory: 1826, loss_cls: 0.0026, loss_bbox: 0.0017, loss: 0.0043
2022-03-27 21:30:48,758 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 12:34:29, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0025, loss_bbox: 0.0006, loss: 0.0031
2022-03-27 21:30:53,499 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 11:09:08, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0019, loss: 0.0043
2022-03-27 21:30:58,062 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 9:46:26, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0020, loss: 0.0042
2022-03-27 21:31:03,428 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 8:45:28, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0025, loss: 0.0047
2022-03-27 21:31:08,030 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 7:33:42, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0004, loss: 0.0025
2022-03-27 21:31:12,812 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 6:29:46, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0012, loss: 0.0032
2022-03-27 21:31:17,679 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 5:31:45, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0011, loss: 0.0030
2022-03-27 21:31:22,853 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 4:42:31, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0019, loss: 0.0038
2022-03-27 21:31:27,411 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 3:45:31, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0009, loss: 0.0027
2022-03-27 21:31:32,131 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 2:54:24, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0011, loss: 0.0028
2022-03-27 21:31:36,860 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 2:06:33, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0012, loss: 0.0029
2022-03-27 21:31:42,683 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 1:38:23, time: 0.116, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0005, loss: 0.0022
2022-03-27 21:31:47,387 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 0:54:25, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0017, loss: 0.0033
2022-03-27 21:31:52,081 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 0:12:36, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0008, loss: 0.0023
2022-03-27 21:31:57,003 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 2 days, 23:36:13, time: 0.098, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0013, loss: 0.0028
2022-03-27 21:32:01,475 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 2 days, 22:55:15, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0004, loss: 0.0019
2022-03-27 21:32:06,825 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 2 days, 22:28:26, time: 0.107, data_time: 0.002, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0011, loss: 0.0025
2022-03-27 21:32:11,607 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 21:55:02, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0009, loss: 0.0023
2022-03-27 21:32:15,862 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 21:16:16, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0015, loss: 0.0029
2022-03-27 21:32:17,747 - mmdet - INFO - __benchmark_total_time(h):0.08739473866091835
2022-03-27 21:32:17,747 - mmdet - INFO - __benchmark_pure_training_time(h):0.08728474431567722
2022-03-27 21:32:17,748 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09732969157345644
2022-03-27 21:32:17,748 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 21:32:17,748 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[38301,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 21:32:34,555 [32mINFO[0m: log service ip address is: 10.142.5.213:40794[0m
2022-03-27 21:32:34,556 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 21:33:20,923 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 21:33:20,925 - mmdet - INFO - Distributed training: False
2022-03-27 21:33:22,199 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 21:33:22,250 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:33:22,251 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:33:22,636 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.69s)
creating index...
index created!
loading annotations into memory...
Done (t=0.36s)
creating index...
index created!
2022-03-27 21:33:37,472 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 21:33:37,473 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 21:33:37,474 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 21:33:37,474 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 21:35:24,496 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 43 days, 13:14:59, time: 2.139, data_time: 0.095, memory: 1826, loss_cls: 19.3975, loss_bbox: 3.3095, loss: 22.7070
2022-03-27 21:35:29,037 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 22 days, 16:48:33, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 6.4977, loss_bbox: 0.8469, loss: 7.3446
2022-03-27 21:35:34,272 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 15 days, 20:13:45, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.4599, loss_bbox: 0.1613, loss: 0.6213
2022-03-27 21:35:38,413 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 12 days, 7:17:47, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.1624, loss_bbox: 0.0630, loss: 0.2254
2022-03-27 21:35:42,865 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 4:55:17, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.1218, loss_bbox: 0.1367, loss: 0.2585
2022-03-27 21:35:47,345 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 8 days, 19:23:37, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0613, loss_bbox: 0.0322, loss: 0.0935
2022-03-27 21:35:51,479 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 7 days, 18:57:33, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0343, loss_bbox: 0.0265, loss: 0.0609
2022-03-27 21:35:56,879 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 2:10:28, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0219, loss_bbox: 0.0147, loss: 0.0366
2022-03-27 21:36:01,261 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 12:01:18, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0217, loss_bbox: 0.0365, loss: 0.0581
2022-03-27 21:36:05,407 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 0:27:48, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0157, loss_bbox: 0.0170, loss: 0.0327
2022-03-27 21:36:09,527 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 5 days, 14:59:22, time: 0.082, data_time: 0.001, memory: 1826, loss_cls: 0.0113, loss_bbox: 0.0131, loss: 0.0244
2022-03-27 21:36:14,542 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 7:48:55, time: 0.100, data_time: 0.001, memory: 1826, loss_cls: 0.0092, loss_bbox: 0.0064, loss: 0.0156
2022-03-27 21:36:18,776 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 1:09:53, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0075, loss_bbox: 0.0086, loss: 0.0161
2022-03-27 21:36:23,185 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 4 days, 19:34:48, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0063, loss_bbox: 0.0046, loss: 0.0109
2022-03-27 21:36:27,339 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 14:34:40, time: 0.083, data_time: 0.001, memory: 1826, loss_cls: 0.0056, loss_bbox: 0.0065, loss: 0.0120
2022-03-27 21:36:31,528 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 10:13:22, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0051, loss_bbox: 0.0038, loss: 0.0089
2022-03-27 21:36:37,085 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 7:09:51, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0048, loss_bbox: 0.0016, loss: 0.0063
2022-03-27 21:36:41,473 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 3:48:42, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0042, loss_bbox: 0.0049, loss: 0.0091
2022-03-27 21:36:45,769 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 0:45:40, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0036, loss_bbox: 0.0020, loss: 0.0056
2022-03-27 21:36:50,040 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 3 days, 22:00:28, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0033, loss_bbox: 0.0004, loss: 0.0037
2022-03-27 21:36:55,322 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 3 days, 19:59:00, time: 0.106, data_time: 0.001, memory: 1826, loss_cls: 0.0030, loss_bbox: 0.0019, loss: 0.0049
2022-03-27 21:36:59,881 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 17:49:32, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0030, loss_bbox: 0.0032, loss: 0.0063
2022-03-27 21:37:04,423 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 15:50:39, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0002, loss: 0.0029
2022-03-27 21:37:08,857 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 13:59:12, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0027, loss: 0.0054
2022-03-27 21:37:14,098 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 12:35:31, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0018, loss: 0.0042
2022-03-27 21:37:18,505 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 10:59:29, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0002, loss: 0.0026
2022-03-27 21:37:22,884 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 9:29:50, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0023, loss_bbox: 0.0025, loss: 0.0048
2022-03-27 21:37:27,179 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 8:05:00, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0013, loss: 0.0034
2022-03-27 21:37:31,601 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 6:48:34, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0005, loss: 0.0026
2022-03-27 21:37:36,659 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 5:49:32, time: 0.101, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0015, loss: 0.0035
2022-03-27 21:37:40,840 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 4:37:43, time: 0.084, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0006, loss: 0.0024
2022-03-27 21:37:45,242 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 3:34:28, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0010, loss: 0.0028
2022-03-27 21:37:49,505 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 2:32:40, time: 0.085, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0003, loss: 0.0020
2022-03-27 21:37:55,089 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 1:57:15, time: 0.112, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0012, loss: 0.0029
2022-03-27 21:37:59,633 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 1:06:22, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0005, loss: 0.0021
2022-03-27 21:38:04,177 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 0:18:15, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0009, loss: 0.0025
2022-03-27 21:38:08,452 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 2 days, 23:28:37, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0007, loss: 0.0022
2022-03-27 21:38:13,614 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 2 days, 22:55:13, time: 0.103, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0006, loss: 0.0021
2022-03-27 21:38:17,978 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 2 days, 22:11:32, time: 0.087, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0009, loss: 0.0023
2022-03-27 21:38:22,443 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 2 days, 21:31:25, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0008, loss: 0.0022
2022-03-27 21:38:26,858 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 2 days, 20:52:41, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0005, loss: 0.0019
2022-03-27 21:38:31,404 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 2 days, 20:17:33, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0013, loss: 0.0028
2022-03-27 21:38:36,842 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 19:56:13, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0008, loss: 0.0021
2022-03-27 21:38:41,293 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 19:22:42, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0013, loss_bbox: 0.0007, loss: 0.0020
2022-03-27 21:38:43,111 - mmdet - INFO - __benchmark_total_time(h):0.08500545435481602
2022-03-27 21:38:43,117 - mmdet - INFO - __benchmark_pure_training_time(h):0.08489912410577138
2022-03-27 21:38:43,118 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09243723229094819
2022-03-27 21:38:43,118 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 21:38:43,118 - mmdet - INFO - __benchmark_mem_cached(mb):3072
[SH-IDC1-10-142-5-213][[43096,1],0][btl_openib_component.c:1705:init_one_device] error obtaining device attributes for mlx5_0 errno says Protocol not supported
--------------------------------------------------------------------------
WARNING: There was an error initializing an OpenFabrics device.

  Local host:   SH-IDC1-10-142-5-213
  Local device: mlx5_0
--------------------------------------------------------------------------
2022-03-27 21:39:00,249 [32mINFO[0m: log service ip address is: 10.142.5.213:40177[0m
2022-03-27 21:39:00,250 [32mINFO[0m: Parrots 0.18.0 | Git hash: 73be4dd1[0m
/mnt/lustre/jianglijuan/senseparrots/python/parrots/extension.py:21: UserWarning: Parrots git hash changes from: 761af55db3032f89af500fa1d23b56554cc55803-heads/ljun/dev/jit_maskrcnn to 73be4dd14594a5bbc67810e5279d9deb55962b58-heads/ljun/dev/jit_maskrcnn.
  git_hash, version.git_hash))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/jit.py:236: UserWarning: parameter `full_shape` is deprecated. Please use `fixed_shape` instead
  warnings.warn('parameter `full_shape` is deprecated. '
2022-03-27 21:39:45,183 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.6.8 |Anaconda, Inc.| (default, Dec 30 2018, 01:22:34) [GCC 7.3.0]
CUDA available: True
CUDA_HOME: /mnt/cache/share/platform/dep/cuda11.0-cudnn8.0
NVCC: Build cuda_11.0_bu.TC445_37.28845127_0
GPU 0,1,2,3,4,5,6,7: A100-SXM-80GB
GCC: gcc (GCC) 5.4.0
PyTorch: parrots
PyTorch compiling details: {'c_compiler': '/mnt/cache/share/gcc/gcc-5.4/bin/gcc', 'cuda_include_dirs': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/include', 'cuda_libraries': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/lib64/libcudart.so', 'cxx_flags': '-std=c++14 -Wall', 'mpi_include_path': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/include', 'mpi_libraries': '/mnt/cache/share/platform/dep/openmpi-4.0.5-cuda11.0/lib/libmpi.so', 'nccl_include': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/include', 'nccl_libraries': '/mnt/cache/share/platform/dep/nccl-2.9.8-cuda11.0/lib/libnccl.so', 'nvcc_flags': ' -std=c++14 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_61,code=sm_61 -gencode arch=compute_70,code=sm_70 -gencode arch=compute_75,code=sm_75 -gencode arch=compute_80,code=sm_80 -gencode arch=compute_80,code=compute_80', 'nvcc_path': '/mnt/cache/share/platform/dep/cuda11.0-cudnn8.0/bin'}
TorchVision: 0.4.0a0+0195768
OpenCV: 4.1.1
MMCV: 1.4.2
MMDetection: 2.3.0rc0+9fe86cd
MMDetection Compiler: GCC 5.4.0
MMDetection CUDA Compiler: 11.0
------------------------------------------------------------

2022-03-27 21:39:45,184 - mmdet - INFO - Distributed training: False
2022-03-27 21:39:46,467 - mmdet - INFO - Config:
input_size = 300
model = dict(
    type='SingleStageDetector',
    pretrained=
    '/mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth',
    backbone=dict(
        type='SSDVGG',
        input_size=300,
        depth=16,
        with_last_pool=False,
        ceil_mode=True,
        out_indices=(3, 4),
        out_feature_indices=(22, 34),
        l2_norm_scale=20),
    neck=None,
    bbox_head=dict(
        type='SSDHead',
        in_channels=(512, 1024, 512, 256, 256, 256),
        num_classes=80,
        anchor_generator=dict(
            type='SSDAnchorGenerator',
            scale_major=False,
            input_size=300,
            basesize_ratio_range=(0.15, 0.9),
            strides=[8, 16, 32, 64, 100, 300],
            ratios=[[2], [2, 3], [2, 3], [2, 3], [2], [2]]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[0.1, 0.1, 0.2, 0.2])))
cudnn_benchmark = True
train_cfg = dict(
    assigner=dict(
        type='MaxIoUAssigner',
        pos_iou_thr=0.5,
        neg_iou_thr=0.5,
        min_pos_iou=0.0,
        ignore_iof_thr=-1,
        gt_max_assign_all=False),
    smoothl1_beta=1.0,
    allowed_border=-1,
    pos_weight=-1,
    neg_pos_ratio=3,
    debug=False)
test_cfg = dict(
    nms=dict(type='nms', iou_threshold=0.45),
    min_bbox_size=0,
    score_thr=0.02,
    max_per_img=200)
dataset_type = 'CocoDataset'
data_root = '/mnt/lustre/share/DSK/datasets/mscoco2017/'
ceph_data_root = 's3://parrots_model_data/DSK/datasets/mscoco2017/'
img_norm_cfg = dict(mean=[123.675, 116.28, 103.53], std=[1, 1, 1], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile', to_float32=True),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='PhotoMetricDistortion',
        brightness_delta=32,
        contrast_range=(0.5, 1.5),
        saturation_range=(0.5, 1.5),
        hue_delta=18),
    dict(
        type='Expand',
        mean=[123.675, 116.28, 103.53],
        to_rgb=True,
        ratio_range=(1, 4)),
    dict(
        type='MinIoURandomCrop',
        min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
        min_crop_size=0.3),
    dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[1, 1, 1],
        to_rgb=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(300, 300),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=False),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[1, 1, 1],
                to_rgb=True),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=3,
    train=dict(
        type='RepeatDataset',
        times=5,
        dataset=dict(
            type='CocoDataset',
            ann_file=
            '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_train2017.json',
            img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/train2017/',
            pipeline=[
                dict(type='LoadImageFromFile', to_float32=True),
                dict(type='LoadAnnotations', with_bbox=True),
                dict(
                    type='PhotoMetricDistortion',
                    brightness_delta=32,
                    contrast_range=(0.5, 1.5),
                    saturation_range=(0.5, 1.5),
                    hue_delta=18),
                dict(
                    type='Expand',
                    mean=[123.675, 116.28, 103.53],
                    to_rgb=True,
                    ratio_range=(1, 4)),
                dict(
                    type='MinIoURandomCrop',
                    min_ious=(0.1, 0.3, 0.5, 0.7, 0.9),
                    min_crop_size=0.3),
                dict(type='Resize', img_scale=(300, 300), keep_ratio=False),
                dict(
                    type='Normalize',
                    mean=[123.675, 116.28, 103.53],
                    std=[1, 1, 1],
                    to_rgb=True),
                dict(type='RandomFlip', flip_ratio=0.5),
                dict(type='DefaultFormatBundle'),
                dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
            ])),
    val=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file=
        '/mnt/lustre/share/DSK/datasets/mscoco2017/annotations/instances_val2017.json',
        img_prefix='/mnt/lustre/share/DSK/datasets/mscoco2017/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(300, 300),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=False),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[1, 1, 1],
                        to_rgb=True),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.002, momentum=0.9, weight_decay=0.0005)
optimizer_config = dict()
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[16, 22])
total_epochs = 24
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
work_dir = './work_dirs/ssd300_coco'
gpu_ids = range(0, 1)

2022-03-27 21:39:46,520 - mmdet - INFO - load model from: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:39:46,521 - mmdet - INFO - load checkpoint from local path: /mnt/lustre/share_data/yangruichao/model_pool_data/mmdet/vgg16_caffe-292e1171.pth
2022-03-27 21:39:46,714 - mmdet - WARNING - The model and loaded state dict do not match exactly

missing keys in source state_dict: extra.0.weight, extra.0.bias, extra.1.weight, extra.1.bias, extra.2.weight, extra.2.bias, extra.3.weight, extra.3.bias, extra.4.weight, extra.4.bias, extra.5.weight, extra.5.bias, extra.6.weight, extra.6.bias, extra.7.weight, extra.7.bias, l2_norm.weight

loading annotations into memory...
Done (t=10.60s)
creating index...
index created!
loading annotations into memory...
Done (t=0.37s)
creating index...
index created!
2022-03-27 21:40:01,085 - mmdet - INFO - Start running, host: jianglijuan@SH-IDC1-10-142-5-213, work_dir: /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco
2022-03-27 21:40:01,086 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) OptimizerHook                      
(NORMAL      ) CheckpointHook                     
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) AutoTestHook                       
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(NORMAL      ) AutoTestHook                       
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2022-03-27 21:40:01,086 - mmdet - INFO - workflow: [('train', 1)], max: 24 epochs
2022-03-27 21:40:01,086 - mmdet - INFO - Checkpoints will be saved to /mnt/lustre/jianglijuan/ssd.test/work_dirs/ssd300_coco by HardDiskBackend.
/mnt/lustre/jianglijuan/senseparrots/python/torch/tensor.py:158: UserWarning: Do not support pin memory. Do nothing when setting non_blocking as True. 
  warnings.warn('Do not support pin memory. '
/mnt/lustre/jianglijuan/senseparrots/python/parrots/stream.py:60: UserWarning: Stream.wait_stream is not implemented.
  warnings.warn("Stream.wait_stream is not implemented.")
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `SSDAnchorGenerator` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `device` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
/mnt/lustre/jianglijuan/senseparrots/python/parrots/pytree.py:153: UserWarning: Class `MaxIoUAssigner` can not be recognized,                     use decorator `register_custom_class` to register it.
  format(leaf.__class__.__name__))
2022-03-27 21:41:55,391 - mmdet - INFO - Epoch [1][50/73292]	lr: 1.978e-04, eta: 46 days, 12:32:19, time: 2.285, data_time: 0.094, memory: 1826, loss_cls: 19.6088, loss_bbox: 3.2468, loss: 22.8556
2022-03-27 21:41:59,985 - mmdet - INFO - Epoch [1][100/73292]	lr: 3.976e-04, eta: 24 days, 4:42:21, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 6.2691, loss_bbox: 0.8882, loss: 7.1574
2022-03-27 21:42:05,262 - mmdet - INFO - Epoch [1][150/73292]	lr: 5.974e-04, eta: 16 days, 20:16:30, time: 0.105, data_time: 0.001, memory: 1826, loss_cls: 0.5911, loss_bbox: 0.1615, loss: 0.7526
2022-03-27 21:42:09,878 - mmdet - INFO - Epoch [1][200/73292]	lr: 7.972e-04, eta: 13 days, 2:30:06, time: 0.093, data_time: 0.002, memory: 1826, loss_cls: 0.1776, loss_bbox: 0.0626, loss: 0.2402
2022-03-27 21:42:14,590 - mmdet - INFO - Epoch [1][250/73292]	lr: 9.970e-04, eta: 10 days, 20:47:41, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.1303, loss_bbox: 0.1123, loss: 0.2426
2022-03-27 21:42:19,011 - mmdet - INFO - Epoch [1][300/73292]	lr: 1.197e-03, eta: 9 days, 8:31:41, time: 0.088, data_time: 0.001, memory: 1826, loss_cls: 0.0596, loss_bbox: 0.0323, loss: 0.0919
2022-03-27 21:42:24,418 - mmdet - INFO - Epoch [1][350/73292]	lr: 1.397e-03, eta: 8 days, 7:59:31, time: 0.108, data_time: 0.001, memory: 1826, loss_cls: 0.0439, loss_bbox: 0.0329, loss: 0.0768
2022-03-27 21:42:29,164 - mmdet - INFO - Epoch [1][400/73292]	lr: 1.596e-03, eta: 7 days, 12:47:13, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0289, loss_bbox: 0.0319, loss: 0.0609
2022-03-27 21:42:33,840 - mmdet - INFO - Epoch [1][450/73292]	lr: 1.796e-03, eta: 6 days, 21:45:44, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0227, loss_bbox: 0.0248, loss: 0.0476
2022-03-27 21:42:38,349 - mmdet - INFO - Epoch [1][500/73292]	lr: 1.996e-03, eta: 6 days, 9:35:32, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0225, loss_bbox: 0.0426, loss: 0.0651
2022-03-27 21:42:43,970 - mmdet - INFO - Epoch [1][550/73292]	lr: 2.000e-03, eta: 6 days, 0:37:08, time: 0.112, data_time: 0.001, memory: 1826, loss_cls: 0.0173, loss_bbox: 0.0221, loss: 0.0394
2022-03-27 21:42:48,547 - mmdet - INFO - Epoch [1][600/73292]	lr: 2.000e-03, eta: 5 days, 16:17:19, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0096, loss_bbox: 0.0076, loss: 0.0173
2022-03-27 21:42:53,205 - mmdet - INFO - Epoch [1][650/73292]	lr: 2.000e-03, eta: 5 days, 9:17:44, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0090, loss_bbox: 0.0106, loss: 0.0196
2022-03-27 21:42:57,859 - mmdet - INFO - Epoch [1][700/73292]	lr: 2.000e-03, eta: 5 days, 3:18:32, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0073, loss_bbox: 0.0074, loss: 0.0146
2022-03-27 21:43:02,550 - mmdet - INFO - Epoch [1][750/73292]	lr: 2.000e-03, eta: 4 days, 22:08:32, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0062, loss_bbox: 0.0065, loss: 0.0127
2022-03-27 21:43:08,173 - mmdet - INFO - Epoch [1][800/73292]	lr: 2.000e-03, eta: 4 days, 18:11:07, time: 0.112, data_time: 0.001, memory: 1826, loss_cls: 0.0058, loss_bbox: 0.0014, loss: 0.0071
2022-03-27 21:43:12,840 - mmdet - INFO - Epoch [1][850/73292]	lr: 2.000e-03, eta: 4 days, 14:08:38, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0049, loss_bbox: 0.0051, loss: 0.0100
2022-03-27 21:43:17,518 - mmdet - INFO - Epoch [1][900/73292]	lr: 2.000e-03, eta: 4 days, 10:33:48, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0043, loss_bbox: 0.0038, loss: 0.0080
2022-03-27 21:43:22,142 - mmdet - INFO - Epoch [1][950/73292]	lr: 2.000e-03, eta: 4 days, 7:19:42, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0039, loss_bbox: 0.0004, loss: 0.0044
2022-03-27 21:43:27,719 - mmdet - INFO - Epoch [1][1000/73292]	lr: 2.000e-03, eta: 4 days, 4:52:56, time: 0.112, data_time: 0.001, memory: 1826, loss_cls: 0.0036, loss_bbox: 0.0028, loss: 0.0063
2022-03-27 21:43:32,296 - mmdet - INFO - Epoch [1][1050/73292]	lr: 2.000e-03, eta: 4 days, 2:12:16, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0032, loss_bbox: 0.0013, loss: 0.0045
2022-03-27 21:43:37,079 - mmdet - INFO - Epoch [1][1100/73292]	lr: 2.000e-03, eta: 3 days, 23:51:37, time: 0.096, data_time: 0.001, memory: 1826, loss_cls: 0.0030, loss_bbox: 0.0016, loss: 0.0046
2022-03-27 21:43:41,764 - mmdet - INFO - Epoch [1][1150/73292]	lr: 2.000e-03, eta: 3 days, 21:40:48, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0029, loss_bbox: 0.0006, loss: 0.0035
2022-03-27 21:43:47,216 - mmdet - INFO - Epoch [1][1200/73292]	lr: 2.000e-03, eta: 3 days, 19:59:28, time: 0.109, data_time: 0.001, memory: 1826, loss_cls: 0.0027, loss_bbox: 0.0021, loss: 0.0049
2022-03-27 21:43:51,887 - mmdet - INFO - Epoch [1][1250/73292]	lr: 2.000e-03, eta: 3 days, 18:08:05, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0025, loss_bbox: 0.0017, loss: 0.0042
2022-03-27 21:43:56,461 - mmdet - INFO - Epoch [1][1300/73292]	lr: 2.000e-03, eta: 3 days, 16:22:54, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0008, loss: 0.0033
2022-03-27 21:44:00,940 - mmdet - INFO - Epoch [1][1350/73292]	lr: 2.000e-03, eta: 3 days, 14:43:37, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0024, loss_bbox: 0.0016, loss: 0.0040
2022-03-27 21:44:06,033 - mmdet - INFO - Epoch [1][1400/73292]	lr: 2.000e-03, eta: 3 days, 13:24:07, time: 0.102, data_time: 0.001, memory: 1826, loss_cls: 0.0022, loss_bbox: 0.0010, loss: 0.0032
2022-03-27 21:44:10,659 - mmdet - INFO - Epoch [1][1450/73292]	lr: 2.000e-03, eta: 3 days, 12:00:48, time: 0.093, data_time: 0.001, memory: 1826, loss_cls: 0.0021, loss_bbox: 0.0012, loss: 0.0033
2022-03-27 21:44:15,363 - mmdet - INFO - Epoch [1][1500/73292]	lr: 2.000e-03, eta: 3 days, 10:44:26, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0020, loss_bbox: 0.0009, loss: 0.0029
2022-03-27 21:44:19,796 - mmdet - INFO - Epoch [1][1550/73292]	lr: 2.000e-03, eta: 3 days, 9:27:58, time: 0.089, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0008, loss: 0.0028
2022-03-27 21:44:25,142 - mmdet - INFO - Epoch [1][1600/73292]	lr: 2.000e-03, eta: 3 days, 8:33:00, time: 0.107, data_time: 0.001, memory: 1826, loss_cls: 0.0019, loss_bbox: 0.0012, loss: 0.0031
2022-03-27 21:44:29,692 - mmdet - INFO - Epoch [1][1650/73292]	lr: 2.000e-03, eta: 3 days, 7:27:07, time: 0.091, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0008, loss: 0.0026
2022-03-27 21:44:34,177 - mmdet - INFO - Epoch [1][1700/73292]	lr: 2.000e-03, eta: 3 days, 6:23:58, time: 0.090, data_time: 0.001, memory: 1826, loss_cls: 0.0018, loss_bbox: 0.0011, loss: 0.0029
2022-03-27 21:44:38,772 - mmdet - INFO - Epoch [1][1750/73292]	lr: 2.000e-03, eta: 3 days, 5:26:26, time: 0.092, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0011, loss: 0.0028
2022-03-27 21:44:44,316 - mmdet - INFO - Epoch [1][1800/73292]	lr: 2.000e-03, eta: 3 days, 4:47:25, time: 0.111, data_time: 0.001, memory: 1826, loss_cls: 0.0017, loss_bbox: 0.0006, loss: 0.0023
2022-03-27 21:44:49,037 - mmdet - INFO - Epoch [1][1850/73292]	lr: 2.000e-03, eta: 3 days, 3:57:30, time: 0.094, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0009, loss: 0.0025
2022-03-27 21:44:53,881 - mmdet - INFO - Epoch [1][1900/73292]	lr: 2.000e-03, eta: 3 days, 3:12:00, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0016, loss_bbox: 0.0010, loss: 0.0026
2022-03-27 21:44:58,620 - mmdet - INFO - Epoch [1][1950/73292]	lr: 2.000e-03, eta: 3 days, 2:27:27, time: 0.095, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0007, loss: 0.0022
2022-03-27 21:45:04,135 - mmdet - INFO - Epoch [1][2000/73292]	lr: 2.000e-03, eta: 3 days, 1:56:19, time: 0.110, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0007, loss: 0.0022
2022-03-27 21:45:08,898 - mmdet - INFO - Epoch [1][2050/73292]	lr: 2.000e-03, eta: 3 days, 1:16:05, time: 0.095, data_time: 0.002, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0011, loss: 0.0026
2022-03-27 21:45:13,732 - mmdet - INFO - Epoch [1][2100/73292]	lr: 2.000e-03, eta: 3 days, 0:38:39, time: 0.097, data_time: 0.001, memory: 1826, loss_cls: 0.0015, loss_bbox: 0.0010, loss: 0.0025
2022-03-27 21:45:18,047 - mmdet - INFO - Epoch [1][2150/73292]	lr: 2.000e-03, eta: 2 days, 23:55:59, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0008, loss: 0.0022
2022-03-27 21:45:22,330 - mmdet - INFO - Epoch [1][2200/73292]	lr: 2.000e-03, eta: 2 days, 23:14:46, time: 0.086, data_time: 0.001, memory: 1826, loss_cls: 0.0014, loss_bbox: 0.0008, loss: 0.0021
2022-03-27 21:45:24,964 - mmdet - INFO - __benchmark_total_time(h):0.09007459150420295
2022-03-27 21:45:24,967 - mmdet - INFO - __benchmark_pure_training_time(h):0.08996558295355903
2022-03-27 21:45:24,970 - mmdet - INFO - __benchmark_avg_iter_time(s):0.09513775475851663
2022-03-27 21:45:24,971 - mmdet - INFO - __benchmark_mem_alloc(mb):1826
2022-03-27 21:45:24,971 - mmdet - INFO - __benchmark_mem_cached(mb):3072
/mnt/lustre/jianglijuan/view-res
